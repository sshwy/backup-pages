<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>IOI2020 国家集训队作业小结 3 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">IOI2020 国家集训队作业小结 3</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2019年11月30日星期六上午11点22分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2019年11月30日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 3,690 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/IOI2020hw/">2020 国家集训队作业 </a><span class="icon smallarrow"></span> 当前文章</div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AGC028-C-Min-Cost-Cycle"><span class="toc-number">1.</span> <span class="toc-text">AGC028 C Min Cost Cycle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AGC028-D-Chords"><span class="toc-number">2.</span> <span class="toc-text">AGC028 D Chords</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AGC027-D-Modulo-Matrix"><span class="toc-number">3.</span> <span class="toc-text">AGC027 D Modulo Matrix</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AGC027-E-ABBreviate"><span class="toc-number">4.</span> <span class="toc-text">AGC027 E ABBreviate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AGC026-F-Manju-Game"><span class="toc-number">5.</span> <span class="toc-text">AGC026 F Manju Game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AGC027-F-Grafting"><span class="toc-number">6.</span> <span class="toc-text">AGC027 F Grafting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AGC025-F-Addition-and-Andition"><span class="toc-number">7.</span> <span class="toc-text">AGC025 F Addition and Andition</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="AGC028-C-Min-Cost-Cycle" href="#AGC028-C-Min-Cost-Cycle" class="headerlink" title="AGC028 C Min Cost Cycle"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/agc028/tasks/agc028_c">AGC028 C Min Cost Cycle</a></h2><p>首先，我们把这个<script type="math/tex">\min(A_x,B_y)</script>改成，从<script type="math/tex">x</script>到<script type="math/tex">y</script>连两条边，一条是<script type="math/tex">A_x</script>，一条是<script type="math/tex">B_y</script>。那么我们选一条边连即可。这个问题与原问题等价。</p><p>对于每个点<script type="math/tex">u</script>，我们根据它的边被选择的状态分类。它的入边的边权可能是<script type="math/tex">B_u</script>，也可能不是；出边边权可能是<script type="math/tex">A_u</script>，也可能不是。这样就分成了 4 类点。我们记<script type="math/tex">0</script>表示不是，<script type="math/tex">1</script>表示是，那么每个点的状态可以表示为二元组<script type="math/tex">(0/1,0/1)</script>的形式。</p><p>对于所有点的二元组，显然<script type="math/tex">0</script>和<script type="math/tex">1</script>的总个数的相等的，都等于<script type="math/tex">n</script>。有了这些二元组我们显然可以方便地求出答案。</p><p>如果二元组中没有<script type="math/tex">(0,0)</script>和<script type="math/tex">(1,1)</script>，那么必然所有的二元组要么是<script type="math/tex">(0,1)</script>，要么是<script type="math/tex">(1,0)</script>。如果同时出现<script type="math/tex">(0,1),(1,0)</script>显然会在某个点冲突。</p><p>否则，二元组中必然存在相等数量的<script type="math/tex">(0,0)</script>和<script type="math/tex">(1,1)</script>。剩下的就是若干个<script type="math/tex">(0,1)</script>和<script type="math/tex">(1,0)</script>。注意到我们可以这样构造一个方案：<script type="math/tex">(0,0),(1,1),(0,0),(1,0)\cdots (1,0),(1,1),(0,1)\cdots(0,1)</script>因此我们钦定了一个<script type="math/tex">(1,1)</script>的状态后，其他的就可以随便选了。</p><p>于是我们分以上两种情况统计最小值即可。</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc028_c.cpp">代码</a></p><h2><a id="AGC028-D-Chords" href="#AGC028-D-Chords" class="headerlink" title="AGC028 D Chords"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/agc028/tasks/agc028_d">AGC028 D Chords</a></h2><p>考虑计算每一种连通块的贡献。设<script type="math/tex">f(i,j)</script>表示只考虑<script type="math/tex">[i,j]</script>中的点的所有连接情况，满足最大编号为 j，最小编号为 i 的连通块出现的次数。</p><p>显然，只有在<script type="math/tex">[i,j]</script>长度为偶数，且不存在从<script type="math/tex">[i,j]</script>连出去的边的时候，DP 值才不为 0。</p><p>设<script type="math/tex">g(i)</script>表示<script type="math/tex">2i</script>个点连<script type="math/tex">i</script>条边的方案数。显然有</p><script type="math/tex;mode=display">g(i)=\sum_{j=1}^i(2j-1)</script><p>那么我们假设<script type="math/tex">[i,j]</script>中仍未匹配的点有<script type="math/tex">x</script>个。如果<script type="math/tex">x</script>是奇数那么<script type="math/tex">f(i,j)=0</script>。否则区间<script type="math/tex">[i,j]</script>总共就有<script type="math/tex">g\left(\dfrac{x}{2}\right)</script>种连边方案。但是我们要减掉不合法的。</p><p>不合法的相当于存在一个<script type="math/tex">k</script>，使得<script type="math/tex">[i,k]</script>与<script type="math/tex">[k+1,j]</script>不相交。那么设<script type="math/tex">[k+1,j]</script>里未匹配的点数为<script type="math/tex">z</script>（显然<script type="math/tex">z</script>是偶数），那么减掉的方案就是<script type="math/tex">f(i,k)g\left(\dfrac{z}{2}\right)</script>。</p><p>一个 DP 值对答案的贡献就是<script type="math/tex">f(i,j)g\left(\dfrac{y}{2}\right)</script>，其中<script type="math/tex">y</script>表示不在<script type="math/tex">[i,j]</script>的未匹配点的个数。</p><p>时间复杂度<script type="math/tex">O(n^3)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc028_d.cpp">代码</a></p><h2><a id="AGC027-D-Modulo-Matrix" href="#AGC027-D-Modulo-Matrix" class="headerlink" title="AGC027 D Modulo Matrix"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/agc027/tasks/agc027_d">AGC027 D Modulo Matrix</a></h2><blockquote><p>构造一个<script type="math/tex">n \times n</script>的矩阵<script type="math/tex">a</script>，满足如下性质：</p><ol><li><script type="math/tex">1 \le a_{i,j} \le 10^{15}</script>；</li><li>所有的<script type="math/tex">a_{i,j}</script>互不相同；</li><li>存在一个正整数<script type="math/tex">m</script>，满足对于任意两个行相邻或列相邻的元素<script type="math/tex">x,y</script>，有<script type="math/tex">\max(x, y) \bmod \min(x, y)</script>都是<script type="math/tex">m</script>。</li></ol><p><script type="math/tex">2 \le n \le 500</script>，保证有解。</p></blockquote><p>我们贪心地让<script type="math/tex">m=1</script>。</p><p>我们考虑把矩阵黑白染色。那么黑色的格子是互不相关的。我们把白色的格子填成四周的格子的 lcm 加 1 即可。</p><p>考虑怎么把黑色格子填成互不相同的数？我们把黑色格子分两个方向的对角线。每一条对角线上我们乘一个质数上去。这样每个格子就是两个质数的积，且互不相同。第 1000 大的质数是 7919，因此可以过。</p><p>注意<script type="math/tex">n=2</script>的时候要特判。</p><p>时间复杂度<script type="math/tex">O(n^2)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc027_d.cpp">代码</a></p><h2><a id="AGC027-E-ABBreviate" href="#AGC027-E-ABBreviate" class="headerlink" title="AGC027 E ABBreviate"></a><a target="_blank" rel="noopener" href="https://agc027.contest.atcoder.jp/tasks/agc027_e">AGC027 E ABBreviate</a></h2><p>设<script type="math/tex">a=1,b=2</script>，那么我们证明，一个字符串<script type="math/tex">s</script>能变成字符<script type="math/tex">c</script>，仅当以下任一条件满足：</p><ol><li><script type="math/tex">s=c</script>。</li><li><script type="math/tex">s</script>的权值和与<script type="math/tex">c</script>的权值在模<script type="math/tex">3</script>意义下同余，且<script type="math/tex">s</script>中存在两个相邻相同字符。</li></ol><p>显然可以归纳法证明。</p><p>那么考虑第二个推论：一个字符串<script type="math/tex">s</script>能变成字符串<script type="math/tex">t</script>，仅当我们可以贪心地把<script type="math/tex">s</script>的一个前缀划分成<script type="math/tex">|t|</script>段使得每一段都能变成<script type="math/tex">t</script>的一个字符，且<script type="math/tex">s</script>剩余的那段后缀的权值和模<script type="math/tex">3</script>余<script type="math/tex">0</script>。那么我们把这个剩下的一段并到第<script type="math/tex">|t|</script>段后面即可。</p><p>因此我们贪心地在当前串后面构造<script type="math/tex">a,b</script>，设<script type="math/tex">f(i)</script>表示贪心匹配能转移到<script type="math/tex">i</script>的方案数。答案显然是合法的<script type="math/tex">f(i)</script>的和。对于<script type="math/tex">s=ababab\cdots</script>的情况要特判。其他的情况都无所谓。</p><p>可能会关心当第<script type="math/tex">|t|</script>段和剩下的一段里都没有连续相同字符的时候，我们咋办？其实分析可以发现，我们可以合理安排合并的顺序使得<script type="math/tex">s</script>能变成<script type="math/tex">t</script>。只要<script type="math/tex">s</script>中有两个相邻相同字符就行。</p><p>时间复杂度<script type="math/tex">O(n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc027_e.cpp">代码</a></p><h2><a id="AGC026-F-Manju-Game" href="#AGC026-F-Manju-Game" class="headerlink" title="AGC026 F Manju Game"></a><a target="_blank" rel="noopener" href="https://agc026.contest.atcoder.jp/tasks/agc026_f">AGC026 F Manju Game</a></h2><p>我们把一行黑白染色，假设黑色是奇数的格子，分值和为<script type="math/tex">B</script>，白色是偶数的格子，分值和为<script type="math/tex">W</script>。</p><p>考虑<script type="math/tex">n</script>是偶数。</p><p>那么我们可以证明，先手得分的上界和下界都是<script type="math/tex">\max(B,W)</script>。</p><p>证明下界：先手可以选择左端点或者右端点，得到所有的黑色分值或者所有的白色分值。</p><p>证明上界：后手显然会让先手尽可能得到少的分值。由于先手的下界是<script type="math/tex">\max(B,W)</script>，因此后手的上界是<script type="math/tex">\min(B,W)</script>。我们因此可以证明，后手一定能达到上界。当先手选择一个格子后，后手会选择一个方向来获得主动权，然后就可以选择与先手反色的格子，来得到所有白 / 黑色格子的分值，因此后手可以达到上界。</p><p>于是<script type="math/tex">n</script>是偶数就可以直接输出<script type="math/tex">\max(B,W)</script>和<script type="math/tex">\min(B,W)</script>。</p><p>考虑<script type="math/tex">n</script>是奇数。</p><p>容易证明，如果先手第一次选择了黑色的格子，那么后手的下界就是<script type="math/tex">W</script>，那么先手的上界就是<script type="math/tex">B</script>。另一方面，先手的下界也是<script type="math/tex">W</script>（直接选择一个端点），于是这样的答案就是<script type="math/tex">(B,W)</script>。</p><p>那么如果先手第一次选择了一个白色格子呢？</p><p>先手第一次选择了一个白色格子，那么后手在选择左边或者右边的格子后，主动权仍在先手。先手可以继续选择白色格子，然后后手 ban 掉左边或者右边的部分，继续做。而如果先手打算转而选择黑色格子，根据刚才的证明，先手的得分就加上当前剩下的所有黑色格子值，后手得分就加上剩下的白色格子值。</p><p>你发现，先手决定了每次的决策点，而 ban 掉哪一边则由后手决定。换言之，我们设先手的基础分值是<script type="math/tex">W</script>。那么最后会出现一个区间，先手的基础分值就减掉这个区间的白色分值，加上这个区间的黑色分值。</p><p>假设我们确定了每次的决策点（假设先手选了<script type="math/tex">k</script>次白色格子），这<script type="math/tex">k</script>个决策点把整个序列就分成了<script type="math/tex">k+1</script>部分。在做了<script type="math/tex">k</script>次博弈后会剩下一个区间，而这个剩下的区间是由后手决定的！换言之，后手会找到一个区间，使得这个区间的白色分值减黑色分值尽可能大。这样先手就会减掉尽可能多的分值。</p><p>这是一个可二分的问题。我们二分这个最大的分值，那么为了让先手赢，我们就要这个最大值尽可能小。于是相当于判定是否存在一种划分方案，使得划分后每一段的白色减黑色的分值都小于等于这个答案。这里的段数是没有规定的，只要你能划分出来即可（因为权值可能是负数，因此不要把它想成一个傻逼问题）。</p><p>思考发现，我们记录一个前缀最大值即可在<script type="math/tex">O(n)</script>的时间内判定。</p><p>因此总复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc026_f.cpp">代码</a></p><h2><a id="AGC027-F-Grafting" href="#AGC027-F-Grafting" class="headerlink" title="AGC027 F Grafting"></a><a target="_blank" rel="noopener" href="https://agc027.contest.atcoder.jp/tasks/agc027_f">AGC027 F Grafting</a></h2><p>首先我们可以钦定一个点不动，让这个点当作根，变成有根树。</p><p>然后一次 DFS 可以求出哪些点不用动。</p><p>剩下的点我们要动，那么有动的先后关系。在 A 树上父亲比儿子后动，在 B 树上父亲比儿子先动。那么拓扑排序检查关系是否有环即可判断是否合法。</p><p>还有一种情况，就是所有点都要动。那么我们<script type="math/tex">O(n^2)</script>枚举第一个动的点的方案，然后把这个点当作根即可。</p><p>总时间复杂度<script type="math/tex">O(n^3)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc027_f.cpp">代码</a></p><h2><a id="AGC025-F-Addition-and-Andition" href="#AGC025-F-Addition-and-Andition" class="headerlink" title="AGC025 F Addition and Andition"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/agc025/tasks/agc025_f">AGC025 F Addition and Andition</a></h2><p>考虑做一次 and 的加法操作，我们实际上是从高位到低位循环，遇到<script type="math/tex">(1,1)</script>（即两个数的这一位都是 1），就把这两位置为<script type="math/tex">(0,0)</script>，然后再正序循环进位。进位的状态也是一个二元组，表示第一个数的进位，第二个数的进位。我们可以通过二元组的进位与否来完成这个过程。</p><p>然后我们把这个过程做<script type="math/tex">k</script>次。但其实我们直接考虑每个进位进了多少次即可。具体地，在上述过程中，我们在正序循环进位的时候，如果又遇到了<script type="math/tex">(1,1)</script>的状态，我们就又把它置为<script type="math/tex">(0,0)</script>，然后做进位的操作。这样做<script type="math/tex">k</script>次，如果第<script type="math/tex">k+1</script>次遇到了<script type="math/tex">(1,1)</script>的状态就不去动它，直接退出循环。因为我们的进位次数最多为<script type="math/tex">k</script>。</p><p>为啥这样是对的？主要原因是，前一个进位肯定追不上后一个进位。</p><p>那么我们显然可以优化这个过程。我们把一段连续的相同二元组缩成一段。这样在进位的时候就可以快速转移。比如一个<script type="math/tex">(1,1)</script>的进位状态加在<script type="math/tex">(0,1,x)</script>的状态上，相当于我们分出一个<script type="math/tex">(1,0,1)</script>的状态，然后变成了把<script type="math/tex">(0,1)</script>的进位加在<script type="math/tex">(0,1,x-1)</script>上，那么相当于把<script type="math/tex">(0,1,x-1)</script>变成<script type="math/tex">(0,0,x-1)</script>，然后把<script type="math/tex">(0,1</script>的进位加载下一个三元组上。</p><p>我们用链表维护上述过程，每次在表头插入，如果遇到<script type="math/tex">(1,1)</script>就维护进位的过程即可。注意进位的次数不超过<script type="math/tex">k</script>。</p><p>复杂度使用势能分析，为<script type="math/tex">O(n+m+k)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc025_f.cpp">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2019年11月30日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/IOI2020hw/AGC-part-2/">IOI2020 国家集训队作业小结 2</a></div><div class="prev-post"><a href="/IOI2020hw/AGC-part-4/">IOI2020 国家集训队作业小结 4 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>