<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>高爸的杂题练习 2 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">高爸的杂题练习 2</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2020年2月29日星期六中午11点42分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2020年2月29日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 3,147 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Gao/">高爸的习题 </a><span class="icon smallarrow"></span> 当前文章</div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#AHOI2013-作业"><span class="toc-number">1.</span> <span class="toc-text">AHOI2013 作业</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SDOI2016-模式字符串"><span class="toc-number">2.</span> <span class="toc-text">SDOI2016 模式字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZJOI2007-捉迷藏"><span class="toc-number">3.</span> <span class="toc-text">ZJOI2007 捉迷藏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZJOI2015-幻想乡战略游戏"><span class="toc-number">4.</span> <span class="toc-text">ZJOI2015 幻想乡战略游戏</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数颜色"><span class="toc-number">5.</span> <span class="toc-text">数颜色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Logistical-Questions"><span class="toc-number">6.</span> <span class="toc-text">Logistical Questions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#第一部分"><span class="toc-number">6.1.</span> <span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二部分"><span class="toc-number">6.2.</span> <span class="toc-text">第二部分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Chef-and-Churu"><span class="toc-number">7.</span> <span class="toc-text">Chef and Churu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Yunna-的礼物"><span class="toc-number">8.</span> <span class="toc-text">Yunna 的礼物</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="AHOI2013-作业" href="#AHOI2013-作业" class="headerlink" title="AHOI2013 作业"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4396">AHOI2013 作业</a></h2><blockquote><p>给你长度为<script type="math/tex">n</script>的序列<script type="math/tex">A</script>，有<script type="math/tex">m</script>个询问<script type="math/tex">(l,r,a,b)</script>，求</p><ol><li><script type="math/tex">\sum_{i\in[l,r]}[a\le A_i\le b]</script>。即求元素个数。</li><li><script type="math/tex">|\{A_i|i\in[l,r],a\le A_i\le b\}|</script>。即求数值个数。</li></ol><p><script type="math/tex">n,m\le 10^5</script>。</p></blockquote><p><strong>摘要：莫队，离散化，树状数组。</strong></p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/4396.cpp">代码</a></p><h2><a id="SDOI2016-模式字符串" href="#SDOI2016-模式字符串" class="headerlink" title="SDOI2016 模式字符串"></a>SDOI2016 模式字符串</h2><blockquote><p>给你一棵<script type="math/tex">n</script>个点的树，每个点上有一个字符。给你一个串<script type="math/tex">|S|</script>。</p><p>求有多少个有序点对<script type="math/tex">(u,v)</script>，使得<script type="math/tex">u</script>到<script type="math/tex">v</script>的路径组成的字符串以<script type="math/tex">S</script>为循环节。</p><p><script type="math/tex">n,|S|\le 10^5</script>。</p></blockquote><p><strong>摘要：点分治，哈希。</strong></p><p>考虑点分治，那么我们考虑有多少经过当前重心的合法路径。</p><p>以当前重心为根，设<script type="math/tex">f(i)</script>表示<script type="math/tex">i</script>子树内以<script type="math/tex">i</script>结束的<script type="math/tex">S</script>的循环串路径个数（向上的路径），<script type="math/tex">g(i)</script>表示子树内以<script type="math/tex">i</script>开始的<script type="math/tex">S</script>的循环串路径个数（向下的路径）。然后我们求出<script type="math/tex">i</script>到根路径的字符串的哈希值以及其反串的哈希值，在哈希表里查一下匹配之类的就可以计算出经过当前重心的方案数了。</p><p>细节写炸，弃坑了……</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><h2><a id="ZJOI2007-捉迷藏" href="#ZJOI2007-捉迷藏" class="headerlink" title="ZJOI2007 捉迷藏"></a>ZJOI2007 捉迷藏</h2><blockquote><p>给你一棵树<script type="math/tex">n</script>个点的树，支持<script type="math/tex">m</script>个询问：</p><ol><li>改变一个点的颜色（黑白）</li><li>求黑点构成的虚树的直径</li></ol><p><script type="math/tex">n\le 10^5,m\le 5\times 10^5</script>。</p></blockquote><p><strong>摘要：点分树，堆。</strong></p><p>点分树上，每个点维护两个堆<script type="math/tex">A_u,B_u</script>，<script type="math/tex">A_u</script>是到点分树上父亲的距离集合，<script type="math/tex">B_u</script>是点分树上儿子的<script type="math/tex">A_u</script>的堆顶集合。这样的话每个点的答案就可以用<script type="math/tex">B_u</script>的最大值和次大值求出。</p><p>对答案开一个堆。然后修改的时候在路径上删除再加入即可。</p><p>堆要支持删除。</p><p>时间复杂度<script type="math/tex">O(n\log_2^2n+m\log_2n)</script>（可以先预处理距离免得倍增）。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/2056.cpp">代码</a></p><h2><a id="ZJOI2015-幻想乡战略游戏" href="#ZJOI2015-幻想乡战略游戏" class="headerlink" title="ZJOI2015 幻想乡战略游戏"></a>ZJOI2015 幻想乡战略游戏</h2><blockquote><p>给一棵<script type="math/tex">n</script>阶的点边带权的树<script type="math/tex">T</script>，初始时点权<script type="math/tex">d_u</script>为<script type="math/tex">0</script>。有<script type="math/tex">q</script>次操作，每次修改某个点的点权，要求在每次操作后询问</p><script type="math/tex;mode=display">\min_{u\in T}\left\{ \sum_{v\in T}\text{dist}(u,v)d_v \right\}</script><p>其中<script type="math/tex">d_v</script>是点权，<script type="math/tex">\text{dist}</script>表示两点的距离（路径长度）。</p><p>特殊性质：每个点度数不超过<script type="math/tex">D</script>。</p><p><script type="math/tex">n\le 10^5,D=20</script>。</p></blockquote><p><strong>摘要：点分树上递归查询。把舍弃的部分缩点，也就是做一个点权修改的操作。查完了撤消修改。</strong></p><p>从特殊条件入手。既然它限定每个点的度数，说明可以枚举儿子。</p><p>从某个点<script type="math/tex">u</script>开始，我们尝试找到最小化答案的点<script type="math/tex">ans</script>。容易发现，这个寻找的过程类似带权重心。每次我们选择相邻连通块中权值和大于总和一半的连通块并前进。如果没有权值和大于总和一半的连通块，说明当前点就是<script type="math/tex">ans</script>。</p><p>考虑在点分树上做类似的过程。那么就要求我们支持：</p><ol><li>快速查询某个连通块的权值和</li><li>快速统计其他连通块的答案贡献和。</li></ol><p>这个可以直接用变量维护。</p><p>当你选择了一个连通块后，其他连通块的权值和也得考虑进来。即，我们把其他连通块缩点，然后连接到这个连通块上。所谓的缩点，实际上就是把其他连通块的权值和加到这个连通块的（与当前重心相邻的）某个叶子结点上。这样就是一个递归子问题，可以继续做了。查询完了撤消修改即可。</p><p>因此我们发现，查询也依赖修改。</p><p>而修改也是容易做的，点分树上暴力跳父亲即可。</p><p>要预处理一下做到<script type="math/tex">O(1)</script>查询两点距离。</p><p>修改的复杂度是<script type="math/tex">O(\log n)</script>，查询的复杂度是<script type="math/tex">O(\log^2 n+\log nD)</script>。</p><p>总复杂度<script type="math/tex">O(n\log_2^2n+q(\log^2n+\log nD))</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/3345.cpp">代码</a></p><h2><a id="数颜色" href="#数颜色" class="headerlink" title="数颜色"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1903">数颜色</a></h2><blockquote><p>给你一个<script type="math/tex">n</script>阶序列，支持<script type="math/tex">m</script>个操作：</p><ol><li>单点修改；</li><li>查询区间里出现的值的个数（多少个不同的数字）</li></ol><p><script type="math/tex">n,m\le 13333,a_i\le 10^6</script>。</p></blockquote><p><strong>摘要：带修莫队：加一维时间，块大小<script type="math/tex">O((nt)^{\frac{1}{3}})</script>（如果<script type="math/tex">O(n)=O(t)</script>就是<script type="math/tex">O(n^{\frac{2}{3}})</script>）。复杂度<script type="math/tex">O(n^{\frac{4}{3}}t^{\frac{1}{3}})</script>。</strong></p><p>如果不带修改可以莫队。</p><p>带修改就加一维时间，排序的时候按照左端点块编号升序、右端点块编号升序、时间升序这样依次排序即可。</p><p>记得要卡一下常，比如块大小乘 2 什么的。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/1903.cpp">代码</a></p><h2><a id="Logistical-Questions" href="#Logistical-Questions" class="headerlink" title="Logistical Questions"></a><a target="_blank" rel="noopener" href="https://codeforces.ml/contest/566/problem/C">Logistical Questions</a></h2><blockquote><p>给一棵点边带权树<script type="math/tex">T</script>，点权为<script type="math/tex">w_u</script>，边权为<script type="math/tex">w(u,v)</script>。求</p><script type="math/tex;mode=display">\min_{u\in T}\left\{ \sum_{v\in T}w(u,v)^{\frac{3}{2}}w_v \right\}</script><p>并输出使得最小化的结点。</p><p><script type="math/tex">n\le 2\times 10^5</script>。</p></blockquote><p><strong>摘要：凸函数，点分治。树高不超过<script type="math/tex">O(\log n)</script>，因此复杂度保证。</strong></p><p>这道题展示了有关树上凸函数的一些性质。</p><h3><a id="第一部分" href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h3><p>如果树是一条链，那么每个点的代价一定是先递减后递增。假设我们允许在边上选择点（实数范围），假设选择的点记作<script type="math/tex">v</script>，那么<script type="math/tex">f(u,v)=w(u,v)^{\frac{3}{2}}</script>在<script type="math/tex">v</script>变化的过程中是一个凸函数（实际上是一个类似绝对值和凸函数的混合物）。</p><p>众所周知，凸函数的和仍是凸函数（因为凸函数的导数是单调的，而两个单调函数的和仍是单调的）。</p><p>于是我们就证明了如果树是一条链，那么每个点的代价一定是凸函数。</p><p>那么如果不是一条链呢？</p><p>容易发现，当点<script type="math/tex">v</script>在路径<script type="math/tex">(x,y)</script>上从<script type="math/tex">x</script>移动到<script type="math/tex">y</script>的过程中，对于任意结点<script type="math/tex">u</script>（不论<script type="math/tex">u</script>在不在<script type="math/tex">(x,y)</script>上），<script type="math/tex">f(u,v)</script>都是凸函数。因此对于每条路径而言，从一端到另一端的每个点的代价一定是凸函数。</p><p>而这些路径的凸函数的顶点一定是同一个点（可能在某条边上）。如果存在两个顶点的话，我把这两个连起来就不是凸函数了，与上文矛盾。</p><p>如果顶点在边上，那么答案就是这条边的两个端点之一。</p><h3><a id="第二部分" href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h3><p>因此说了这么多，我们得到了一个有助于解题的重要信息：从一个点<script type="math/tex">u</script>出发，至多存在一条邻边<script type="math/tex">(u,v)</script>，满足你沿着<script type="math/tex">(u,v)</script>走时代价会减小（导数为负）。如果不存在这样的邻边，那么<script type="math/tex">u</script>就是最优解。</p><p>因此我们就每次找到这个邻边并移动即可。这样的算法复杂度是<script type="math/tex">O(n^2)</script>的。</p><p>容易发现，这个过程就是在点分树上查询的过程。点分树树高不超过<script type="math/tex">O(\log n)</script>。因此使用点分治即可。在寻找邻边的时候，我们可以想办法在<script type="math/tex">O(n)</script>的总时间内求出，从<script type="math/tex">u</script>往<script type="math/tex">v</script>走一个单位后的代价和（对于所有<script type="math/tex">u</script>的邻居<script type="math/tex">v</script>）。这样就可以找出代价变小的邻边了。</p><p>时间复杂度<script type="math/tex">O(n\log n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/codeforces/566c.cpp">代码</a></p><h2><a id="Chef-and-Churu" href="#Chef-and-Churu" class="headerlink" title="Chef and Churu"></a><a target="_blank" rel="noopener" href="https://www.codechef.com/problems/FNCS">Chef and Churu</a></h2><blockquote><p>有一个长度为<script type="math/tex">n</script>的序列<script type="math/tex">A</script>和<script type="math/tex">n</script>个函数<script type="math/tex">(L_i,R_i):f(L_i,R_i)=\sum_{j=L_i}^{R_i}A_j</script>。有<script type="math/tex">Q</script>次操作：</p><ol><li>单点修改；</li><li>询问第<script type="math/tex">l</script>个函数到第<script type="math/tex">r</script>个函数的值的和。</li></ol><p><script type="math/tex">n,q\le 10^5,A_i\le 10^9</script>。</p></blockquote><p><strong>摘要：分块，树状数组</strong></p><p>对函数分块。假设分块大小为<script type="math/tex">T</script>，则有<script type="math/tex">O(\frac{n}{T})</script>块。</p><p>对于整块，预处理<script type="math/tex">f(i,j)</script>表示第<script type="math/tex">i</script>块里<script type="math/tex">A_j</script>出现的次数。维护<script type="math/tex">s_i</script>表示第<script type="math/tex">i</script>块的函数值的和。单点修改和询问的复杂度都是<script type="math/tex">O(\frac{n}{T})</script>。</p><p>对于零散部分，用树状数组维护<script type="math/tex">A</script>序列。修改是<script type="math/tex">O(\log_2n)</script>的，查询是<script type="math/tex">O(T\log_2n)</script>的。</p><p>取<script type="math/tex">T=\sqrt{\frac{n}{\log_2n}}</script>为最优时间复杂度，但空间复杂度过高。</p><p>把<script type="math/tex">T</script>调大一点，能过。</p><p>实测<script type="math/tex">T=\sqrt{n}</script>时能过。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/others/CodeChef-FNCS.cpp">代码</a></p><h2><a id="Yunna-的礼物" href="#Yunna-的礼物" class="headerlink" title="Yunna 的礼物"></a><a target="_blank" rel="noopener" href="http://darkbzoj.tk/problem/3920">Yunna 的礼物</a></h2><blockquote><p>给一个长度为<script type="math/tex">n</script>的序列<script type="math/tex">A</script>。</p><p>设<script type="math/tex">f(S,v)=\sum_{x\in S}[x=v]</script>（出现次数）。</p><p>设<script type="math/tex">g(S,c)=\{v\in S | f(S,v)=c\}</script>（出现次数为<script type="math/tex">c</script>的数的集合）。</p><p>设<script type="math/tex">h(S)=\{f(S,v)| v\in S\}</script>。</p><p>有<script type="math/tex">Q</script>次询问形如<script type="math/tex">(l,r,x,y)</script>：设<script type="math/tex">h([l,r])</script>中第<script type="math/tex">x</script>小的数为<script type="math/tex">z</script>，求<script type="math/tex">g([l,r],z)</script>中第<script type="math/tex">y</script>小的数。说白话就是，询问区间中出现次数第<script type="math/tex">x</script>小的数中第<script type="math/tex">y</script>小的数。</p><p><script type="math/tex">n,q,A_i\le 40000</script>。</p></blockquote><p><strong>摘要：莫队，线段树维护数集。</strong></p><p>提示：维护<script type="math/tex">S_i</script>表示出现次数为<script type="math/tex">i</script>的数的集合。其他细节显而易见。</p><p>时间复杂度<script type="math/tex">O(n\sqrt{n}\log_2 n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/bzoj/3920.cpp">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2020年2月29日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/String/Suffix-Array/">后缀数组</a></div><div class="prev-post"><a href="/String/String-Basics/">字符串导论 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>