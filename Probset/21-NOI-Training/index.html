<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>NOI2021 赛前训练日志 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">NOI2021 赛前训练日志</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年7月5日星期一晚上9点42分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年7月5日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 2,743 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Probset/">训练题单 </a><span class="icon smallarrow"></span> 当前文章</div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#离散计数中的迭代思想"><span class="toc-number">1.</span> <span class="toc-text">离散计数中的迭代思想</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BalticOI-小丑"><span class="toc-number">2.</span> <span class="toc-text">BalticOI 小丑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BalticOI-病毒"><span class="toc-number">3.</span> <span class="toc-text">BalticOI 病毒</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BalticOI-2020-村庄"><span class="toc-number">4.</span> <span class="toc-text">BalticOI 2020 村庄</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Julia-the-snail"><span class="toc-number">5.</span> <span class="toc-text">Julia the snail</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#算法一"><span class="toc-number">5.1.</span> <span class="toc-text">算法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法二"><span class="toc-number">5.2.</span> <span class="toc-text">算法二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#随机点分相关套路"><span class="toc-number">6.</span> <span class="toc-text">随机点分相关套路</span></a></li></ol></div><hr></div><div class="post-content"><p>训练赛可能是有独立的文章的。这里主要是一些杂题。</p><h2><a id="离散计数中的迭代思想" href="#离散计数中的迭代思想" class="headerlink" title="离散计数中的迭代思想"></a>离散计数中的迭代思想</h2><p>题型1：</p><blockquote><p>计算最小的<script type="math/tex">n</script>使得<script type="math/tex">1,\ldots, n</script>中满足某一条件的数占比大于等于<script type="math/tex">p</script>。<script type="math/tex">0\le p &lt; 1</script>。</p></blockquote><p>考虑一个迭代的过程。设<script type="math/tex">f(n)</script>表示<script type="math/tex">n</script>以内满足该条件的数的个数。</p><p>若当前的<script type="math/tex">n</script>不满足<script type="math/tex">\frac{f(n)}{n} \ge p</script>，我们就找到一个最小的<script type="math/tex">c</script>使得<script type="math/tex">\frac{f(n + c)}{n + c} \ge p</script>，然后令<script type="math/tex">n \gets n + c</script>。这样迭代下去直到<script type="math/tex">n</script>满足条件。</p><p>复杂度与满足该条件的数的分布有关。大多数时候是随机的，跑得应该比较快。</p><p>题型2：</p><blockquote><p>有<script type="math/tex">m</script>个条件。计算大于等于<script type="math/tex">n</script>的同时满足这<script type="math/tex">m</script>个条件的数的最小值。</p></blockquote><p>我们设<script type="math/tex">f(n, i)</script>表示大于等于<script type="math/tex">n</script>的满足第<script type="math/tex">i</script>个条件的数的最小值。</p><p>那么每次我们令<script type="math/tex">n \gets \max_i f(n, i)</script>，直到<script type="math/tex">n</script>不发生变化。</p><p>复杂度也和数据分布有关。</p><h2><a id="BalticOI-小丑" href="#BalticOI-小丑" class="headerlink" title="BalticOI 小丑"></a><a target="_blank" rel="noopener" href="https://loj.ac/p/3334">BalticOI 小丑</a></h2><p><span class="label">双指针</span> <span class="label">决策单调性</span></p><p>其实双指针的应用前提就是决策单调性。只不过大多数时候双指针的题目使用迭代足以胜任。</p><blockquote><p>给出<script type="math/tex">n</script>个点<script type="math/tex">m</script>条边无向图，<script type="math/tex">q</script>次询问<script type="math/tex">(l, r)</script>，问删除编号在<script type="math/tex">[l, r]</script>的边后图是否是二分图。<script type="math/tex">n, m, q\le 2\times 10^5</script>。</p></blockquote><p>首先我们考虑的是一个前缀和一个后缀的边集的并在一起是不是二分图。这个东西显然具有双指针性质。那么记<script type="math/tex">f(i)</script>表示最小的<script type="math/tex">j</script>使得<script type="math/tex">[1, i]</script>和<script type="math/tex">[j, m]</script>的边的并集是二分图。</p><p>直接在线维护动态图看起来很不太行。但是直接分治优化决策单调性就可以，思路也很显然，带撤销并查集即可。</p><p>另外，带撤销并查集是不能路径压缩的，虽然不知道为啥能过。应该是只能按秩合并的。</p><p>复杂度<script type="math/tex">O(n\log^2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://loj.ac/s/1166830">代码</a></p><h2><a id="BalticOI-病毒" href="#BalticOI-病毒" class="headerlink" title="BalticOI 病毒"></a><a target="_blank" rel="noopener" href="https://loj.ac/p/3337">BalticOI 病毒</a></h2><p><span class="label">AC 自动机</span> <span class="label">DP 转移优化</span> <span class="label">最短路</span></p><p>对抗体建 AC 自动机，把抗体结尾的结点 ban 掉。这样就将问题转化为是否存在一种突变使得不会走到 ban 的点，以及满足要求的最短突变长度。</p><p>一个初步的想法是设<script type="math/tex">f(i, j, k)</script>表示将基因<script type="math/tex">i</script>突变展开，且恰能够从 AC 自动机上的状态<script type="math/tex">j</script>走到状态<script type="math/tex">k</script>的最短展开长度。</p><p>这个东西不容易转移。</p><p>容易想到改进的方法。将每个突变的每个前缀建点。设<script type="math/tex">f(i, j, k)</script>表示将结点<script type="math/tex">i</script>突变展开，且恰能够从<script type="math/tex">j</script>走到<script type="math/tex">k</script>的最短展开长度。</p><p>这样就可以写出一些像样的转移。初始状态形如<script type="math/tex">f(i, x, x) = 0</script>。</p><p>但是容易发现这个转移有后效性。因为 AC 自动机不是 DAG。</p><p>那么一个经典的优化是用最短路优化。</p><p>但本题的转移其实更为特殊——会出现形如<script type="math/tex">f(i, x, y) + f(t, y, z) \to f(i + 1, x, z)</script>的转移。也就是说这个式子既可以理解为<script type="math/tex">f(i, x, y)</script>松弛<script type="math/tex">f(i + 1, x, z)</script>，也可以理解为<script type="math/tex">f(t, y, z)</script>松弛<script type="math/tex">f(i + 1, x, z)</script>。</p><p>那么如何实现？其实就是最短路优化 DP 的写法。上述特殊的转移并不会增加代码难度，只是笔者认为有必要告知，以辅助思考 DP 的转移方程。</p><p><a target="_blank" rel="noopener" href="https://loj.ac/s/1167321">代码</a></p><h2><a id="BalticOI-2020-村庄" href="#BalticOI-2020-村庄" class="headerlink" title="BalticOI 2020 村庄"></a><a target="_blank" rel="noopener" href="https://loj.ac/p/3336">BalticOI 2020 村庄</a></h2><p>结论题。不太想写代码。</p><p>最小：</p><ul><li>方法一：树上最大匹配，每个点的贡献是<script type="math/tex">1</script>。单点可以找与它相邻的环加进去，贡献是<script type="math/tex">2</script>。匹配可以看作二元环。</li><li>方法二：树形 DP 也可以，相当于子树要么全部匹配要么只剩它一个。</li></ul><p>最大：用每条边被遍历的次数算出上界。找到树的重心，删除重心的邻边后做<script type="math/tex">\frac{n}{2}</script>个匹配，要求不能是相同的连通块。可以证明这样构造恰好能达到上界。</p><h2><a id="Julia-the-snail" href="#Julia-the-snail" class="headerlink" title="Julia the snail"></a><a target="_blank" rel="noopener" href="https://codeforces.com/contest/793/problem/F">Julia the snail</a></h2><p><span class="label">分块</span> <span class="label">莫队</span> <span class="label">线段树</span> <span class="label">吉老师线段树</span> <span class="label">势能分析</span></p><blockquote><p>有<script type="math/tex">n</script>个点，<script type="math/tex">m</script>个形如<script type="math/tex">(l, r)</script>，其中<script type="math/tex">l \le r</script>且<script type="math/tex">r</script>互不相同的传送门，表示你可以从结点<script type="math/tex">l</script>跳到<script type="math/tex">r</script>。</p><p>有<script type="math/tex">q</script>个询问<script type="math/tex">(x, y)</script>其中<script type="math/tex">x\le y</script>，问从<script type="math/tex">x</script>出发在不经过编号大于<script type="math/tex">y</script>的结点的情况下能走到的编号最大的点。</p><p><script type="math/tex">n, m, q\le 10^5</script>。</p></blockquote><h3><a id="算法一" href="#算法一" class="headerlink" title="算法一"></a>算法一</h3><p>分块。</p><p>假设已知<script type="math/tex">(x, y)</script>的答案，记作<script type="math/tex">ans(x, y)</script>。</p><p>算法 A：考虑求<script type="math/tex">(x, y + 1)</script>的答案。那么我们考虑右端点为<script type="math/tex">y + 1</script>，左端点大于等于<script type="math/tex">x</script>的传送门。如果存在一个这样的传送门其左端点小于等于<script type="math/tex">ans(x, y)</script>，那么我们就可以通过这个传送门走到<script type="math/tex">y + 1</script>。也就是说我们可以<script type="math/tex">O(\log)</script>更新答案。</p><p>算法 B：考虑求<script type="math/tex">(x - 1, y)</script>的答案。那么我们考虑左端点为<script type="math/tex">x - 1</script>，右端点小于等于<script type="math/tex">y</script>的传送门，找到其中右端点最大的那个，记作<script type="math/tex">(x - 1, y')</script>。那么显然有<script type="math/tex">ans(x - 1, y) = \max_{x\le z\le y'} ans(z, y)</script>。因此固定<script type="math/tex">y</script>计算询问我们可以倒着枚举<script type="math/tex">x</script>，单调栈维护最大值。</p><p>将上述两种方法结合。分块后将询问按右端点所在块分类，算法 A 可以简单撤销，所以很容易想到回滚莫队做法。</p><p>实际上在结合两种算法后会发现，算法过程中左端点是单调递减的，因此算法 A 可以优化为<script type="math/tex">O(1)</script>。</p><p>时间复杂度<script type="math/tex">O(n\sqrt{n})</script>。</p><h3><a id="算法二" href="#算法二" class="headerlink" title="算法二"></a>算法二</h3><p>考虑上述算法 B，直接对右端点做扫描线，记<script type="math/tex">c_i</script>表示在当前扫描线状态下左端点为<script type="math/tex">i</script>时的答案。</p><p>当<script type="math/tex">y \to y + 1</script>时，枚举所有以<script type="math/tex">y + 1</script>为右端点的传送门，记作<script type="math/tex">(x', y + 1)</script>。我们会将<script type="math/tex">c[1, x']</script>中所有<script type="math/tex">\ge x'</script>的值都赋值为<script type="math/tex">y + 1</script>。</p><p>也就是说我们会将一个区间里大于等于某个阈值<script type="math/tex">t</script>的数赋值为另一个<script type="math/tex">\ge t</script>的数。</p><p>这个可以用势能分析线段树（吉老师线段树）做。记区间最大值和去重的次大值即可。</p><p>实现过程会稍显细节。但只要把握要点就不会写错：pushup 时儿子结点的信息是【同步且正确】的，pushdown 时 儿子结点的信息在这次操作之前是【同步且正确】的。详见代码中的 pushdown 函数。</p><p>时间复杂度<script type="math/tex">O((n + m + q) \log^2 n)</script>。</p><p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/793/problem/F">代码</a></p><h2><a id="随机点分相关套路" href="#随机点分相关套路" class="headerlink" title="随机点分相关套路"></a>随机点分相关套路</h2><p>将一棵树随机点分的计数问题有这样一些套路。</p><blockquote><p>随机点分方案数。</p></blockquote><p>将两个连通块连在一起，两者对应的点分树变化只与某些点有关。具体地说，设连上的边是<script type="math/tex">(u, v)</script>，两者的点分树根节点分别是<script type="math/tex">A</script>和<script type="math/tex">B</script>，那么点分方案合并本质上是<strong>点分树上</strong><script type="math/tex">A</script>到<script type="math/tex">u</script>的路径与<script type="math/tex">B</script>到<script type="math/tex">v</script>的路径合并。因此只需要记<script type="math/tex">u</script>和<script type="math/tex">v</script>在点分方案中的深度即可完成 DP 转移。时间复杂度<script type="math/tex">O(n^2)</script>。详见<a href="https://notes.sshwy.name/ZROI/20sx/winter-day3/">此文</a>。</p><blockquote><p>随机点分的贡献和。</p></blockquote><p>这个问题视具体情况而定，但通常来讲是难以应用方才讲述的套路的。这种时候可以考虑将贡献均摊到点上，枚举每个点分别计算。</p><p>具体来说考虑以下问题：</p><blockquote><p>随机点分，计算点分树上每个结点的子树大小之和的期望。即随机点分期望复杂度。</p></blockquote><p>结点子树大小之和很容易转化为点分树上结点的深度之和，进而将原问题转化为每个结点在点分树上深度的期望之和。</p><p>结点<script type="math/tex">u</script>在点分树上的深度的期望等价于：枚举一个点<script type="math/tex">v</script>，计算<script type="math/tex">v</script>是<script type="math/tex">u</script>点分树上祖先的概率之和。</p><p>要让<script type="math/tex">v</script>是<script type="math/tex">u</script>点分树上的祖先，那么就要求<script type="math/tex">v</script>比<script type="math/tex">u</script>到<script type="math/tex">v</script>路径上的点（包括<script type="math/tex">u</script>）都早删除。</p><p>因此不妨定<script type="math/tex">u</script>为树根，则深度期望可以简单表示为<script type="math/tex">\sum_{v \ne u} \frac{1}{\text{dep}_v}</script>，其中<script type="math/tex">\text{dep}</script>表示深度。</p><p>时间复杂度<script type="math/tex">O(n^2)</script>。可能可以优化。</p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年7月5日 第3次修订</li><li class="post-history-item">2021年7月3日 第2次修订</li><li class="post-history-item">2021年6月28日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Full-Mark-Composition/">高爸生活在 OI 上</a></div><div class="prev-post"><a href="/Math/Polynomial/EGF/">指数生成函数学习笔记 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>