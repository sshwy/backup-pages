<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>五一集训 杂题练习 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">五一集训 杂题练习</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年2月11日星期四中午12点26分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年2月11日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 2,620 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Probset/">训练题单 </a><span class="icon smallarrow"></span> 当前文章</div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Mole-Tunnels"><span class="toc-number">1.</span> <span class="toc-text">Mole Tunnels</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Addition-and-Subtraction-Hard"><span class="toc-number">2.</span> <span class="toc-text">Addition and Subtraction Hard</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#K-th-K"><span class="toc-number">3.</span> <span class="toc-text">K-th K</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Yet-Another-String-Matching-Problem"><span class="toc-number">4.</span> <span class="toc-text">Yet Another String Matching Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#树上的最短路"><span class="toc-number">5.</span> <span class="toc-text">树上的最短路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#算法一"><span class="toc-number">5.1.</span> <span class="toc-text">算法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法二"><span class="toc-number">5.2.</span> <span class="toc-text">算法二</span></a></li></ol></li></ol></div><hr></div><div class="post-content"><h2><a id="Mole-Tunnels" href="#Mole-Tunnels" class="headerlink" title="Mole Tunnels"></a><a target="_blank" rel="noopener" href="https://darkbzoj.tk/problem/4849">Mole Tunnels</a></h2><blockquote><p>有一棵<script type="math/tex">n</script>个点完全二叉树，<script type="math/tex">i</script>的父亲是<script type="math/tex">\lfloor\frac{i}{2}\rfloor</script>。有<script type="math/tex">m</script>个球，分别位于<script type="math/tex">p_i</script>号结点。同时，每一个结点有一个容量<script type="math/tex">c_i</script>，表示可以容纳的球的个数。如果一个点容纳不下了，就要把多于的球移动到其他点去。</p><p>对于所有<script type="math/tex">1\le i\le m</script>，询问前<script type="math/tex">i</script>个球要放到结点且不超过容量的的最小移动的总步数。</p><p><script type="math/tex">n,m\le 10^5</script>，保证有合法方案。</p></blockquote><p><span class="label">费用流</span> <span class="label">细节</span></p><p>容易想到费用流。由于树高是<script type="math/tex">O(\log_2n)</script>的，因此我们可以暴力模拟増广的过程。每次増广的路径一定是先向上后向下的，因此记录<script type="math/tex">f(u)</script>表示结点<script type="math/tex">u</script>子树里费用最小的能到达汇点的流。増广的时候可以暴力増广，更新。</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/bzoj/4849.cpp">代码</a></p><h2><a id="Addition-and-Subtraction-Hard" href="#Addition-and-Subtraction-Hard" class="headerlink" title="Addition and Subtraction Hard"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc066/tasks/arc066_c">Addition and Subtraction Hard</a></h2><blockquote><p>给你一个只有加法和减法的表达式，你需要向里面加括号，使得表达式的值最大。</p><p><script type="math/tex">n\le 10^5</script>。</p></blockquote><p><span class="label">贪心</span></p><p>左括号一定在减号后面。第一个左括号后的一些加都会变成减，其他可以变成绝对值的形式。例如</p><script type="math/tex;mode=display">a-b+c-d-e+f-g</script><p>可以变成</p><script type="math/tex;mode=display">a-(b+c-d-(e+f)-g)=a-b-c+d+e+f+g</script><p>枚举左括号找最小即可。</p><p>时间复杂度<script type="math/tex">O(n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/arc066_c.cpp">代码</a></p><h2><a id="K-th-K" href="#K-th-K" class="headerlink" title="K-th K"></a><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/agc008/tasks/agc008_d">K-th K</a></h2><blockquote><p>给定长度为 n 的序列<script type="math/tex">x_i</script>，求一个长度为<script type="math/tex">n^2</script>的序列，其中<script type="math/tex">1,\cdots,n</script>每个数都出现了<script type="math/tex">n</script>次，要求满足第<script type="math/tex">i</script>个<script type="math/tex">i</script>在第<script type="math/tex">x_i</script>个位置。构造可行解或输出无解。</p><p><script type="math/tex">1\le n\le 500</script>。</p></blockquote><p><span class="label">贪心</span></p><p>每个位置都尽可能的选择在<script type="math/tex">x_i</script>之前还没满<script type="math/tex">i−1</script>个<script type="math/tex">i</script>的<script type="math/tex">x_i</script>最小的<script type="math/tex">i</script>即可。</p><p>时间复杂度<script type="math/tex">O(n^3)</script>或者<script type="math/tex">O(n^2)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/atcoder/agc008_d.cpp">代码</a></p><h2><a id="Yet-Another-String-Matching-Problem" href="#Yet-Another-String-Matching-Problem" class="headerlink" title="Yet Another String Matching Problem"></a><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/954/I">Yet Another String Matching Problem</a></h2><blockquote><p>给定两个字符串<script type="math/tex">S, T</script>，字符集为<script type="math/tex">a\sim f</script>，每次操作任选两个字符<script type="math/tex">c_1,c_2</script>，可以将<script type="math/tex">S</script>和<script type="math/tex">T</script>中的所有<script type="math/tex">c_1</script>替换成<script type="math/tex">c_2</script>。对<script type="math/tex">S</script>中每一个长度为<script type="math/tex">|T|</script>的子串，求最小操作次数使得它们相等。</p><p><script type="math/tex">n\le 125000</script>。</p></blockquote><p>去你妈的 <span class="label">多项式</span></p><p>我们要 <span class="label">KMP</span></p><p>对于两个等长字符串<script type="math/tex">a,b</script>，考虑求出让它们相等的操作次数。如果<script type="math/tex">a_i\ne b_i</script>，我们就把字符<script type="math/tex">a_i</script>和<script type="math/tex">b_i</script>连边。那么答案就是<script type="math/tex">|\Sigma|</script>减去连通块的数量。</p><p>那么我们设<script type="math/tex">f(x,y,i)</script>表示字符<script type="math/tex">x,y</script>在<script type="math/tex">S[i,i+|T|-1]</script>和<script type="math/tex">T</script>上是否连边。那么<script type="math/tex">f(x,y)</script>可以一波 NTT 猛如虎。</p><p>然而我们不要用这个憨批做法。</p><p>考虑枚举字符集的子集<script type="math/tex">S</script>。设<script type="math/tex">a_i=[s_i\in S]</script>，<script type="math/tex">b_i=[t_i\in S]</script>。那么如果<script type="math/tex">a[i,i+|T|-1]</script>和<script type="math/tex">b</script>匹配，说明这个子集没有向外连出的边，也就是说这个子集恰好包含了若干个连通块。而满足这个条件的子集恰好是 2 的连通块个数次方。因此求出了匹配的数量就可以快速算出连通块个数。匹配就直接 KMP 就行了。</p><p>时间复杂度<script type="math/tex">O(2^{|\Sigma|}n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/codeforces/954i.cpp">代码</a></p><h2><a id="树上的最短路" href="#树上的最短路" class="headerlink" title="树上的最短路"></a><a target="_blank" rel="noopener" href="https://darkbzoj.tk/problem/4699">树上的最短路</a></h2><blockquote><p>给出一棵<script type="math/tex">n</script>个点边带权的树，树边是无向边。有<script type="math/tex">m</script>个五元组<script type="math/tex">(a,b,x,y,c)</script>表示对于路径<script type="math/tex">(a,b)</script>上的任意结点<script type="math/tex">u</script>和<script type="math/tex">(x,y)</script>上的任意结点<script type="math/tex">v</script>，都有从<script type="math/tex">u</script>到<script type="math/tex">v</script>权值为<script type="math/tex">c</script>的无向边。</p><p>给出一个点<script type="math/tex">s</script>，求从<script type="math/tex">s</script>出发到所有点的单源最短路。</p><p><script type="math/tex">n\le 2.5\times 10^5,m\le 10^5</script>。</p></blockquote><h3><a id="算法一" href="#算法一" class="headerlink" title="算法一"></a>算法一</h3><p>树链剖分，每条路径可以拆成<script type="math/tex">O(\log_2n)</script>个点。对于一个五元组，建立一个中间点，可以建<script type="math/tex">O(\log_2n)</script>条边。总边数是<script type="math/tex">O(n+m\log_2n)</script>。使用 Dijkstra 算法，时间复杂度<script type="math/tex">O(n\log_2n + m\log_2^2n)</script>。</p><h3><a id="算法二" href="#算法二" class="headerlink" title="算法二"></a>算法二</h3><p>考虑 Dijkstra 的一个变种算法。我们在堆里同时存点和边。对于一个点我们存到达这个点的最短路，对于一条（有向）边我们存到达它起点的最短路加上它的长度。每次取出堆顶：</p><ul><li>如果是一个点，那么它所有邻边的最短路就<strong>确定</strong>了，把它的邻边放进堆里（如果这些邻边之前没有被访问过）。</li><li>如果是一条边，那么它的终点的最短路就<strong>确定</strong>了，把它的终点放进堆里（如果这个点之前没有被访问过）。</li></ul><p>这样我们发现，每个点和每条边最多被更新一次。</p><p>那么我们算法的复杂度下界就变成了总点数（<script type="math/tex">O(n+m\log_2n)</script>）。</p><p>接下来我们优化 Dijkstra 的过程。如果说我们能把一个五元组用一个对象来代替（算法一使用了<script type="math/tex">O(\log_2n)</script>个对象），那么总的对象数（边数）就变成了<script type="math/tex">O(n+m)</script>，则 Dijkstra 的堆操作复杂度就优化成了<script type="math/tex">O((n+m)\log_2n)</script>。也就是说，Djikstra 的堆里存两类对象：</p><ul><li>边的集合：也就是一个五元组<script type="math/tex">(a,b,x,y,c)</script>。可以更新它到达的点集的最短路。所谓到达的点集，就是路径<script type="math/tex">(x,y)</script>上的点。</li><li>结点：可以更新包含它作为起点的五元组（边集）的最短路。</li></ul><p>接下来考虑具体的更新方法。</p><p>如果堆顶是一个五元组<script type="math/tex">(a,b,x,y,c)</script>，那么我们就要找到路径<script type="math/tex">(x,y)</script>上所有还未被访问过的点。这个可以并查集维护。这部分的均摊复杂度是<script type="math/tex">O(\log_2n)</script>。</p><p>如果堆顶是一个结点<script type="math/tex">u</script>，我们就要找到所有包含<script type="math/tex">u</script>作为起点的，还未被访问过的五元组，即所有<script type="math/tex">u</script>被包含在路径<script type="math/tex">(a,b)</script>的五元组<script type="math/tex">(a,b,x,y,c)</script>。而包含<script type="math/tex">u</script>的路径有两种情况：</p><ul><li>一个端点在<script type="math/tex">u</script>子树内，一个端点在<script type="math/tex">u</script>子树外。</li><li><script type="math/tex">u</script>是两个端点的 LCA。</li></ul><p>第二种情况可以每个点开一个 vector 维护。</p><p>对于第一种情况，我们预处理整颗树的 DFS 序，那么子树的 DFS 序是一段连续的区间。考虑一个小根堆序列<script type="math/tex">A_1,A_2,\ldots,A_n</script>，其中<script type="math/tex">A_i</script>表示满足<script type="math/tex">\textit{dfn}(a)=i</script>或<script type="math/tex">\textit{dfn}(b)=i</script>的五元组集合。它的优先级是：另一个端点的 DFS 序越小，优先级越大。那么对于<script type="math/tex">u</script>的子树，假设它对应的区间是<script type="math/tex">L_u,R_u</script>，我们就查询<script type="math/tex">A[L_u,R_u]</script>里的最小值。如果最小值的端点在<script type="math/tex">u</script>的子树外，就更新它，然后从堆中删除它。</p><p>类似地，维护一个大根堆序列来处理最大值。每一个五元组至多被删除两次（两个序列里各一次），因此均摊复杂度仍是<script type="math/tex">O(\log_2n)</script>。</p><p>算法总复杂度<script type="math/tex">O((n+m)\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/bzoj/4699.cpp">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年2月11日 第2次修订</li><li class="post-history-item">2020年6月12日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Probset/NOIo-day2/">NOI Online 提高组 Day2</a></div><div class="prev-post"><a href="/Probset/BJOI2018/">BJOI 2018 大部分题解 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>