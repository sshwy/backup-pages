<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>WC 赛前训练日志 3 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">WC 赛前训练日志 3</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年2月11日星期四中午12点26分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年2月11日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 2,312 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Probset/">训练题单 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/WC2021/">WC2021</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nagisa"><span class="toc-number">1.</span> <span class="toc-text">Nagisa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tomoya"><span class="toc-number">2.</span> <span class="toc-text">Tomoya</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#没有自环"><span class="toc-number">2.1.</span> <span class="toc-text">没有自环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有自环"><span class="toc-number">2.2.</span> <span class="toc-text">有自环</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Battle-Lemmings"><span class="toc-number">3.</span> <span class="toc-text">Battle Lemmings</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Case-1"><span class="toc-number">3.1.</span> <span class="toc-text">Case 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Case-2"><span class="toc-number">3.2.</span> <span class="toc-text">Case 2</span></a></li></ol></li></ol></div><hr></div><div class="post-content"><h2><a id="Nagisa" href="#Nagisa" class="headerlink" title="Nagisa"></a><a target="_blank" rel="noopener" href="http://www.zhengruioi.com/contest/803/problem/144">Nagisa</a></h2><blockquote><p>二维平面，给出三个<script type="math/tex">n</script>个点的凸多边形，有<script type="math/tex">q</script>次询问，每次给出一个点，问是否存在一个三个顶点分别在凸多边形里的三角形，使得三角形的重心是这个点。</p><p><script type="math/tex">n,q\le 10^6</script>。</p></blockquote><p><span class="label">计算几何</span> <span class="label">凸包</span> <span class="label">闵可夫斯基和</span></p><p>这题的重点是，我凸包求错了。有两个问题：</p><ul><li>分类讨论的时候没有讨论全，被 assert 打爆了。</li><li>求凸包的时候如果按照<script type="math/tex">(x,y)</script>排序，求上凸包是对的，求下凸包就不对了。虽然我也不懂为啥。</li></ul><p>最好的策略似乎是只求上凸包，然后翻转一下再做一次。</p><h2><a id="Tomoya" href="#Tomoya" class="headerlink" title="Tomoya"></a><a target="_blank" rel="noopener" href="http://www.zhengruioi.com/contest/803/problem/145">Tomoya</a></h2><blockquote><p>给出一个<script type="math/tex">n</script>个点<script type="math/tex">m</script>条边有向有自环有重边<strong>无非自环的环</strong>的图，即一个 DAG 加上若干个自环。每条边有一个<strong>实数</strong>边权。要求你从<script type="math/tex">S</script>走到<script type="math/tex">T</script>。你每走到一个点（包括最开始的<script type="math/tex">S</script>），这个点的出边（自环也算出边）的边权就会被等概率随机打乱，而你可以看到打乱后的结果，并决定走哪条边。你的目标是走过的边权和最小。</p><p>问最优策略的期望边权和，输出<strong>实数</strong>。</p><p><script type="math/tex">n, m\le 1000</script>。</p></blockquote><p><span class="label">期望</span></p><p>期望题的套路：设<script type="math/tex">E(u)</script>表示<script type="math/tex">u</script>走到<script type="math/tex">T</script>的期望。</p><h3><a id="没有自环" href="#没有自环" class="headerlink" title="没有自环"></a>没有自环</h3><p>记<script type="math/tex">u</script>的后继分别是<script type="math/tex">v_1, \ldots, v_k</script>。记<script type="math/tex">u</script>的出边边权分别为<script type="math/tex">w_1,\ldots,w_k</script>。</p><p>如果<script type="math/tex">u</script>没有自环，那么你会选择<script type="math/tex">E(v)+w</script>最小的走。对于<script type="math/tex">w</script>的每个排列，我们要算<script type="math/tex">E(v_i) + w_i</script>的最小值。</p><p>由于<script type="math/tex">E(v) + w</script>只有<script type="math/tex">O(k^2)</script>个不同的值。考虑枚举这个最小值<script type="math/tex">x</script>，那么我们要求剩下<script type="math/tex">k-1</script>个的值都大于等于<script type="math/tex">x</script>。那么把<script type="math/tex">w</script>和<script type="math/tex">v</script>分别从小到大排序，相当于每个<script type="math/tex">v_i</script>能选的<script type="math/tex">w_j</script>是一段后缀。方案数是乘积的形式。</p><p>那么我们从小到大枚举<script type="math/tex">E(v) + w</script>的值，发现每次对乘积的影响是<script type="math/tex">O(1)</script>的。也就是说只有<script type="math/tex">O(1)</script>个数能选的范围发生改变。这样就可以<script type="math/tex">O(k^2\log_2k)</script>计算期望。</p><h3><a id="有自环" href="#有自环" class="headerlink" title="有自环"></a>有自环</h3><p>如果<script type="math/tex">u</script>有自环，那么我们就多了一个决策：走自环到<script type="math/tex">u</script>。决策涉及到了自身，就不能简单地建立无后效性的转移关系，因此考虑建立等式。也就是说<script type="math/tex">E(u) = p(c_1 + E(v)) + (1-p)c_2</script>，意思是说我们以<script type="math/tex">p</script>的概率走自环，代价为<script type="math/tex">c_1</script>，然后再走这个期望，或者我们直接走出去，代价是<script type="math/tex">c_2</script>。</p><p>然而本题难点在于，该等式的系数表达难以得到。也就是说我们不知道这个等式长啥样。</p><p>考虑执行一个结果收敛的迭代过程。假设我已经求出了<script type="math/tex">E(u) = x_0</script>，那么我们可以建立怎样的等式？</p><p>这时一个精妙的思路来了：因为<script type="math/tex">E(u)</script>在逻辑上被视为常量，那么自环就可以变成普通边了！</p><p>如果<script type="math/tex">u</script>有<script type="math/tex">t</script>个自环，那么我就把这<script type="math/tex">t</script>个自环删掉，给<script type="math/tex">u</script>新增<script type="math/tex">t</script>个后继，新增后继的期望都设为<script type="math/tex">E(u)</script>。那么这就转化为没有自环的情况了。因此我们就可以用<script type="math/tex">x_0</script>求出<script type="math/tex">u</script>的期望<script type="math/tex">E'(u)</script>了。</p><p>如果<script type="math/tex">x_0</script>是<script type="math/tex">E(u)</script>的精确值，那么用<script type="math/tex">x_0</script>求出的<script type="math/tex">E'(u)</script>就应该满足<script type="math/tex">E'(u) = x_0</script>。否则，<script type="math/tex">E'(u)</script>就与<script type="math/tex">x_0</script>有误差。而这个误差是收敛的。也就是说我们不断地令<script type="math/tex">x_0 = E'(u)</script>然后再用<script type="math/tex">x_0</script>求出新的<script type="math/tex">E'(u)</script>，无限次后就可以得到<script type="math/tex">E(u)</script>的精确值。</p><p>直接迭代太慢。改成二分就行。</p><p>时间复杂度<script type="math/tex">O(nm\log_2W)</script>。</p><h2><a id="Battle-Lemmings" href="#Battle-Lemmings" class="headerlink" title="Battle Lemmings"></a><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1420/problem/E">Battle Lemmings</a></h2><blockquote><p>有一个长度为<script type="math/tex">n</script>的 01 序列<script type="math/tex">s</script>。每次你可以把一个<script type="math/tex">1</script>和与它相邻的<script type="math/tex">0</script>交换位置。定义一个序列的价值是满足以下条件的区间<script type="math/tex">[l,r]</script>的个数：</p><ul><li><script type="math/tex">s_l = s_r = 0</script>。</li><li>存在<script type="math/tex">l&lt;i&lt;r</script>使得<script type="math/tex">s_i=1</script>。</li></ul><p>现在对于<script type="math/tex">k = 0,1,\ldots, \frac{n(n-1)}{2}</script>，要求你求出在执行至多<script type="math/tex">k</script>次操作的情况下，序列的价值的最大值。</p><p><script type="math/tex">1\le n\le 80</script>。</p></blockquote><p>将求最大价值转化为求最小代价。设由<script type="math/tex">0</script>构成的极长连续段的长度的集合是<script type="math/tex">L</script>，那么序列<script type="math/tex">s</script>的代价可以描述为</p><script type="math/tex;mode=display">\sum_{l \in L(s)} \binom{l}{2}</script><p><script type="math/tex">f(i,j,k)</script>表示考虑前<script type="math/tex">i</script>个<script type="math/tex">1</script>，第<script type="math/tex">i</script>个<script type="math/tex">1</script>的位置是<script type="math/tex">j</script>，一共动了<script type="math/tex">k</script>步的最小代价。</p><p>考虑转移，<script type="math/tex">f(i,j,k) = \min_{p&lt;j} f(i-1,p,k-|a_i-j|) + \binom{j-p-1}{2}</script>。</p><p>不妨分类讨论。</p><h3><a id="Case-1" href="#Case-1" class="headerlink" title="Case 1"></a>Case 1</h3><p>对于<script type="math/tex">a_i\ge j</script>的情况，<script type="math/tex">f(i,j,k) = \min_{p&lt;j} f(i-1,p,k-a_i+j) + \binom{j-p-1}{2}</script>。</p><p>固定<script type="math/tex">x = k - a_i + j</script>，固定<script type="math/tex">i</script>，那么</p><p><script type="math/tex">f(i,j,x+a_i - j) = \min_{p&lt;j}f(i-1,p,x) + \binom{j-p-1}{2}</script>。</p><p>右边是一个只与<script type="math/tex">j</script>和<script type="math/tex">p</script>有关的式子，那么</p><p><script type="math/tex">2f(i,j,x+a_i-j) - j^2 + 3j = - 2jp + (2f(i-1,p,x) + p^2  + 3p + 2)</script>.</p><p>不妨设左边的是<script type="math/tex">b_j</script>，与<script type="math/tex">p</script>有关的部分是<script type="math/tex">y_p</script>，设<script type="math/tex">k_j = 2j</script>，那么</p><p><script type="math/tex">b_j = -k_jp + y_p</script>。这是让一条斜率为<script type="math/tex">k_j</script>的直线过<script type="math/tex">(p,y_p)</script>这个点，并最小化截距<script type="math/tex">b_j</script>的问题。</p><p>注意到<script type="math/tex">k_j</script>和<script type="math/tex">p</script>都是单调的，可以直接斜率优化。</p><p>计算的时候按照<script type="math/tex">j</script>从小到大的顺序。固定<script type="math/tex">i</script>，将 DP 状态<script type="math/tex">f(i,j,k)</script>按照<script type="math/tex">j+k</script>的值分类（可以发现是一条一条斜线）。这样我们可以用单调队列维护凸壳，计算完同一类的 DP 状态。</p><h3><a id="Case-2" href="#Case-2" class="headerlink" title="Case 2"></a>Case 2</h3><p>对于<script type="math/tex">a_i &lt; j</script>的情况，<script type="math/tex">f(i,j,k) = \min_{p&lt;j} f(i-1,p,k+a_i-j) + \binom{j-p-1}{2}</script>。</p><p>固定<script type="math/tex">x = k + a_i - j</script>，固定<script type="math/tex">i</script>，那么</p><p><script type="math/tex">f(i,j,x - a_i + j) = \min_{p&lt;j} f(i-1,p,x) + \binom{j-p-1}{2}</script>.</p><p><script type="math/tex">2f(i,j,x - a_i + j) - j^2 + 3j = -2jp + (2f(i-1,p,x) + p^2 + 3p + 2)</script>.</p><p>不妨设左边的是<script type="math/tex">b_j</script>，与<script type="math/tex">p</script>有关的部分是<script type="math/tex">y_p</script>，设<script type="math/tex">k_j = 2j</script>，那么</p><p><script type="math/tex">b_j = -k_jp + y_p</script>。</p><p>同样的方法，按照<script type="math/tex">j-k</script>对状态分类即可。</p><p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1420/submission/105579610">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年2月11日 第5次修订</li><li class="post-history-item">2021年2月10日 第4次修订</li><li class="post-history-item">2021年1月28日 第3次修订</li><li class="post-history-item">2021年1月26日 第2次修订</li><li class="post-history-item">2021年1月22日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Probset/BJOI2018/">BJOI 2018 大部分题解</a></div><div class="prev-post"><a href="/Gao/part-3/">高爸的杂题练习 3 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>