<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>2021 五月训练日志 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">2021 五月训练日志</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年6月22日星期二晚上8点39分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年6月22日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 2,714 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Probset/">训练题单 </a><span class="icon smallarrow"></span> 当前文章</div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PKUSC2018-PKUSC"><span class="toc-number">1.</span> <span class="toc-text">PKUSC2018 PKUSC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NOI2019-回家路线"><span class="toc-number">2.</span> <span class="toc-text">NOI2019 回家路线</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NOI2019-序列"><span class="toc-number">3.</span> <span class="toc-text">NOI2019 序列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NOI2019-弹跳"><span class="toc-number">4.</span> <span class="toc-text">NOI2019 弹跳</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NOI2019-斗主地"><span class="toc-number">5.</span> <span class="toc-text">NOI2019 斗主地</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PKUSC2018-星际穿越"><span class="toc-number">6.</span> <span class="toc-text">PKUSC2018 星际穿越</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="PKUSC2018-PKUSC" href="#PKUSC2018-PKUSC" class="headerlink" title="PKUSC2018 PKUSC"></a><a target="_blank" rel="noopener" href="https://loj.ac/p/6437">PKUSC2018 PKUSC</a></h2><p><span class="label">PKUSC</span> <span class="label">计算几何</span> <span class="label">圆</span></p><p>暴力。把多边形拆成有向边，问题转化为计算一个线段与圆的交（交集是线段）。这个可以做一个类似区别交的东西（这里的区间长度定义为是端点的辐角差）。</p><p>时间复杂度<script type="math/tex">O(nm)</script>。</p><p>细节不多。见代码。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/loj/6437.cpp">代码</a></p><h2><a id="NOI2019-回家路线" href="#NOI2019-回家路线" class="headerlink" title="NOI2019 回家路线"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P6302">NOI2019 回家路线</a></h2><p><span class="label">NOI</span> <span class="label">斜率优化</span> <span class="label">李超树</span> <span class="label">DAG</span></p><p>首先，小猫走的路径是没有环的（时间不能倒流）。因此实质上本题的图是一个 DAG。</p><p>更具体地说，我们用二元组<script type="math/tex">(u, t)</script>表示「在时刻<script type="math/tex">t</script>到达结点<script type="math/tex">u</script>」。将题面中的模型转化为点集为<script type="math/tex">(u, t)</script>的图，就是一个 DAG。问题转化为求 DAG 上从<script type="math/tex">(0, 0)</script>到<script type="math/tex">(n, ?)</script>的最小代价。</p><p>本题的代价是与等待时间的连续段有关的，难以均摊到每条边上。换句话说，你没法最短路，除非你暴力建<script type="math/tex">O(n^2)</script>条边。不过注意到每次等待只会发生在单个结点上。因此我们将视角切换到一个结点<script type="math/tex">u</script>上。则在这个结点上按照时间顺序会有两种事件：列车到站和列车出发。</p><p>因此我们考虑在时刻<script type="math/tex">t_i</script>到达<script type="math/tex">u</script>，花费的最小代价设为<script type="math/tex">c_i</script>，而时刻<script type="math/tex">t_j</script>有另一列车从<script type="math/tex">u</script>出发（<script type="math/tex">t_i\le t_j</script>）于<script type="math/tex">t_k</script>时刻到达<script type="math/tex">v</script>。则到达<script type="math/tex">(v, t_k)</script>的代价更新为</p><script type="math/tex;mode=display">A(t_j - t_i)^2 + B(t_j - t_i) + C</script><p>这是一个典型的斜率优化转移。</p><p>在实现的时候我们需要开<script type="math/tex">n</script>个队列（数组）。</p><p>时间复杂度<script type="math/tex">O(m\log_2m)</script>，如果使用线性的排序方式可以做到<script type="math/tex">O(m)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/5468.cpp">代码</a></p><p>注：斜率优化维护下凸壳时，在插入点的时候，对于横坐标相等的情况要特判：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">check</span><span class="token expression"><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> Z<span class="token punctuation">)</span> <span class="token punctuation">(</span>Y<span class="token punctuation">.</span>x <span class="token operator">==</span> Z<span class="token punctuation">.</span>x <span class="token operator">?</span> <span class="token punctuation">(</span>Y<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> Z<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token function">det</span><span class="token punctuation">(</span><span class="token function">Vec</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Vec</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span> Z<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2><a id="NOI2019-序列" href="#NOI2019-序列" class="headerlink" title="NOI2019 序列"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5470">NOI2019 序列</a></h2><p><span class="label">NOI</span> <span class="label">模拟费用流</span> <span class="label">贪心</span></p><p>首先容易想到一个费用流做法，建模类似这样</p><p><img src="../../images/21-May-1.png" alt="NOI2019 sequence"></p><p>虚线部分表示选择不一定匹配的两个。</p><p>写得好应该可以获得<script type="math/tex">64</script>分。</p><p>满分做法是考虑优化计算费用流的过程。也就是说我们不使用常规的费用流算法，而是根据本题中费用流模型的特殊结构，设计算法模拟费用流的过程。</p><p>就本题而言我们模拟増广路算法。増广路算法的特征是每次找费用的最短路，也就是贪心。</p><p>观察发现，每次増广相当于是左边选了一个<script type="math/tex">a_x</script>右边选了一个<script type="math/tex">b_y</script>。中间怎么流我们其实不关心，因为没有费用，只有一个限制：满足<script type="math/tex">(c,d)</script>这条边的容量限制。因此我们的问题可以抽象为一个贪心选数的问题。</p><p>如果<script type="math/tex">(c, d)</script>这条边没有满流，那么増广过程等价于贪心选择<script type="math/tex">a</script>的最大值和<script type="math/tex">b</script>的最大值，直到满流。</p><p>如果满流，那么我们有三种増广路（选数）类型：</p><ol><li>选择两个相匹配的数<script type="math/tex">(a_i, b_i)</script>，且这两个数之前没有被选过。</li><li>对于<script type="math/tex">(a_i, b_i)</script>其中<script type="math/tex">a_i</script>被选，<script type="math/tex">b_i</script>未选。那么我们选上<script type="math/tex">b_i</script>，含义是给一个<script type="math/tex">S\to a_i\to b_i\to T</script>的流，踢掉原本<script type="math/tex">a_i \to c</script>的流。这时<script type="math/tex">c</script>的入流少了<script type="math/tex">1</script>，那么我们再从未选的<script type="math/tex">a_i</script>中贪心拿最大的即可。</li><li>对于<script type="math/tex">(a_i, b_i)</script>其中<script type="math/tex">a_i</script>未选，<script type="math/tex">b_i</script>被选的情况同理。</li></ol><p><script type="math/tex">3</script>种情况取最优即可。</p><p>容易发现上述増广过程可以数据结构简单维护。</p><p>时间复杂度<script type="math/tex">O(Tn\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/5470.cpp">代码</a></p><h2><a id="NOI2019-弹跳" href="#NOI2019-弹跳" class="headerlink" title="NOI2019 弹跳"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5471">NOI2019 弹跳</a></h2><p><span class="label">NOI</span> <span class="label">K-D Tree</span> <span class="label">最短路</span></p><p>看起来是个单源最短路。由于边权非负，容易想到 Dijkstra 算法。</p><p>但是直接建图边数太多，如果使用二维线段树或者树套树优化建图会使得复杂度达到<script type="math/tex">O(m\log^2n)</script>的量级，而且还容易被卡空间。</p><p>因此我们考虑优化算法过程。基本的 Dijkstra 算法中我们维护一个小根堆，堆中存放形如<script type="math/tex">(u, d)</script>的二元组，表示到达<script type="math/tex">u</script>的最短距离是<script type="math/tex">d</script>。</p><p>由于本题中连出的边是一个矩形的范围，因此容易想到将二元组魔改成<script type="math/tex">(R, d)</script>，表示到达矩阵<script type="math/tex">R</script>中还未被访问（入堆）的点的最短距离是<script type="math/tex">d</script>。因为 Dijkstra 算法中每个点只会被访问一次，因此<script type="math/tex">R</script>中已经被访问过的点的最短路距离一定小于等于<script type="math/tex">d</script>，所以我们可以不考虑这些点。</p><p>因此问题转化为：如何寻找一个矩阵中未被访问过的点。这个可以树套树或者 K-D Tree。K-D Tree 空间更小。每次我们找到一个点后将其入堆，然后把它标记为已访问过。如果 K-D Tree 上某个结点代表的矩阵内的所有结点都被访问过了，就没必要遍历这个子树了。</p><p>K-D Tree 定位单个点的复杂度是<script type="math/tex">O(\log n)</script>的，而每个点最多被定位一次。因此总复杂度<script type="math/tex">O(n\log n + m\log n)</script>。</p><p><a target="_blank" rel="noopener" href="https://loj.ac/s/1130564">代码</a></p><h2><a id="NOI2019-斗主地" href="#NOI2019-斗主地" class="headerlink" title="NOI2019 斗主地"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5472">NOI2019 斗主地</a></h2><p><span class="label">插值</span> <span class="label">数学</span> <span class="label">猜结论</span></p><p>一句话：一次函数洗牌之后的期望还是一次函数，二次函数洗牌之后的期望还是二次函数。</p><p>这个结论并没有那么好猜。证明的话可以从一次函数的角度，写一个归纳法，发现可以拆成若干个范德蒙德恒等式的和。二次函数可以差分成一个一次函数来理解。</p><p>其实有另外一种更意识流的理解：洗牌本质上是把这个函数分成前后两段，然后均匀地混合在一起。所以一次函数混合后仍是一次函数，二次函数混合后仍是二次函数。</p><p>详细证明没啥营养。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/5472.cpp">代码</a></p><h2><a id="PKUSC2018-星际穿越" href="#PKUSC2018-星际穿越" class="headerlink" title="PKUSC2018 星际穿越"></a><a target="_blank" rel="noopener" href="https://loj.ac/p/6435">PKUSC2018 星际穿越</a></h2><p><span class="label">倍增</span></p><p>首先可以发现，固定<script type="math/tex">u</script>。从<script type="math/tex">u</script>走到<script type="math/tex">i</script>（<script type="math/tex">i &lt; u</script>） 的最短步数随<script type="math/tex">i</script>增大是逐渐减小（不上升）的。</p><p>因此我们可以设<script type="math/tex">f(u, i)</script>表示从<script type="math/tex">u</script>出发走<script type="math/tex">i</script>步走到的最靠左的点。</p><p>容易发现<script type="math/tex">f(u, 1) = l_u</script>。</p><p>可以发现<script type="math/tex">f(u, 2) = \min_{u \le v} l_v</script>。进而<script type="math/tex">f(u, 3) = \min_{f(u, 2) \le v} l_v</script>。</p><p>也就是说除了第一步比较特殊，之后的转移是类似的。因此我们对之后的部分做一个倍增即可。</p><p>设<script type="math/tex">f'(u, j)</script>表示从满足<script type="math/tex">u\le v</script>的<script type="math/tex">v</script>出发走<script type="math/tex">2^j</script>步到达的最左端的点。设<script type="math/tex">g(u, j)</script>表示从满足<script type="math/tex">u\le v</script>的<script type="math/tex">v</script>出发，走到<script type="math/tex">u - 1, u - 2, \ldots, f'(u, 2^j)</script>的最短步数的和。</p><p>转移是 trivial 的。</p><p>注意特殊处理第一步。也就是说在回答询问的时候我们是从<script type="math/tex">l_u</script>出发。然后再加上<script type="math/tex">u</script>到<script type="math/tex">l_u</script>的贡献。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/loj/6435.cpp">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年6月22日 第4次修订</li><li class="post-history-item">2021年5月29日 第3次修订</li><li class="post-history-item">2021年5月5日 第2次修订</li><li class="post-history-item">2021年5月2日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/DP/Optimal-BST-and-QI/">四边形不等式复习笔记</a></div><div class="prev-post"><a href="/Data-Structure/Link-Cut/">LCT 初步 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>