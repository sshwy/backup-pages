<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>BJOI 2018 大部分题解 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">BJOI 2018 大部分题解</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年2月11日星期四中午12点26分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年2月11日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 2,202 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Probset/">训练题单 </a><span class="icon smallarrow"></span> 当前文章</div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#链上二次求和"><span class="toc-number">1.</span> <span class="toc-text">链上二次求和</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#治疗之雨"><span class="toc-number">2.</span> <span class="toc-text">治疗之雨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#染色"><span class="toc-number">3.</span> <span class="toc-text">染色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二进制"><span class="toc-number">4.</span> <span class="toc-text">二进制</span></a></li></ol></div><hr></div><div class="post-content"><p>那道人类智慧题咕掉了……</p><p>求和太简单了，就 8 写了</p><h2><a id="链上二次求和" href="#链上二次求和" class="headerlink" title="链上二次求和"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/2512">链上二次求和</a></h2><blockquote><p>给出一个长度为<script type="math/tex">n</script>的整数序列<script type="math/tex">a</script>，有<script type="math/tex">m</script>次操作，要求支持区间加，询问</p><script type="math/tex;mode=display">f(l,r)=\sum_{i=1}^n\sum_{j=i}^n[l\le j-i+1\le r]\sum_{k=i}^j a_k \pmod{10^9+7}</script><p><script type="math/tex">n\le 2\times 10^5,m\le 5\times 10^5</script>。</p></blockquote><p><span class="label">线段树</span></p><p>首先有一个小差分。</p><p>如果这个序列是一个环，那么答案就很好求。断成链之后，有些区间就不能统计到。对于长度为<script type="math/tex">x</script>的区间，那么<script type="math/tex">a_{n-x+1}</script>会少统计<script type="math/tex">1</script>次，<script type="math/tex">a_{n-x+1}</script>少统计<script type="math/tex">2</script>次……，<script type="math/tex">a_n</script>少统计<script type="math/tex">x-1</script>次。同理，<script type="math/tex">a_1</script>少统计<script type="math/tex">x-1</script>次，<script type="math/tex">a_2</script>少统计<script type="math/tex">x-2</script>次，以此类推。</p><p>那么对于长度小于等于<script type="math/tex">x</script>的区间，则系数就是<script type="math/tex">A=\{1,3,6,10，\cdots\}</script>，也就是<script type="math/tex">B=\{1,2,3,\cdots\}</script>的前缀和。只要能快速维护带系数的区间和即可。那么使用线段树维护，也就转化为，快速求出这两个序列的区间和。其中<script type="math/tex">1,2,3,\cdots</script>的很好求，而<script type="math/tex">1,3,6,\cdots</script>可以求出前缀和公式<script type="math/tex">S(i)=\frac{i(i+1)(i+2)}{6}</script>，当然也可以预处理。</p><p>然后还需要把<script type="math/tex">\sum_{L\le i\le R} A_ia_i</script>给转化为<script type="math/tex">\sum_{L\le i\le R}A_{i-L+}a_i</script>，那么这个可以用<script type="math/tex">\sum_{L\le i\le R}B_ia_i</script>和<script type="math/tex">\sum_{L\le i\le R}a_i</script>来辅助计算。处理一下细节即可。</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://loj.ac/submission/792591">代码</a></p><h2><a id="治疗之雨" href="#治疗之雨" class="headerlink" title="治疗之雨"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/2513">治疗之雨</a></h2><blockquote><p>给你<script type="math/tex">m+1</script>个数，第一个数值为<script type="math/tex">p</script>，有上界<script type="math/tex">n</script>和下界<script type="math/tex">0</script>，其他<script type="math/tex">m</script>个数值为<script type="math/tex">\infty</script>，没有上界也没有下界。</p><p>你每次会进行如下操作：</p><ol><li>等概率随机选择一个没有达到上界的数并把它<script type="math/tex">+1</script>。如果没有就不操作。</li><li>进行<script type="math/tex">k</script>次：等概率随机选择一个没有达到下界的数并把它<script type="math/tex">-1</script>，如果没有就不操作。</li></ol><p>问期望进行多少次操作后第一个数会达到下界。如果第一个数无法达到下界输出<script type="math/tex">-1</script>。</p><p><script type="math/tex">1\le p\le n\le 1500,0\le m,k\le 10^9</script>。</p></blockquote><p><span class="label">高斯消元</span> <span class="label">期望</span> <span class="label">卡常</span> <span class="label">海森堡矩阵</span></p><p>设<script type="math/tex">f_p</script>表示第一个数值为<script type="math/tex">p</script>时的期望。在一个回合，它有概率<script type="math/tex">+1</script>，也有概率<script type="math/tex">-j</script>。设<script type="math/tex">p_j</script>表示一回合减<script type="math/tex">j</script>的概率，易得</p><script type="math/tex;mode=display">p_j=\frac{\binom{k}{j}m^{k-j}}{(m+1)^k}</script><p>（若<script type="math/tex">j&gt;k</script>则<script type="math/tex">p_j=0</script>）</p><p>另一方面，设<script type="math/tex">g_j</script>表示第一个数值为<script type="math/tex">j</script>时，一回合就达到下界的概率。容易发现</p><script type="math/tex;mode=display">g_j=\sum_{x\ge j}p_x=\sum_{x=j}^k p_x</script><p>那么现在就可以容易地得到<script type="math/tex">f</script>的关系式：</p><script type="math/tex;mode=display">f_i=\frac{m}{m+1}\left( g_i+\sum_{j=0}^{i-1}p_j(f_{i-j}+1) \right) + \frac{1}{m+1} \left( g_{i+1}+\sum_{j=0}^ip_j(f_{i+1-j}+1) \right) \quad(i&lt;n)</script><p>特殊地，<script type="math/tex">f_n=g_n+\sum_{j=0}^{n-1}p_j(f_{n-j}+1)</script>。</p><p>不妨把<script type="math/tex">g</script>去掉，得到</p><script type="math/tex;mode=display">f_i=\frac{m}{m+1}\left( 1+\sum_{j=0}^{i-1}p_jf_{i-j} \right) + \frac{1}{m+1} \left( 1+\sum_{j=0}^ip_jf_{i+1-j} \right) \quad(i&lt;n)</script><p>特殊地，<script type="math/tex">f_n=1+\sum_{j=0}^{n-1}p_jf_{n-j}</script>。</p><p>这时容易想到高斯消元。而<script type="math/tex">f</script>是一个海森堡矩阵，可以使用一些技巧做到<script type="math/tex">O(n^2)</script>。</p><p>注意要特判<script type="math/tex">m=0</script>的情况。</p><p><a target="_blank" rel="noopener" href="https://loj.ac/submission/793150">代码</a></p><h2><a id="染色" href="#染色" class="headerlink" title="染色"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/2493">染色</a></h2><blockquote><p>给一个无重边自环的无向图， 每个点分别给了一个大小为<script type="math/tex">2</script>的颜色集合，你只能从这个集合中选一种颜色给这个点染色。要求没有两个相邻的点被染了相同的颜色。</p><p>求是否无论给定的颜色集合是什么，均有办法按照要求染色。Yes or no。</p><p><script type="math/tex">1\le n\le 10^5.0\le m\le 2\times 10^5</script>。</p></blockquote><p><span class="label">构造</span> <span class="label">图论</span> <span class="label">盲猜</span></p><p>如果不是二分图那么显然是 NO。</p><p>考虑给你一个环<script type="math/tex">a\to b\to c\to d \to a</script>，那么你可以构造<script type="math/tex">a:\{A,B\},b:\{B,C\},c:\{C,A\},d:\{A,B\}</script>来钦定<script type="math/tex">a</script>必须选颜色<script type="math/tex">A</script>。因为如果<script type="math/tex">a</script>选<script type="math/tex">B</script>的话会和<script type="math/tex">d</script>冲突。长度更大的环同理。</p><p>既然我们能钦定一个点的颜色，那么只要存在一个环与<script type="math/tex">a\to b\to c\to d\to a</script>的环共边数小于等于<script type="math/tex">1</script>，就意味着我们可以构造出 NO 的情况了。这里要注意，如果有一条共边，仍然是可以构造出 NO 的。</p><p>因此总结一下，判定方式如下：</p><ol><li>如果不是二分图，则 NO；</li><li>删掉所有的 1 度点（拓扑）后，如果存在某个点不在任何一个简单环上，则 NO；</li><li>如果存在某个点度数大于<script type="math/tex">3</script>，则 NO；</li><li>如果存在两个相邻的<script type="math/tex">3</script>度点，则 NO；</li><li>如果都没有，那么就是 YES。</li></ol><p>由于使用了一些 STL 数据结构，因此我实现的时间复杂度是<script type="math/tex">O(n\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://loj.ac/submission/793303">代码</a></p><h2><a id="二进制" href="#二进制" class="headerlink" title="二进制"></a><a target="_blank" rel="noopener" href="https://loj.ac/problem/2492">二进制</a></h2><blockquote><p>若一个 01 串能在任意重排后变成一个 3 的倍数的数的二进制表示（可含前导 0），称这是好的。比如 101,000,11 都是好串。</p><p>现在给你一个长度为<script type="math/tex">n</script>的 01 串<script type="math/tex">s</script>，要求支持<script type="math/tex">m</script>次操作：</p><ul><li>单点修改</li><li>询问满足<script type="math/tex">l\le x\le y\le r</script>的<script type="math/tex">s[x,y]</script>中有多少个好串。</li></ul></blockquote><p><span class="label">分类讨论</span></p><p>容易发现，满足以下任意一个条件的都是好串：</p><ol><li>有偶数个 1。</li><li>有奇数个 1，且有至少 3 个 1 和至少 2 个 0。</li></ol><p>这个不好算，我们考虑计算不是好串的串的个数，那么不是好串的串就是：</p><ol><li>有 1 个 1，有任意个 0；</li><li>有奇数个 1，没有 0；</li><li>有奇数个 1，1 个 0。</li></ol><p>上述三者有一部分算重了，因此要减去</p><ol><li>只有 1 个 1，没有 0；</li><li>只有 1 个 1，1 个 0。</li></ol><p>的个数。</p><p>这 5 个都可以简单地使用数据结构维护。</p><p>使用 set+ 树状数组实现，时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://loj.ac/submission/793945">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年2月11日 第2次修订</li><li class="post-history-item">2020年4月24日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Probset/May-Day-Prob/">五一集训 杂题练习</a></div><div class="prev-post"><a href="/Probset/21-WC-Training-2/">WC 赛前训练日志 3 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>