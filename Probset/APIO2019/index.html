<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>APIO 2019 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">APIO 2019</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2020年1月14日星期二晚上8点16分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2020年1月14日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 1,384 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Probset/">训练题单 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Complete-Solution/">Complete-Solution</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#路灯"><span class="toc-number">1.</span> <span class="toc-text">路灯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#奇怪装置"><span class="toc-number">2.</span> <span class="toc-text">奇怪装置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#桥梁"><span class="toc-number">3.</span> <span class="toc-text">桥梁</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="路灯" href="#路灯" class="headerlink" title="路灯"></a>路灯</h2><blockquote><p>一条长度为 n 的 n+1 个点的链。在时刻 0 时给你每条边的出现 / 不出现的状态。接下来的 q 个时刻会</p><ol><li>切换某条边的状态</li><li>询问到目前为止，(a,b) 连通的时间的总和。</li></ol><p><script type="math/tex">n,q\le 3\times 10^5</script>。</p></blockquote><p><strong>摘要：区间问题转化为二维数点。</strong></p><p>对于每个点对 (a,b)，先转化为边对。设<script type="math/tex">b'=b-1</script>（允许<script type="math/tex">a=b'</script>）。我们记录它到结束时的时间总和，设为<script type="math/tex">T(a,b')</script>。</p><p>那么对于时刻<script type="math/tex">i</script>的一次修改操作，假设修改的边是<script type="math/tex">x</script>，相当于<script type="math/tex">x</script>左右两边的点的连通性发生了变化。设与<script type="math/tex">x</script>连通的极大区间是<script type="math/tex">[L,R]</script>，那么相当于是<script type="math/tex">a\in[L,x],b\in[x,R]</script>的<script type="math/tex">T(a,b)</script>都被加上一个<script type="math/tex">q-i</script>（如果这条边出现）或者减掉<script type="math/tex">q-i</script>（如果这条边消失）。</p><p>对于一次查询操作，如果<script type="math/tex">a,b+1</script>当前是不连通的，那么答案就是<script type="math/tex">T(a,b)</script>。否则答案是<script type="math/tex">T(a,b)-(q-i)</script>。你要把预支的部分减掉。</p><p>上述过程实际上就是矩阵加，单点求值。把矩阵加写成 4 个前缀矩阵的形式。可以二维数点。</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/5445.cpp">代码</a></p><h2><a id="奇怪装置" href="#奇怪装置" class="headerlink" title="奇怪装置"></a>奇怪装置</h2><blockquote><p>给出<script type="math/tex">A,B</script>。定义映射<script type="math/tex">f:x\in N\to(x+\left\lfloor\frac{x}{B}\right\rfloor\bmod A,x\bmod B)</script>。给出<script type="math/tex">n</script>个区间<script type="math/tex">[l_i,r_i]</script>，求<script type="math/tex">|\{f(x)|x\in[l_i,r_i]\}|</script>（即有多少个互不相同的元素）。</p><p><script type="math/tex">n\le 10^6,A,B,l_i,r_i\le 10^{18}</script>。</p></blockquote><p><strong>摘要：解同余方程。</strong></p><p>解一个方程<script type="math/tex">f(x)=f(x+T)</script>，得<script type="math/tex">T=\frac{AB}{\gcd(A,B+1)}</script>。因此映射是有周期性的。</p><p>如果存在<script type="math/tex">l_i+T\le r_i</script>，那么答案就是<script type="math/tex">T</script>。否则可以把区间都放到<script type="math/tex">[0,T-1]</script>的范围，求区间并即可。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/5444.cpp">代码</a></p><h2><a id="桥梁" href="#桥梁" class="headerlink" title="桥梁"></a>桥梁</h2><blockquote><p>给一个 n 个点 m 条边的加权无向图，以及每条边的初始权值<script type="math/tex">(u_i,v_i,w_i)</script>. 有 q 个操作：</p><ol><li>把第<script type="math/tex">x</script>条边的边权改为<script type="math/tex">y</script>。</li><li>问从编号为<script type="math/tex">x</script>的点出发，经过边权大于等于<script type="math/tex">y</script>的边能到达的点的个数。</li></ol><p><script type="math/tex">n\le 5\times 10^4,m\le 10^5,q\le 10^5,w_i\le 10^9</script>.</p></blockquote><p><strong>摘要：分块，离线，按权值从大到小排序，可撤消并查集，卡常。</strong></p><p>这种数据范围的题，想不到 log 的做法，就考虑分块。将操作序列分块，每<script type="math/tex">T</script>个为一块。用并查集回答询问。</p><p>对于一个操作序列规模为<script type="math/tex">T</script>的问题，我们考虑离线处理。我们将<script type="math/tex">m</script>条边和操作序列分别按权值从大到小排序。按权值从大到小考虑每个操作。在操作之前我们先考虑权值大于等于当前权值的边。如果当前这条边在这<script type="math/tex">T</script>个操作中始终没有被修改，我们就直接把它加到并查集里。否则我们暂时忽略这条边。然后考虑当前这个操作，如果是修改操作我们也忽略，如果是询问操作，我们就想办法在<script type="math/tex">O(T)</script>的时间内回答询问。</p><p>回答询问：把操作序列里那些有用的（时间最晚）的修改操作找出来，如果权值比询问大就加到并查集里。然后就可以回答询问了。回答完了撤消这部分的修改即可。时间复杂度<script type="math/tex">O(T)</script>。注意这里并查集的复杂度是均摊<script type="math/tex">O(\log_2n)</script>的（吧）</p><p>这样的话，复杂度为<script type="math/tex">O(T^2+m\log_2m+T\log_2T)=O(T^2+m\log_2m)</script>。</p><p>总的复杂度是<script type="math/tex">O(\frac{q}{T}(T^2+m\log_2m))=O(qT+\frac{q}{T}m\log_2m)</script>。由于<script type="math/tex">n,m</script>同阶，于是当<script type="math/tex">T=\sqrt{m\log_2m}</script>时取得最优复杂度<script type="math/tex">O(q\sqrt{m\log_2m})</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/5443.cpp">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2020年1月14日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/IOI2020hw/AGC-part-5/">IOI2020 国家集训队作业小结 5</a></div><div class="prev-post"><a href="/Math/Arturia-Course-1/">Arturia&#39;s Math Lesson Day 1 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>