<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>计数题小结 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">计数题小结</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2019年9月24日星期二早上7点25分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2019年9月24日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 1,741 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#A"><span class="toc-number">1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B"><span class="toc-number">2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C"><span class="toc-number">3.</span> <span class="toc-text">C</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二项式反演"><span class="toc-number">4.</span> <span class="toc-text">二项式反演</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#几道计数题"><span class="toc-number">5.</span> <span class="toc-text">几道计数题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exercise-1"><span class="toc-number">5.1.</span> <span class="toc-text">Exercise 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exercise-2"><span class="toc-number">5.2.</span> <span class="toc-text">Exercise 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exercise-3"><span class="toc-number">5.3.</span> <span class="toc-text">Exercise 3</span></a></li></ol></li></ol></div><hr></div><div class="post-content"><h2><a id="A" href="#A" class="headerlink" title="A"></a>A</h2><blockquote><p>一个<script type="math/tex">n\times m</script>的网格，每步只能向下或者向右走。有 k 个被 ban 掉的点，不能经过。问左上走到右下的方案数。<script type="math/tex">n,m\le 10^6,k\le 10^3</script>。</p></blockquote><p>考虑容斥。设<script type="math/tex">f_i</script>表示经过第<script type="math/tex">i</script>个 banned 点，在这之前不走 banned 点，之后随便走的方案数。</p><p>求<script type="math/tex">f_i</script>也可以对前半部分使用容斥，即第一次走到第<script type="math/tex">k</script>个 banned 点，在这之前不走 banned 点，然后随便走，走到第<script type="math/tex">i</script>个 banned 点，然后随便走的方案数。这样用经过<script type="math/tex">i</script>的总方案数减就能求<script type="math/tex">f_i</script>。</p><p>总复杂度<script type="math/tex">O(k^2)</script>。</p><h2><a id="B" href="#B" class="headerlink" title="B"></a>B</h2><p>BZOJ 2287</p><blockquote><p>有<script type="math/tex">n</script>个体积为<script type="math/tex">w_i</script>的物品，对于每一个<script type="math/tex">x</script>，求出没有第<script type="math/tex">x</script>个物品的情况下剩下<script type="math/tex">n-1</script>个物品填满容积为<script type="math/tex">x</script>的背包的方案数。</p></blockquote><p>整体的生成函数是</p><script type="math/tex;mode=display">\prod_{i=1}^n(1+x^{w_i})</script><p>那么我们要求的就是</p><script type="math/tex;mode=display">\frac{\prod_{i=1}^n(1+x^{w_i})}{(1+x^{w_k})}</script><p>可以直接大除法，从低位往高位除。</p><p>从它的组合意义去理解的话，设<script type="math/tex">f</script>表示所有物品的方案数背包，而<script type="math/tex">g</script>表示缺失第<script type="math/tex">k</script>个物品的方案数背包。则显然有<script type="math/tex">f_i=g_i+g_{i-w_k}</script>。现在我们知道<script type="math/tex">f</script>，要求<script type="math/tex">g</script>，于是直接<script type="math/tex">g_i=f_i-g_{i-a_k}</script>即可。</p><p>大除法也可以看成是从小到大的 DP 转移。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/bzoj/2287.cpp">代码</a></p><h2><a id="C" href="#C" class="headerlink" title="C"></a>C</h2><p>SRM 684 Medium</p><p>一个长度为 n 的序列，满足每个元素都是 [1,k] 内的整数, 且对于相邻的两个元素<script type="math/tex">a=S_i ,b=S_{i+1}</script>, 有<script type="math/tex">a\le b</script>或<script type="math/tex">a \bmod b \ne 0</script>。求这样的序列的个数模<script type="math/tex">10^9+7</script>。<script type="math/tex">n,k\le 50000</script>。</p><p>考虑容斥，转化为无限制减去<script type="math/tex">a&gt;b,b|a</script>。这可以 DP，<script type="math/tex">f_i</script>表示长度为<script type="math/tex">i</script>的序列的方案数，则转移的时候枚举<script type="math/tex">[j+1,i]</script>这一段是整除序列，然后<script type="math/tex">j,j+1</script>是无限制关系。由于<script type="math/tex">[j+1,i]</script>的长度是<script type="math/tex">O(\log_2k)</script>的，因此预处理一下，直接转移就行了。</p><h2><a id="二项式反演" href="#二项式反演" class="headerlink" title="二项式反演"></a>二项式反演</h2><script type="math/tex;mode=display">f_n=\sum\binom{n}{x}g_x\\
\Leftrightarrow g_n=\sum\binom{n}{x}(-1)^xf_x</script><h2><a id="几道计数题" href="#几道计数题" class="headerlink" title="几道计数题"></a>几道计数题</h2><h3><a id="Exercise-1" href="#Exercise-1" class="headerlink" title="Exercise 1"></a>Exercise 1</h3><blockquote><p>给一棵有根树<script type="math/tex">T=(V,E)</script>，求拓扑序方案数。</p></blockquote><p>设<script type="math/tex">f(u)</script>表示<script type="math/tex">T_u</script>的拓扑序方案数。那么我们可以发现，它的儿子<strong>之间</strong>的顺序是无所谓的。于是这就是一个多重集的排列问题。<script type="math/tex">|T_u|</script>表示子树 u 的大小。于是</p><script type="math/tex;mode=display">f(u)=\frac{(|T_u|-1)!}{\prod_{(u\to v)\in E}|T_v|!}\prod_{(u\to v)\in E}f(v)\\
Ans=n!\prod_{u=1}^n\frac{1}{|T_u|}</script><p>算概率去理解。</p><p>注：<script type="math/tex">|T_u|-1</script>相当于 u 的儿子子树大小之和。</p><h3><a id="Exercise-2" href="#Exercise-2" class="headerlink" title="Exercise 2"></a>Exercise 2</h3><blockquote><p>带标号无向连通图计数。</p></blockquote><p>设带标号的无向图个数为<script type="math/tex">h</script>，无向不连通图个数为<script type="math/tex">g</script>，无向连通图个数为<script type="math/tex">f</script>。</p><script type="math/tex;mode=display">h(n)=2^{\frac{n(n+1)}{2}}\\
f(n)=h(n)-g(n)</script><p>现在考虑求<script type="math/tex">g(n)</script>。枚举 1 所在的连通块即可。枚举连通块大小，点的标号，剩下的点的连法可得</p><script type="math/tex;mode=display">g(n)=\sum_{i=1}^{n-1}\binom{n-1}{i-1}f(i)h(n-i)</script><p>如果你把 f 代换成 g 就发现，其实这只是一个关于 g 的递归式。所以为了减小常数可以只算 g 和 h，最后就能得到 f</p><h3><a id="Exercise-3" href="#Exercise-3" class="headerlink" title="Exercise 3"></a>Exercise 3</h3><blockquote><p>一个串并联网络具有如下特征：</p><ol><li>有一个起点和终点，至少一条边</li><li>把两个网络的起点终点首位相接得到是仍是串并联网络</li><li>把两个网络的起点终点并起来得到的仍是串并联网络</li><li>并联时不考虑并联线路之间的顺序（即他们都是相同的）</li></ol><p>现在给定边的数量，问串并联网络的个数。</p></blockquote><p>这是一道小清新的题。事实上你发现，一个串并联网络具有树形结构。一个串联的整体下有若干个并联的线路，一个并联的整体下有若干个串联的线路。因此这就是一个树的结构，且奇偶层分别为串联和并联的结点。于是你根本不用管串联并联的问题，直接对树计数然后答案乘 2 即可。</p><p>一个串联或者并联结构至少有两条线路。因此我们要求的是每个<strong>内部结点的儿子数大于 1</strong>的树的个数。设<script type="math/tex">f(n)</script>表示叶子结点总数为 n 的树的个数。</p><p>由于你不考虑兄弟结点间的顺序，因此就要有一个单调性的限制。于是再定义<script type="math/tex">g(i,j)</script>表示叶结点数为 i，根结点的每颗子树最多包含 j 个叶子的树的方案数。显然，可以枚举包含 j 个叶子的子树数量求 g。假设有 k 个子树包含 j 个叶子，于是就相当于在<script type="math/tex">f(j)</script>个方案中选 k 个，可重复。这就是一个不定方程非负整数解的问题，答案为<script type="math/tex">\dbinom{f(j)+k-1}{f(j)-1}=\dbinom{f(j)+k-1}{k}</script>：</p><script type="math/tex;mode=display">g(i,j)=\sum_{k=0}^{\left\lfloor\frac{i}{j}\right\rfloor}g(i-kj,j-1)\binom{f(j)+k-1}{k}\\</script><p>因为儿子数大于 1，因此</p><script type="math/tex;mode=display">f(i)=g(i,i-1)</script></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2019年9月24日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Data-Structure/Dsu/">并查集的应用</a></div><div class="prev-post"><a href="/Data-Structure/Circle-Square/">圆方树简介 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>