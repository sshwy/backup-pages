<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>Arturia&#39;s Math Lesson Day 1 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">Arturia&#39;s Math Lesson Day 1</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2020年1月15日星期三晚上10点53分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2020年1月15日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 6,732 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/English/">English</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-1-The-Unique-Factorization-Theorem"><span class="toc-number">1.</span> <span class="toc-text">Ex 1 (The Unique Factorization Theorem)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-2-Diophantine-Equation"><span class="toc-number">2.</span> <span class="toc-text">Ex 2 (Diophantine Equation)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-3-Module"><span class="toc-number">3.</span> <span class="toc-text">Ex 3 (Module)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-using-Direct-Calculation"><span class="toc-number">3.1.</span> <span class="toc-text">Solve using Direct Calculation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-using-Combination-Meanings"><span class="toc-number">3.2.</span> <span class="toc-text">Solve using Combination Meanings</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-4-Quadratic-Equation"><span class="toc-number">4.</span> <span class="toc-text">Ex 4 (Quadratic Equation)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pell’s-Equation-I"><span class="toc-number">4.1.</span> <span class="toc-text">Pell’s Equation I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pell’s-Equation-II"><span class="toc-number">4.2.</span> <span class="toc-text">Pell’s Equation II</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-5-Legendre-Theorem"><span class="toc-number">5.</span> <span class="toc-text">Ex 5 (Legendre Theorem)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-6-Lucas-Theorem"><span class="toc-number">6.</span> <span class="toc-text">Ex 6 (Lucas Theorem)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-7-Mobius-Function"><span class="toc-number">7.</span> <span class="toc-text">Ex 7 (Mobius Function)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-8-Prefix-Sum-Compute"><span class="toc-number">8.</span> <span class="toc-text">Ex 8 (Prefix Sum Compute)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-9-Quadratic-Residue"><span class="toc-number">9.</span> <span class="toc-text">Ex 9 (Quadratic Residue)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Legendre-symbol"><span class="toc-number">9.1.</span> <span class="toc-text">Legendre symbol</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Quadratic-Reciprocal-Law"><span class="toc-number">9.2.</span> <span class="toc-text">Quadratic Reciprocal Law</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ex-10-Exponential-Congruence-Equation"><span class="toc-number">10.</span> <span class="toc-text">Ex 10 (Exponential Congruence Equation)</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="Ex-1-The-Unique-Factorization-Theorem" href="#Ex-1-The-Unique-Factorization-Theorem" class="headerlink" title="Ex 1 (The Unique Factorization Theorem)"></a>Ex 1 (The Unique Factorization Theorem)</h2><blockquote><p>Prove that<script type="math/tex">a\times b=(a,b)\times [a,b]</script>,<script type="math/tex">a,b\in \mathbf{N}</script>. (P5)</p></blockquote><p>First, to be obvious, for all<script type="math/tex">a,b\in N</script>, we have<script type="math/tex">a+b=\min(a,b)+\max(a,b)</script>.</p><p>Let<script type="math/tex">f(x,p)</script>denotes the largest<script type="math/tex">c\in \mathbf{N}</script>that<script type="math/tex">p^c|x</script>. According to <strong>the unique factorization theorem</strong>, we have</p><script type="math/tex;mode=display">x=\prod_{p\text{ is prime}}p^{f(x,p)}</script><p>Let’s consider a prime factor<script type="math/tex">p</script>of<script type="math/tex">ab</script>.</p><p>To be exactly,<script type="math/tex">f(ab,p)=f(a,p)+f(b,p)</script>.</p><p>Let<script type="math/tex">d=(a,b)</script>, so we have<script type="math/tex">p^{\min(f(a,p),f(b,p))}|d,p^{\min(f(a,p),f(b,p))+1}\nmid d</script>, because<script type="math/tex">a</script>and<script type="math/tex">b</script>should both be divisible by<script type="math/tex">d</script>. Also we want to maximize<script type="math/tex">d</script>, so we try to maximize the power of<script type="math/tex">p</script>in<script type="math/tex">d</script>. That is equal to<script type="math/tex">f(d,p)=\min(f(a,p),f(b,p))</script>.</p><p>Similarly, Let<script type="math/tex">m=[a,b]</script>, so we have<script type="math/tex">f(m,p)=\max(f(a,p),f(b,p))</script>.</p><p>So when we multiply<script type="math/tex">d</script>and<script type="math/tex">m</script>, we will get</p><script type="math/tex;mode=display">\begin{aligned}
f(dm,p)
&=f(d,p)+f(m,p)\\
&=\min(f(a,p),f(b,p))+\max(f(a,p),f(b,p))\\
&=f(a,p)+f(b,p)\\
&=f(ab,p)
\end{aligned}</script><p>Finally<script type="math/tex">ab=\prod_{p\text{ is prime}}p^{f(ab,p)}=\prod_{p\text{ is prime}}p^{f(dm,p)}=dm</script>.</p><p>Q. E. D.</p><h2><a id="Ex-2-Diophantine-Equation" href="#Ex-2-Diophantine-Equation" class="headerlink" title="Ex 2 (Diophantine Equation)"></a>Ex 2 (Diophantine Equation)</h2><blockquote><p>Given that<script type="math/tex">a,b,c,x,y,z\in \mathbf{Z}^+,(a,b)=(b,c)=(a,c)=1, a,b,c&gt;0</script>, find the largest<script type="math/tex">n(n\in \mathbf{N})</script>that makes<script type="math/tex">abx+bcy+acz=n</script>unsolvable. (P6)</p></blockquote><p>Answer:<script type="math/tex">2abc-ab-bc-ac</script>.</p><h2><a id="Ex-3-Module" href="#Ex-3-Module" class="headerlink" title="Ex 3 (Module)"></a>Ex 3 (Module)</h2><blockquote><p>Euler Function: Prove that</p><script type="math/tex;mode=display">\sum_{d|m}\varphi(d)=m</script><p>through direct calculation or combination meanings. (P13)</p></blockquote><h3><a id="Solve-using-Direct-Calculation" href="#Solve-using-Direct-Calculation" class="headerlink" title="Solve using Direct Calculation"></a>Solve using Direct Calculation</h3><p>Let<script type="math/tex">M(S)=\prod_{x\in S}x</script>.</p><p>Use <strong>the unique factorization theorem</strong>, Let<script type="math/tex">m={p_1}^{a_1}{p_2}^{a_2}\cdots{p_n}^{a_n}</script>. We further define<script type="math/tex">P(m)=\{p_1,\cdots,p_n\}</script>.Use <strong>inclusion-exclusion principle</strong> we get</p><script type="math/tex;mode=display">\begin{aligned}
\varphi(m)&=m\left(1-\frac{1}{p_1}\right)\left(1-\frac{1}{p_2}\right)\cdots\left(1-\frac{1}{p_n}\right)\\
&=\sum_{S\subseteq P(m)}(-1)^{|S|}\frac{m}{M(S)}
\end{aligned}</script><p>As<script type="math/tex">\frac{m}{M(S)}</script>is factor of<script type="math/tex">m</script>, let’s change the way we calculate<script type="math/tex">\sum_{d|m}\varphi(d)</script>to calculate the coefficient of factors of<script type="math/tex">m</script>.</p><p>Let<script type="math/tex">d</script>be one of factors of<script type="math/tex">m</script>. Then the coefficient of it will be</p><script type="math/tex;mode=display">\sum_{S\subseteq P(\frac{m}{d})}(-1)^{|S|}=\left[P\left(\frac{m}{d}\right)=\varnothing\right]</script><p>So we have</p><script type="math/tex;mode=display">\sum_{d|m}\varphi(d)=\sum_{d|m}\left[P\left(\frac{m}{d}\right)=\varnothing\right]d</script><p>Since only when<script type="math/tex">d=m</script>satisfies<script type="math/tex">[P(\frac{m}{d})=\varnothing]=1</script>, otherwise it will be<script type="math/tex">0</script>. Thus we get<script type="math/tex">\sum_{d|m}\varphi(d)=m</script>.</p><p>Q. E. D.</p><h3><a id="Solve-using-Combination-Meanings" href="#Solve-using-Combination-Meanings" class="headerlink" title="Solve using Combination Meanings"></a>Solve using Combination Meanings</h3><p>Let<script type="math/tex">d</script>be one of factors of<script type="math/tex">m</script>, consider the number of<script type="math/tex">x</script>that<script type="math/tex">(x,m)=d</script>. This is equal to the number of<script type="math/tex">x</script>that<script type="math/tex">d|x</script>and<script type="math/tex">(\frac{x}{d},\frac{m}{d})=1</script>. Replace the<script type="math/tex">\frac{x}{d}</script>by<script type="math/tex">x'</script>, we get<script type="math/tex">(x',\frac{m}{d})=1</script>. That just means the number of<script type="math/tex">x</script>that<script type="math/tex">x</script>and<script type="math/tex">\frac{m}{d}</script>is coprime, aka<script type="math/tex">\varphi(\frac{m}{d})</script>.</p><p>On the other hand,<script type="math/tex">\sum_{d|m}[(x,m)=d]=1</script>, thus we have</p><script type="math/tex;mode=display">m=\sum_{i=1}^m\sum_{d|m}[(i,m)=d]=\sum_{d|m}\varphi\left(\frac{m}{d}\right)=\sum_{d|m}\varphi(d)</script><p>Q. E. D.</p><h2><a id="Ex-4-Quadratic-Equation" href="#Ex-4-Quadratic-Equation" class="headerlink" title="Ex 4 (Quadratic Equation)"></a>Ex 4 (Quadratic Equation)</h2><blockquote><p>(2017ICPC) Given<script type="math/tex">T&lt;10^{16}</script>, solve positive integer solution for</p><script type="math/tex;mode=display">n(n+1)=2m(m+1)</script><p>with<script type="math/tex">n&gt;T</script>. (P21)</p></blockquote><p>To solve this problem we first learn the concept of Pell’s Equation.</p><h3><a id="Pell’s-Equation-I" href="#Pell’s-Equation-I" class="headerlink" title="Pell’s Equation I"></a>Pell’s Equation I</h3><p>We define<script type="math/tex">x^2-Dy^2=1</script>as the Pell<script type="math/tex">I</script>equation.<script type="math/tex">D</script>is a positive integer.</p><p>Theorem: The solution of Pell<script type="math/tex">I</script>equation exists. If the smallest solution is<script type="math/tex">(x_0,y_0)</script>, then the equation can be expressed as</p><script type="math/tex;mode=display">x_n+\sqrt{D}y_n=(x_0+\sqrt{D}y_0)^n</script><p>So we can use recurrence to solve it.</p><h3><a id="Pell’s-Equation-II" href="#Pell’s-Equation-II" class="headerlink" title="Pell’s Equation II"></a>Pell’s Equation II</h3><p>Similarly, we define<script type="math/tex">x^2-Dy^2=-1</script>as the Pell<script type="math/tex">II</script>equation.<script type="math/tex">D</script>is also a positive integer.</p><p>Theorem: The solution of Pell<script type="math/tex">II</script>equation exists. If the smallest solution is<script type="math/tex">(x_0,y_0)</script>, then the equation can be expressed as</p><script type="math/tex;mode=display">x_n+\sqrt{D}y_n=(x_0+\sqrt{D}y_0)^{2n+1}</script><p>Now let’s go back to the original problem.</p><p>Do some modification we can get</p><script type="math/tex;mode=display">(2n+1)^2-2(2m+1)^2=-1</script><p>That is just a Pell<script type="math/tex">II</script>equation. So we can simply use binary search and algorithm similar to quick power to solve it.</p><p>Time complexity is<script type="math/tex">O(\log_2^2T)</script>.</p><h2><a id="Ex-5-Legendre-Theorem" href="#Ex-5-Legendre-Theorem" class="headerlink" title="Ex 5 (Legendre Theorem)"></a>Ex 5 (Legendre Theorem)</h2><blockquote><p>Count the number of zeros at the end of<script type="math/tex">n!</script>. (P24)</p></blockquote><p>Let<script type="math/tex">f(n,p)=\sum_{i\ge 1}\lfloor\frac{n}{p^i}\rfloor</script>denotes the power of<script type="math/tex">p</script>in<script type="math/tex">n</script>. The answer is<script type="math/tex">\min(f(n,2),f(n,5))</script>exactly.</p><blockquote><p>Design an algorithm calculate the last nonzero digit of<script type="math/tex">n!</script>. (P24)</p></blockquote><p>Let’s define<script type="math/tex">F(n)</script>denotes the last nonzero digit of<script type="math/tex">n!</script>. Consider recursion.</p><p>First we compute<script type="math/tex">1\times 2\times 3\times 4\bmod 10=4</script>and<script type="math/tex">6\times 7\times 8\times 9\bmod 10=4</script>. Thus we can divide the number into multiple of 5 or not.</p><p>Another observation is that<script type="math/tex">F(n)=F(n-n\bmod 10)F(n\bmod 10)</script>, it means we make the last a few numbers modulo to 10 so we get<script type="math/tex">F(n\bmod 10)</script>. Now we have</p><script type="math/tex;mode=display">F(n)=4^{2\lfloor\frac{n}{10}\rfloor}F(n\bmod 10)F\left(\left\lfloor\frac{n}{5}\right\rfloor\right)\frac{1+[(n\bmod 10)\ge 5]}{2^{\lfloor\frac{n}{5}\rfloor}}\\
=4^{\lfloor\frac{n}{10}\rfloor}F(n\bmod 10)F\left(\left\lfloor\frac{n}{5}\right\rfloor\right)</script><p>Notice that<script type="math/tex">F(x)=2F(x-5)</script>for<script type="math/tex">x\in[5,9]</script>, so we can make it.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">F0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span>
<span class="token keyword">def</span> <span class="token function">F</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> F0<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token keyword">if</span> x<span class="token operator">&lt;</span><span class="token number">10</span> <span class="token keyword">else</span> F0<span class="token punctuation">[</span>x<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>F<span class="token punctuation">(</span>x<span class="token operator">//</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">//</span><span class="token number">10</span><span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">else</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>F<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Time complexity is<script type="math/tex">O(\log_5n)</script>.</p><h2><a id="Ex-6-Lucas-Theorem" href="#Ex-6-Lucas-Theorem" class="headerlink" title="Ex 6 (Lucas Theorem)"></a>Ex 6 (Lucas Theorem)</h2><blockquote><p>Calculate<script type="math/tex">G^{\sum_{d|n}\binom{n}{d}}\bmod 999911659</script>. (P26)</p></blockquote><p>As we know the Euler Theorem we have</p><script type="math/tex;mode=display">G^{\sum_{d|n}\binom{n}{d}}\equiv G^{\sum_{d|n}\binom{n}{d}\bmod 999911658} \pmod {999911659}</script><p>Because<script type="math/tex">999911658=2\times 3\times 4679\times 35617</script>, so we can simply apply Lucas Theorem and the Chinese Remainder Theorem to compute the answer.</p><p>Let<script type="math/tex">p=35617,P=999911659</script>, so the time complexity is<script type="math/tex">O(p+\log_pn+\log_2P)</script>.</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/2480.cpp">Code</a></p><p>BZOJ2111: Too simple to solve it …</p><h2><a id="Ex-7-Mobius-Function" href="#Ex-7-Mobius-Function" class="headerlink" title="Ex 7 (Mobius Function)"></a>Ex 7 (Mobius Function)</h2><blockquote><p>Prove that<script type="math/tex">\sum_{d|n}\mu(d)=[n=1]</script>. (P29)</p></blockquote><p>When<script type="math/tex">n=1</script>, the equation is absolutely satisfied. Let’s say<script type="math/tex">n&gt;1</script>.</p><p>According to <strong>the unique factorization theorem</strong>, we have</p><script type="math/tex;mode=display">n={p_1}^{a_1}{p_2}^{a_2}\cdots{p_m}^{a_m}</script><p>So we have</p><script type="math/tex;mode=display">\begin{aligned}
\sum_{d|n}\mu(d)&=\sum_{S\subseteq\{p_1,p_2,\cdots,p_n\}}\mu\left(\prod_{x\in S}x\right)\\
&=\sum_{S\subseteq\{p_1,p_2,\cdots,p_n\}}(-1)^{|S|}\\
&=0
\end{aligned}</script><p>Q. E. D.</p><h2><a id="Ex-8-Prefix-Sum-Compute" href="#Ex-8-Prefix-Sum-Compute" class="headerlink" title="Ex 8 (Prefix Sum Compute)"></a>Ex 8 (Prefix Sum Compute)</h2><blockquote><p>Let<script type="math/tex">f(n)</script>denotes the sum of all the factors of<script type="math/tex">n</script>, design an algorithm to calculate<script type="math/tex">\sum_{i=1}^n f(i)</script>,<script type="math/tex">n\le 10^{12}</script>. (P29)</p></blockquote><p>We have</p><script type="math/tex;mode=display">\sum_{i=1}^nf(i)=\sum_{i=1}^n\sum_{j|i}j=\sum_{j=1}^nj\left\lfloor\frac{n}{j}\right\rfloor</script><p>By number theory partition, we can compute it in<script type="math/tex">O(\sqrt{n})</script>.</p><h2><a id="Ex-9-Quadratic-Residue" href="#Ex-9-Quadratic-Residue" class="headerlink" title="Ex 9 (Quadratic Residue)"></a>Ex 9 (Quadratic Residue)</h2><p>Before starting solving problems, we learn the concept of <strong>Legendre symbol</strong>.</p><h3><a id="Legendre-symbol" href="#Legendre-symbol" class="headerlink" title="Legendre symbol"></a>Legendre symbol</h3><p>Given<script type="math/tex">(m,n)=1</script>, if there exists<script type="math/tex">x</script>solves</p><script type="math/tex;mode=display">x^2=m\mod m</script><p>then we define<script type="math/tex">n</script>as a quadratic residue.</p><p>Given<script type="math/tex">p</script>as a odd prime,<script type="math/tex">n</script>isn’t divisible by<script type="math/tex">p</script>. Then</p><script type="math/tex;mode=display">\left( \frac{n}{p} \right)=\begin{cases}
1 & n\text{ is a quadratic residue}\\
-1 & \text{Otherwise}
\end{cases}</script><p>The<script type="math/tex">\left( \frac{n}{p} \right)</script>is what we called Legendre symbol.</p><p>There’s a theorem given by Euler to help compute Legendre symbol:</p><script type="math/tex;mode=display">n^{\frac{p-1}{2}}=\left( \frac{n}{p} \right) \mod p</script><p>Obviously, Legendre symbol is a <strong>multiplicative function</strong>.</p><h3><a id="Quadratic-Reciprocal-Law" href="#Quadratic-Reciprocal-Law" class="headerlink" title="Quadratic Reciprocal Law"></a>Quadratic Reciprocal Law</h3><p>It’s such a magic low:</p><script type="math/tex;mode=display">\left( \frac{p}{q} \right)\left( \frac{q}{p} \right)=(-1)^{\frac{(p-1)(q-1)}{4}}</script><p>Now let’s do some exercises.</p><blockquote><p>Find<script type="math/tex">p</script>such that<script type="math/tex">\left( \frac{3}{p}\right)=1</script>. (P36)</p></blockquote><p>According to <strong>quadratic reciprocal law</strong> we have</p><script type="math/tex;mode=display">\left( \frac{p}{3}\right)=(-1)^{\frac{p-1}{2}}</script><p>As we know<script type="math/tex">\left(\frac{1}{3}\right)=1,\left(\frac{2}{3}\right)=-1</script>, so we get</p><script type="math/tex;mode=display">\begin{cases}
p\bmod 3=1\\
p\bmod 2=1\\
\frac{p-1}{2}\bmod 2=0
\end{cases}
\text{ or }
\begin{cases}
p\bmod 3=2\\
p\bmod 2=1\\
\frac{p-1}{2}\bmod 2=1
\end{cases}</script><p><script type="math/tex">p=12k+1,12k+11</script>.<script type="math/tex">p</script>should be a prime.</p><blockquote><p>Find<script type="math/tex">p</script>such that<script type="math/tex">\left( \frac{5}{p}\right)=1</script>. (P36)</p></blockquote><p>Similar to above. Skip.</p><blockquote><p>Calculate<script type="math/tex">\left( \frac{74}{101}\right)</script>. (P36)</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">Legendre</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p<span class="token operator">%=</span>q
    <span class="token keyword">if</span> p<span class="token operator">==</span><span class="token number">0</span> <span class="token punctuation">:</span> <span class="token keyword">return</span> <span class="token number">0</span>
    ans<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">*</span>i<span class="token operator">%</span>q<span class="token operator">==</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
            ans<span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">return</span> ans<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Just a joke. Obviously we should use <strong>quadratic reciprocal law</strong> to solve it. Python code:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">sig</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token operator">%</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">Legendre</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># q should be a prime</span>
    p1<span class="token operator">=</span>p
    q1<span class="token operator">=</span>q
    <span class="token keyword">if</span> p<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> sig<span class="token punctuation">(</span><span class="token punctuation">(</span>q<span class="token operator">*</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> p<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    x<span class="token operator">=</span><span class="token number">2</span>
    res<span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">while</span> x<span class="token operator">*</span>x<span class="token operator">&lt;=</span>p<span class="token punctuation">:</span>
        <span class="token keyword">if</span> p<span class="token operator">%</span>x<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
            t<span class="token operator">=</span>Legendre<span class="token punctuation">(</span>x<span class="token punctuation">,</span>q<span class="token punctuation">)</span> <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token number">2</span> <span class="token keyword">else</span> Legendre<span class="token punctuation">(</span>q<span class="token operator">%</span>x<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token operator">*</span>sig<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">4</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span> p<span class="token operator">%</span>x<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
                res<span class="token operator">*=</span>t
                p<span class="token operator">//=</span>x
                <span class="token keyword">if</span> res<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> <span class="token number">0</span>
        x <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">if</span> p<span class="token operator">></span><span class="token number">1</span><span class="token punctuation">:</span>
        res<span class="token operator">*=</span>Legendre<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span> <span class="token keyword">if</span> p<span class="token operator">==</span><span class="token number">2</span> <span class="token keyword">else</span> Legendre<span class="token punctuation">(</span>q<span class="token operator">%</span>p<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">*</span>sig<span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> res

<span class="token keyword">print</span><span class="token punctuation">(</span>Legendre<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2><a id="Ex-10-Exponential-Congruence-Equation" href="#Ex-10-Exponential-Congruence-Equation" class="headerlink" title="Ex 10 (Exponential Congruence Equation)"></a>Ex 10 (Exponential Congruence Equation)</h2><p>First let’s learn some conclusion of exponential congruence equation.</p><p>Theorem: If<script type="math/tex">n</script>is not divisible by odd prime<script type="math/tex">p</script>, then the number of solutions of</p><script type="math/tex;mode=display">x^2=n\mod p^l</script><p>is<script type="math/tex">(\frac{n}{p})+1</script>.</p><p>The number of solutions of</p><script type="math/tex;mode=display">x^k=1\mod p</script><p>is<script type="math/tex">(k,p-1)</script>or<script type="math/tex">1</script>.</p><p><script type="math/tex">x^k</script>takes<script type="math/tex">\frac{p-1}{(p-1,k)}</script>different values when<script type="math/tex">x</script>goes through a reduced residue system of<script type="math/tex">p</script>.</p><blockquote><p>(MU training 2017) Let<script type="math/tex">p</script>be a prime number,<script type="math/tex">f(i)</script>be the number of solutions of</p><script type="math/tex;mode=display">(x+y)^i=x^i\mod p</script><p>where<script type="math/tex">0&lt;x&lt;p,0&lt;y&lt;m+1</script>. Calculate</p><script type="math/tex;mode=display">\sum_{i=1}^{p-1}i\times f(i) \mod {10^9+7}</script><p>(P38)</p></blockquote><p>First we have</p><script type="math/tex;mode=display">(1+x^{-1}y)^i=1\mod p</script><p>if<script type="math/tex">p|y</script>, the equation always satisfies.</p><p>Otherwise<script type="math/tex">p\nmid y</script>, for a fixed<script type="math/tex">y</script>,<script type="math/tex">(1+x^{-1}y)</script>can goes through a reduced residue system of<script type="math/tex">p</script>. The number of solutions is<script type="math/tex">(i,p-1)</script>. So we have</p><script type="math/tex;mode=display">f(i)=\left\lfloor\frac{m}{p}\right\rfloor(p-1)+\left(m-\left\lfloor\frac{m}{p}\right\rfloor\right)(i,p-1)</script><p>Thus</p><script type="math/tex;mode=display">\sum_{i=1}^{p-1}i\times f(i)
=\frac{p(p-1)}{2}\left\lfloor\frac{m}{p}\right\rfloor(p-1) + \left(m-\left\lfloor\frac{m}{p}\right\rfloor\right)\sum_{i=1}^{p-1}i (i,p-1)</script><p>Let’s define the last sum as<script type="math/tex">g</script>:</p><script type="math/tex;mode=display">\begin{aligned}
g(n)&=\sum_{i=1}^ni(i,n)\\
&=n^2+\frac{1}{2}\sum_{i=1}^{n-1}i(i,n)+(n-i)(n-i,n)\\
&=n^2+\frac{1}{2}n\sum_{i=1}^{n-1}(i,n)\\
&=n^2+\frac{1}{2}n\sum_{i=1}^{n-1}\sum_{d|i,d|n}\varphi(d)
\end{aligned}</script><p>Concentrate on the latter part:</p><script type="math/tex;mode=display">\begin{aligned}
&\sum_{i=1}^{n-1}\sum_{d|i,d|n}\varphi(d)\\
=&\sum_{d|n}\varphi (d) \left(\frac{n}{d}-1\right)\\
=&\sum_{d|n}\varphi (d) \frac{n}{d}-n
\end{aligned}</script><p>Thus</p><script type="math/tex;mode=display">\begin{aligned}
g(n)&=n^2+\frac{1}{2}n\sum_{i=1}^{n-1}\sum_{d|i,d|n}\varphi(d)\\
&=\frac{1}{2}n^2+\frac{1}{2}n\sum_{d|n}\varphi (d) \frac{n}{d}
\end{aligned}</script><p>So we can use Min_25’s Sieve Method to compute<script type="math/tex">g(n)</script>in<script type="math/tex">O(\frac{n^{\frac{3}{4}}}{\log n})</script>.</p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2020年1月15日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Probset/APIO2019/">APIO 2019</a></div><div class="prev-post"><a href="/Math/Fomula-of-Sphere/">球体积公式推导 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>