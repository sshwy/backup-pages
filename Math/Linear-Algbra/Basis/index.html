<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>线性基学习笔记 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">线性基学习笔记</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2023年5月4日星期四晚上11点08分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2023年5月4日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 2,598 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/Linear-Algbra/">线性代数 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#线性基"><span class="toc-number">1.</span> <span class="toc-text">线性基</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HDU3949-Xor"><span class="toc-number">2.</span> <span class="toc-text">HDU3949 Xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#平方数的套路"><span class="toc-number">3.</span> <span class="toc-text">平方数的套路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#带删除的线性基"><span class="toc-number">4.</span> <span class="toc-text">带删除的线性基</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#算法一"><span class="toc-number">4.1.</span> <span class="toc-text">算法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法二"><span class="toc-number">4.2.</span> <span class="toc-text">算法二</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#第一部分"><span class="toc-number">4.2.1.</span> <span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第二部分"><span class="toc-number">4.2.2.</span> <span class="toc-text">第二部分</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法三"><span class="toc-number">4.3.</span> <span class="toc-text">算法三</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线性基的一个神奇应用"><span class="toc-number">5.</span> <span class="toc-text">线性基的一个神奇应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-number">6.</span> <span class="toc-text">参考文献</span></a></li></ol></div><hr></div><div class="post-content"><p>基（basis）是线性代数中的一个概念，它是描述、刻画向量空间的基本工具。而在现行的 OI 题目中，通常在利用基在<strong>异或空间</strong>中的一些特殊性质来解决题目，而这一类题目所涉及的知识点被称作「线性基」。</p><p>有关向量空间（Vector Space）、线性无关（linearly independent）、线性组合（linear combination）、张成（Span）、基（Basis）的概念就不讲了，请自行了解。</p><h2><a id="线性基" href="#线性基" class="headerlink" title="线性基"></a>线性基</h2><p>简单来说，线性基维护的是异或空间下的若干个线性无关向量，它们组成一个矩阵。在实现时我们使用<script type="math/tex">b_i</script>表示最高位为第<script type="math/tex">i</script>位且为<script type="math/tex">1</script>的向量的值。</p><p>线性基可以使用上三角矩阵维护，插入一个向量时需要消元，复杂度<script type="math/tex">O(\log_2n)</script>。在特殊题目的要求下可能需要消元成对角矩阵，这时的插入复杂度就是<script type="math/tex">O(\log_2^2n)</script>。</p><p>线性基的合并就是暴力插入的过程，复杂度<script type="math/tex">O(n\log_2^2n)</script>。</p><h2><a id="HDU3949-Xor" href="#HDU3949-Xor" class="headerlink" title="HDU3949 Xor"></a>HDU3949 Xor</h2><blockquote><p>求去重后异或第<script type="math/tex">k</script>小。</p></blockquote><p>消成对角矩阵的线性基可以解决异或第 K 小的问题。由于是模板题所以给出核心代码：</p><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">/******************heading******************/</span>

<span class="token keyword">int</span> n<span class="token punctuation">;</span>

<span class="token keyword">long</span> <span class="token keyword">long</span> b<span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span>lb<span class="token punctuation">;</span>
<span class="token keyword">long</span> <span class="token keyword">long</span> p<span class="token punctuation">[</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token punctuation">,</span>lp<span class="token punctuation">;</span>
<span class="token keyword">bool</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">ROF</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>x<span class="token operator">>></span>i<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>x<span class="token punctuation">,</span>lb<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token function">ROF</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>></span>j<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^=</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token function">FOR</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">>></span>i<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span>b<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">^=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        x<span class="token operator">^=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> len<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">FOR</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>len<span class="token operator">=</span>i<span class="token punctuation">;</span>
    <span class="token function">FOR</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token function">ROF</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>len<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>></span>j<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">FOR</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>p<span class="token punctuation">[</span>lp<span class="token operator">++</span><span class="token punctuation">]</span><span class="token operator">=</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lb<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>lp<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token keyword">long</span> <span class="token keyword">long</span> x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">long</span> <span class="token keyword">long</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">FOR</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">>></span>i<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">)</span>res<span class="token operator">^=</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">go</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    cin<span class="token operator">>></span>n<span class="token punctuation">;</span>
    <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> fl<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">FOR</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">long</span> <span class="token keyword">long</span> x<span class="token punctuation">;</span>
        cin<span class="token operator">>></span>x<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">insert</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>fl<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> <span class="token keyword">long</span> lim<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1ll</span><span class="token operator">&lt;&lt;</span>lb<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> q<span class="token punctuation">;</span>
    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">FOR</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">long</span> <span class="token keyword">long</span> x<span class="token punctuation">;</span>
        cin<span class="token operator">>></span>x<span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>fl<span class="token punctuation">)</span>x<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">></span>lim<span class="token punctuation">)</span>cout<span class="token operator">&lt;&lt;</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
        <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span><span class="token function">query</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> t<span class="token punctuation">;</span>
    cin<span class="token operator">>></span>t<span class="token punctuation">;</span>
    <span class="token function">FOR</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>t<span class="token punctuation">)</span>cout<span class="token operator">&lt;&lt;</span> <span class="token string">"Case #"</span> <span class="token operator">&lt;&lt;</span> i<span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">,</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2><a id="平方数的套路" href="#平方数的套路" class="headerlink" title="平方数的套路"></a>平方数的套路</h2><p>有时要求一段区间选若干个数乘积的平方数。记录每一个数的质因数次数的奇偶性，即一个 01 向量，就转化为异或和为 0 的问题。如果他们线性相关就有解，否则无解。</p><h2><a id="带删除的线性基" href="#带删除的线性基" class="headerlink" title="带删除的线性基"></a>带删除的线性基</h2><p>形式化地，我们要求支持：</p><ul><li>插入一个数</li><li>删除一个数</li><li>求这个集合的线性基</li></ul><h3><a id="算法一" href="#算法一" class="headerlink" title="算法一"></a>算法一</h3><p>我们可以求出每个数的存在时间。然后在时间线段树上 DFS 即可。复杂度是<script type="math/tex">O(n\log_2n\log_2w)</script>的。</p><p><a target="_blank" rel="noopener" href="http://darkbzoj.tk/problem/4184">BZOJ4184 shallot</a></p><p>例题：最大 xor 路径。</p><h3><a id="算法二" href="#算法二" class="headerlink" title="算法二"></a>算法二</h3><p>我们也有更优秀的做法（在线）。</p><p>插入<script type="math/tex">x</script>，我们直接按照线性基的方式插入即可。</p><p>但删除<script type="math/tex">x</script>就有一些问题。</p><p>如果<script type="math/tex">x</script>不在线性基里：直接删了完事。</p><p>如果<script type="math/tex">x</script>在线性基里，那么我们就需要做两件事：</p><ol><li>消除<script type="math/tex">x</script>在线性基中的影响。</li><li>可能在删除<script type="math/tex">x</script>后，有新的数可以被加到线性基中。</li></ol><h4><a id="第一部分" href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h4><p>我们知道，把<script type="math/tex">x</script>插入到线性基中时，会先异或一些基，最后当<script type="math/tex">x</script>找到一个没有被 span 的维度（基）那么就做为一个新的基<script type="math/tex">x'</script>加入到线性基中（<script type="math/tex">x'</script>就是<script type="math/tex">x</script>异或到最后的那个数）。</p><p>而在之后插入的数中，有一部分基会异或<script type="math/tex">x'</script>，那么这些基里就含有<script type="math/tex">x'</script>的影响。我们要做的就是消除这些影响。</p><p>方法 1：我们可以直接拿<script type="math/tex">x'</script>异或这些基然后再删除<script type="math/tex">x'</script>（异或自己），这样的确能消除影响，但问题是你这么搞完之后，线性基就不一定是上三角矩阵了，你还得想办法维护一下。</p><p>方法 2：方法 1 的问题的出现原因是异或过<script type="math/tex">x'</script>的基都比<script type="math/tex">x'</script>小。因此我们不妨找到异或过<script type="math/tex">x'</script>的基中最小的基，记做<script type="math/tex">y'</script>。那么<script type="math/tex">y'</script>里有什么？它有<script type="math/tex">x'</script>的影响，和除了<script type="math/tex">x'</script>之外的影响（废话）。我们的目的是消除所有<script type="math/tex">x'</script>的影响——也就是给他异或一个<script type="math/tex">x'</script>上去。我们不妨用<script type="math/tex">y'</script>异或<strong>所有</strong>的，异或过<script type="math/tex">x'</script>的基。</p><ul><li>当<script type="math/tex">x'</script>异或上<script type="math/tex">y'</script>，它相当于把<script type="math/tex">y'</script>消除<script type="math/tex">x'</script>的影响后放到<script type="math/tex">x'</script>的位置上。</li><li>当<script type="math/tex">y'</script>异或其他基时尽管会顺带将<script type="math/tex">y'</script>的部分影响加到（去掉）这个基上，但这无关紧要。因为<script type="math/tex">y'</script>的基它还在（在<script type="math/tex">x'</script>的位置上）</li><li>当<script type="math/tex">y'</script>异或自己时，它把自己删掉了。但这无所谓，因为<script type="math/tex">x'</script>的位置就是它新的位置。</li></ul><p>这么一番操作，<script type="math/tex">x'</script>没了<script type="math/tex">y'</script>还在。我称之为借刀自杀。</p><h4><a id="第二部分" href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h4><p>接下来的问题是，你删了<script type="math/tex">x</script>对应的<script type="math/tex">x'</script>后，可能会有线性基外面的数能够加到线性基中。那么哪些数能被加进来？在之前的线性基表示中包含了<script type="math/tex">x'</script>的数。于是我们记一个<script type="math/tex">S(x')</script>表示在线性基外面包含<script type="math/tex">x'</script>的数的集合。那么我们在里面随便选一个数<script type="math/tex">z</script>，然后在它的线性基表示的集合中删掉<script type="math/tex">z</script>，把<script type="math/tex">z</script>插入后令<script type="math/tex">S(z')\gets S(x')</script>即可。</p><h3><a id="算法三" href="#算法三" class="headerlink" title="算法三"></a>算法三</h3><p>上述算法中会用到 set，在较大的数据范围（2e6）下运行速度较慢。我们有常数更小的离线做法。</p><p>在删除的时候我们要消除<script type="math/tex">x'</script>在线性基里的影响。那么如果<script type="math/tex">x'</script>本身就是最后一个被加入的数呢？那我们直接删了它就完事了。</p><p>离线的时候，我们可以计算出每个数的删除时间。进而可以在线性基里维护每个基的删除时间。当插入一个数的时候，如果它当前异或的基的删除时间比它早，那么我们不如直接交换这个基和你当前的数。让你当前的数代替这个位置，让那个基来继续执行插入的操作。容易发现这样构造的线性基，小的基的删除时间都比大的基早，因此删除就可以直接删除了。</p><p>时间复杂度仍是<script type="math/tex">O(n\log_2w)</script>，如果使用排序而不是 set，常数会比较小。</p><h2><a id="线性基的一个神奇应用" href="#线性基的一个神奇应用" class="headerlink" title="线性基的一个神奇应用"></a>线性基的一个神奇应用</h2><p>BZOJ3569</p><p>通过随机赋权，判断是否线性相关的方式来判图是否连通。</p><p>题解：</p><p>先找出一个 dfs 树，考虑在什么情况下无向图会变得不连通。</p><p>当且仅当存在一条树边，满足所有覆盖这条树边的返祖边和这条树边都被删除时，无向图不连通。</p><p>那么如何判断是不是存在这样一条树边呢，我们可以给每条返祖边随机一个权值，每条树边的权值就是所有覆盖它的返祖边的权值异或和。对于一次查询，如果查询的边权线性相关说明一定能找到一个子集异或和为 0，也就是满足无向图不连通的条件了。</p><h2><a id="参考文献" href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/a_forever_dream/article/details/83654397">https://blog.csdn.net/a_forever_dream/article/details/83654397</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2023年5月4日 第3次修订</li><li class="post-history-item">2021年7月14日 第2次修订</li><li class="post-history-item">2020年5月2日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Intro-to-Search.rs/">搜索复习</a></div><div class="prev-post"><a href="/String/AC/">AC 自动机入门 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>