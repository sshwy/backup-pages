<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>矩阵树定理学习笔记 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">矩阵树定理学习笔记</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年2月10日星期三上午9点22分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年2月10日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 1,368 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/Linear-Algbra/">线性代数 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#矩阵树定理"><span class="toc-number">1.</span> <span class="toc-text">矩阵树定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#有向图内向生成树计数"><span class="toc-number">1.1.</span> <span class="toc-text">有向图内向生成树计数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#无向图生成树计数"><span class="toc-number">1.2.</span> <span class="toc-text">无向图生成树计数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#主子式形式"><span class="toc-number">1.2.1.</span> <span class="toc-text">主子式形式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#特征值形式"><span class="toc-number">1.2.2.</span> <span class="toc-text">特征值形式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关联矩阵"><span class="toc-number">2.</span> <span class="toc-text">关联矩阵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#生成树计数"><span class="toc-number">3.</span> <span class="toc-text">生成树计数</span></a></li></ol></div><hr></div><div class="post-content"><p>矩阵树定理（Matrix-tree Theorem）是把图的生成树个数和矩阵行列式联系起来的一个定理。</p><h2><a id="矩阵树定理" href="#矩阵树定理" class="headerlink" title="矩阵树定理"></a>矩阵树定理</h2><h3><a id="有向图内向生成树计数" href="#有向图内向生成树计数" class="headerlink" title="有向图内向生成树计数"></a>有向图内向生成树计数</h3><p>对于无自环（允许有重边）的有向图<script type="math/tex">G=(V,E)</script>。设出度矩阵<script type="math/tex">D(G)</script>表示每个点的出度的对角矩阵。而<script type="math/tex">A(G)</script>表示邻接矩阵，<script type="math/tex">A_{ij}</script>表示<script type="math/tex">(i\to j)</script>的边数。那么可得到对应的<strong>拉普拉斯矩阵（Laplacian Matrix）</strong><script type="math/tex">L(G)=D(G)-A(G)</script>。</p><p><script type="math/tex">L(G)</script>关于<script type="math/tex">L(G)_{k,k}</script>的余子式（也是主子式）是以<script type="math/tex">k</script>为根的<strong>内向生成树</strong>的个数。</p><h3><a id="无向图生成树计数" href="#无向图生成树计数" class="headerlink" title="无向图生成树计数"></a>无向图生成树计数</h3><h4><a id="主子式形式" href="#主子式形式" class="headerlink" title="主子式形式"></a>主子式形式</h4><p>对于无自环（允许有重边）无向图<script type="math/tex">G=(V,E)</script>，设度数矩阵<script type="math/tex">D(G)</script>表示每个点的度，而<script type="math/tex">A(G)</script>表示邻接矩阵，<script type="math/tex">A_{ij}</script>表示<script type="math/tex">(i,j)</script>的重边数。则<script type="math/tex">L(G)=D(G)-A(G)</script>。</p><p>对于任意<script type="math/tex">i\in[1,n]</script>，<script type="math/tex">L(G)</script>关于<script type="math/tex">L(G)_{i,i}</script>的余子式是生成树的个数。即，无向图的拉普拉斯矩阵的所有<script type="math/tex">n-1</script>阶主子式的行列式值都相等。</p><p>注意到无向图矩阵树定理求的实际上是<script type="math/tex">\sum_{T}\prod_{(i,j)\in T}A_{ij}</script>，因此它也可以理解为是求所有生成树的边权乘积的和。</p><h4><a id="特征值形式" href="#特征值形式" class="headerlink" title="特征值形式"></a>特征值形式</h4><p>对于<script type="math/tex">L(G)</script>的<script type="math/tex">n-1</script>个非零特征值（即无向图的<script type="math/tex">L(G)</script>至少有一个特征值为<script type="math/tex">0</script>）<script type="math/tex">\lambda_1,\lambda_2,\cdots,\lambda_{n-1}</script>，<script type="math/tex">G</script>的生成树个数为</p><script type="math/tex;mode=display">\frac{1}{n}\prod_{i=1}^{n-1}\lambda_i</script><h2><a id="关联矩阵" href="#关联矩阵" class="headerlink" title="关联矩阵"></a>关联矩阵</h2><p>在矩阵树定理应用的过程中，我们不太需要关注证明，但需要知道拉普拉斯矩阵是怎么来的。</p><p>对于<strong>无向图</strong><script type="math/tex">G</script>，我们给<script type="math/tex">G</script>的每条边随便定向，定向后的图为<script type="math/tex">G'</script>。另外我们给边标号，第<script type="math/tex">i</script>条边是<script type="math/tex">(u_i,v_i)</script>那么定义<script type="math/tex">G'</script>的关联矩阵<script type="math/tex">M(G')</script>为</p><script type="math/tex;mode=display">M_{ij}=\begin{cases}
-1 & i=u_j\\
1 & i=v_j\\
0 & \text{otherwise}
\end{cases}</script><p>容易证明，<script type="math/tex">L(G) = M(G')M(G')^T</script>。</p><p>实际上我们也很少关心关联矩阵的性质，我们关注的是：<script type="math/tex">L</script>是由两个矩阵相乘得到的。</p><h2><a id="生成树计数" href="#生成树计数" class="headerlink" title="生成树计数"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5296">生成树计数</a></h2><blockquote><p>给出一个<script type="math/tex">n</script>个点边带权完全图<script type="math/tex">G=(V,E,w:E\to \mathbf{Z})</script>，求其所有生成树的边权和的<script type="math/tex">k</script>次方之和，即</p><script type="math/tex;mode=display">\sum_{T}\left(\sum_{(u,v) \in T}w(u,v)\right)^k</script><p><script type="math/tex">1\le n\le 30, 0\le k\le 30</script>。</p></blockquote><p>首先这题用斯特林数是不方便的，考虑生成函数。</p><p>我们想办法转化为矩阵树定理方便处理的形式。</p><p>注意到<script type="math/tex">(w_1+w_2+\cdots +w_m)^k = k![x^k]\prod_{i=1}^m e^{w_ix}</script>，即上式等于</p><script type="math/tex;mode=display">k![x^k]\sum_{T}\prod_{(u,v) \in T} e^{w(u,v)x}</script><p>而我们只需要求<script type="math/tex">x^k</script>项，则可以把多项式对<script type="math/tex">x^{k+1}</script>取模。所以我们让边权是<script type="math/tex">e^{w(u,v)x} \bmod x^{k+1}</script>即可。</p><p>有个细节：每个点的度是<script type="math/tex">d_u = \sum e^{w(u,v)x}</script>，而不是<script type="math/tex">\prod</script>。理解了拉普拉斯矩阵怎么来的就可以理解这一点。</p><p>时间复杂度<script type="math/tex">O(n^3k^2)</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/5296.cpp">代码</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年2月10日 第4次修订</li><li class="post-history-item">2021年1月30日 第3次修订</li><li class="post-history-item">2021年1月19日 第2次修订</li><li class="post-history-item">2020年12月29日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Banknote-Proposition-Report/">Banknote Collection 命题报告</a></div><div class="prev-post"><a href="/Matroid/">拟阵学习笔记 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>