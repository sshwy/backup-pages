<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>线性代数入门 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">线性代数入门</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2020年12月29日星期二中午11点44分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2020年12月29日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 7,708 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/Linear-Algbra/">线性代数 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#矩阵"><span class="toc-number">1.</span> <span class="toc-text">矩阵</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#矩阵基本操作"><span class="toc-number">1.1.</span> <span class="toc-text">矩阵基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#加法、标量乘法、转置"><span class="toc-number">1.1.1.</span> <span class="toc-text">加法、标量乘法、转置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#矩阵乘法"><span class="toc-number">1.1.2.</span> <span class="toc-text">矩阵乘法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#矩阵初等变换"><span class="toc-number">1.2.</span> <span class="toc-text">矩阵初等变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方阵初等变换"><span class="toc-number">1.3.</span> <span class="toc-text">方阵初等变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#矩阵求逆"><span class="toc-number">1.4.</span> <span class="toc-text">矩阵求逆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相似矩阵"><span class="toc-number">1.5.</span> <span class="toc-text">相似矩阵</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#行列式"><span class="toc-number">2.</span> <span class="toc-text">行列式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#行列式操作"><span class="toc-number">2.1.</span> <span class="toc-text">行列式操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#行列式的计算"><span class="toc-number">2.2.</span> <span class="toc-text">行列式的计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#直接计算"><span class="toc-number">2.2.1.</span> <span class="toc-text">直接计算</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#拆行列式"><span class="toc-number">2.2.2.</span> <span class="toc-text">拆行列式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#余子式与伴随矩阵"><span class="toc-number">2.2.3.</span> <span class="toc-text">余子式与伴随矩阵</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其他环上行列式的计算"><span class="toc-number">2.2.4.</span> <span class="toc-text">其他环上行列式的计算</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#矩阵特征值与特征多项式"><span class="toc-number">3.</span> <span class="toc-text">矩阵特征值与特征多项式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#特征值与特征向量"><span class="toc-number">3.1.</span> <span class="toc-text">特征值与特征向量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#特征多项式"><span class="toc-number">3.2.</span> <span class="toc-text">特征多项式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#特征多项式的计算"><span class="toc-number">3.3.</span> <span class="toc-text">特征多项式的计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#上海森堡矩阵"><span class="toc-number">3.3.1.</span> <span class="toc-text">上海森堡矩阵</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#上海森堡矩阵的行列式"><span class="toc-number">3.3.2.</span> <span class="toc-text">上海森堡矩阵的行列式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#哈密尔顿-凯莱定理"><span class="toc-number">3.4.</span> <span class="toc-text">哈密尔顿 - 凯莱定理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常系数齐次线性递推"><span class="toc-number">4.</span> <span class="toc-text">常系数齐次线性递推</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#思路一"><span class="toc-number">4.1.</span> <span class="toc-text">思路一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#思路二"><span class="toc-number">4.2.</span> <span class="toc-text">思路二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-number">5.</span> <span class="toc-text">参考文献</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#拓展资料"><span class="toc-number">6.</span> <span class="toc-text">拓展资料</span></a></li></ol></div><hr></div><div class="post-content"><p>遇到一道毒瘤的数理知识题，就有了本文。</p><h2><a id="矩阵" href="#矩阵" class="headerlink" title="矩阵"></a>矩阵</h2><p>将一些元素排列成若干行，每行放上相同数量的元素，就是一个<strong>矩阵（Matrix）</strong>。</p><p>矩阵通常用大写字母表示。一个矩阵<script type="math/tex">A</script>从左上角数的第<script type="math/tex">i</script>行第<script type="math/tex">j</script>列的数称作第<script type="math/tex">i,j</script>项，记作<script type="math/tex">A_{i,j}</script>或<script type="math/tex">A_{ij}</script>。</p><p>如果<script type="math/tex">A</script>的元素可以用只与行数和列数有关的函数<script type="math/tex">f</script>表示，则可以用<script type="math/tex">A=[f(i,j)]_{m\times n}</script>表示。其中<script type="math/tex">m</script>表示行数，<script type="math/tex">n</script>表示列数。</p><p>对于<script type="math/tex">m=n</script>的矩阵我们称之为<strong>方阵</strong>（方块矩阵）。</p><h3><a id="矩阵基本操作" href="#矩阵基本操作" class="headerlink" title="矩阵基本操作"></a>矩阵基本操作</h3><h4><a id="加法、标量乘法、转置" href="#加法、标量乘法、转置" class="headerlink" title="加法、标量乘法、转置"></a>加法、标量乘法、转置</h4><p><strong>加法</strong>：对于矩阵<script type="math/tex">A_{m\times n},B_{m\times n}</script>，定义矩阵加法为<script type="math/tex">A</script>和<script type="math/tex">B</script>对应位置上的元素相加。即<script type="math/tex">A+B=[A_{i,j}+B_{i,j}]_{m\times n}</script>。</p><p><strong>标量乘法（Scalar multiplication）</strong>：对于矩阵<script type="math/tex">A_{m\times n}</script>和标量<script type="math/tex">c</script>，他们相乘的结果是<script type="math/tex">Ac=[A_{i,j}\cdot c]_{m\times n}</script>。</p><p><strong>转置（Transposition）</strong>：对于矩阵<script type="math/tex">A_{m\times n}</script>，其转置矩阵记作<script type="math/tex">A^T</script>，且<script type="math/tex">A^T=[A_{j,i}]_{n\times m}</script>。即横竖翻转。</p><h4><a id="矩阵乘法" href="#矩阵乘法" class="headerlink" title="矩阵乘法"></a>矩阵乘法</h4><p>定义<script type="math/tex">A_{n\times m}</script>和<script type="math/tex">B_{m\times k}</script>的矩阵乘法为</p><script type="math/tex;mode=display">AB=\left[ \sum_{x=1}^mA_{i,x}B_{x,j} \right]_{n\times k}</script><p>其中<script type="math/tex">i\in[1,n],j\in[1,k]</script>。</p><ol><li><p>分配律：<script type="math/tex">(A+B)C=AC+BC</script>。</p></li><li><p>结合律：<script type="math/tex">A(BC)=(AB)C</script>。</p></li><li><p>矩阵乘法<strong>不具备</strong>交换律。</p></li></ol><h3><a id="矩阵初等变换" href="#矩阵初等变换" class="headerlink" title="矩阵初等变换"></a>矩阵初等变换</h3><p>矩阵初等变换有三种，分行操作和列操作。不过行和列是对称的。</p><ol><li>行交换：将矩阵<script type="math/tex">A_{n\times m}</script>的第<script type="math/tex">i</script>行和第<script type="math/tex">j(i\ne j)</script>行交换。记作<script type="math/tex">R_i\leftrightarrow R_j</script>。</li><li>行数乘：将第<script type="math/tex">i</script>行的每个元素都乘上一个<strong>非<script type="math/tex">0</script></strong>常数<script type="math/tex">k</script>，记作<script type="math/tex">kR_i\to R_i,k\ne 0</script>。</li><li>行加法：第<script type="math/tex">j</script>行的<script type="math/tex">k(k\ne 0)</script>倍加到第<script type="math/tex">i</script>行上，记作<script type="math/tex">R_i+kR_j\to R_i,i\ne j</script>。</li></ol><h3><a id="方阵初等变换" href="#方阵初等变换" class="headerlink" title="方阵初等变换"></a>方阵初等变换</h3><p>对于方阵而言，由于两个方阵的矩阵乘法不改变方阵的形状，因此我们可以用矩阵乘法表示方阵的初等变换。</p><p>对于<script type="math/tex">R_i\leftrightarrow R_j</script>，等价于<script type="math/tex">A_{n\times n}</script>左乘一个<script type="math/tex">B_{n\times n}</script>的矩阵，满足</p><script type="math/tex;mode=display">B_{x,y}=\begin{cases}
1 & x=i,y=j\\
1 & x=j,y=i\\
1 & x=y,x\ne i,x\ne j\\
0 & \text{Otherwise}
\end{cases}</script><p>对于<script type="math/tex">kR_i\to R_i,k\ne 0</script>操作，<script type="math/tex">B</script>的条件为</p><script type="math/tex;mode=display">B_{x,y}=\begin{cases}
k & x=y,x=i\\
1 & x=y,x\ne i\\
0 & \text{Otherwise}
\end{cases}</script><p>对于<script type="math/tex">R_i+kR_j\to R_i,i\ne j</script>，<script type="math/tex">B</script>的条件为</p><script type="math/tex;mode=display">B_{x,y}=\begin{cases}
k & x=i,y=j\\
1 & x=y\\
0 & \text{Otherwise}
\end{cases}</script><p>对于<strong>初等列变换</strong>，则可以表示为<script type="math/tex">A</script><strong>右乘</strong>一个矩阵<script type="math/tex">B</script>。设<script type="math/tex">C_i</script>表示矩阵的第<script type="math/tex">i</script>列。</p><p>对于<script type="math/tex">C_i\leftrightarrow C_j</script>，<script type="math/tex">B</script>的条件与<script type="math/tex">R_i\leftrightarrow R_j</script>相同：</p><script type="math/tex;mode=display">B_{x,y}=\begin{cases}
1 & x=i,y=j\\
1 & x=j,y=i\\
1 & x=y,x\ne i,x\ne j\\
0 & \text{Otherwise}
\end{cases}</script><p>对于<script type="math/tex">kC_i\to C_i,k\ne 0</script>，<script type="math/tex">B</script>的条件与<script type="math/tex">kR_i\to R_i,k\ne 0</script>相同：</p><script type="math/tex;mode=display">B_{x,y}=\begin{cases}
k & x=i,y=j\\
1 & x=y\\
0 & \text{Otherwise}
\end{cases}</script><p>对于<script type="math/tex">C_i+kC_j\to C_i,i\ne j</script>，<script type="math/tex">B</script>的条件是<script type="math/tex">R_i+kR_j\to R_i,i\ne j</script>的<strong>转置</strong>：</p><script type="math/tex;mode=display">B_{x,y}=\begin{cases}
k & x=j,y=i\\
1 & x=y\\
0 & \text{Otherwise}
\end{cases}</script><h3><a id="矩阵求逆" href="#矩阵求逆" class="headerlink" title="矩阵求逆"></a>矩阵求逆</h3><p>定义<strong>单位矩阵（Identity Matrix）</strong>为主对角线上元素为<script type="math/tex">1</script>，其他元素为<script type="math/tex">0</script>的<strong>方阵</strong>，记作<script type="math/tex">I</script>。</p><p>定义<script type="math/tex">A</script>矩阵的<strong>逆矩阵</strong><script type="math/tex">B</script>为使得<script type="math/tex">AB=I</script>的矩阵。若存在这样的<script type="math/tex">B</script>矩阵，称<script type="math/tex">A</script><strong>可逆</strong>。<script type="math/tex">A</script>的逆矩阵记作<script type="math/tex">A^{-1}=B</script>。</p><p>定义符号<script type="math/tex">(A | B)</script>表示在<script type="math/tex">A_{n\times n}</script>矩阵右边放置<script type="math/tex">B_{n\times n}</script>矩阵，形成<script type="math/tex">n\times 2n</script>的矩阵。</p><p>那么我们使用高斯消元将<script type="math/tex">(A|I)</script>中的<script type="math/tex">A</script>消成<script type="math/tex">I</script>，得到<script type="math/tex">(I|B)</script>，那么这里的<script type="math/tex">B</script>就是<script type="math/tex">A^{-1}</script>。若<script type="math/tex">A</script>消不成<script type="math/tex">I</script>则<script type="math/tex">A</script>不可逆。</p><h3><a id="相似矩阵" href="#相似矩阵" class="headerlink" title="相似矩阵"></a>相似矩阵</h3><p><strong>相似矩阵（similar matrix）</strong>是指存在相似关系的矩阵。两个<script type="math/tex">n\times n</script>的方阵<script type="math/tex">A</script>和<script type="math/tex">B</script>为相似矩阵当且仅当存在<script type="math/tex">n\times n</script>的可逆矩阵<script type="math/tex">P</script>满足</p><script type="math/tex;mode=display">P^{-1}AP=B</script><p>相似矩阵的秩、行列式、特征值、特征多项式相同。</p><h2><a id="行列式" href="#行列式" class="headerlink" title="行列式"></a>行列式</h2><p>行列式通常是对于<strong>方阵</strong>定义的。</p><p>方阵<script type="math/tex">A_{n\times n}</script>的<strong>行列式（Determinant）</strong>是一个将其映射到标量的函数，记作<script type="math/tex">\det(A)</script>或者<script type="math/tex">|A|</script>。通常可以将其理解为是高维空间的欧氏体积。</p><p>定义<script type="math/tex">P_n</script>表示所有<script type="math/tex">n!</script>个长度为<script type="math/tex">n</script>的排列<script type="math/tex">p</script>构成的集合。矩阵的行列式定义为：</p><script type="math/tex;mode=display">|A|=\sum_{p\in P_n}\operatorname{sgn}(p)\prod_{i=1}^nA_{i,p_i}</script><p>其中<script type="math/tex">\operatorname{sgn}</script>表示排列的逆序对个数对<script type="math/tex">-1</script>的幂。即设<script type="math/tex">N(p)</script>表示排列<script type="math/tex">p</script>的逆序对个数，则<script type="math/tex">\operatorname{sgn}(p)=(-1)^{N(p)}</script>。</p><h3><a id="行列式操作" href="#行列式操作" class="headerlink" title="行列式操作"></a>行列式操作</h3><p>方阵乘积的行列式等于行列式的乘积：<script type="math/tex">|AB|=|A||B|</script>。<a target="_blank" rel="noopener" href="https://users.math.msu.edu/users/gnagy/teaching/05-fall/Math20F/w7-F.pdf">证明</a></p><p>若<script type="math/tex">A</script>可逆，则<script type="math/tex">|A^{-1}|=|A|^{-1}</script>。</p><h3><a id="行列式的计算" href="#行列式的计算" class="headerlink" title="行列式的计算"></a>行列式的计算</h3><h4><a id="直接计算" href="#直接计算" class="headerlink" title="直接计算"></a>直接计算</h4><p>根据行列式的公式，易得</p><ol><li>对方阵做行（列）交换，行列式反号；</li><li>对方阵做行（列）数乘，行列式乘上同样的常数。</li><li>对方阵做行（列）加法，行列式不变；</li><li>对于上（下）三角矩阵，其行列式为主对角线上元素的积。</li></ol><p>因此可以简单地使用高斯消元在<script type="math/tex">O(n^3)</script>的时间内求出行列式。</p><h4><a id="拆行列式" href="#拆行列式" class="headerlink" title="拆行列式"></a>拆行列式</h4><p>行列式按行拆开：设<script type="math/tex">a_{ki}=b_i+c_i</script>，那么有</p><script type="math/tex;mode=display">|A|=
\left|\begin{matrix}
a_{11} & a_{12} & \cdots & a_{1n}\\
\vdots & \vdots & \ddots & \vdots\\
a_{k1} & a_{k2} & \cdots & a_{kn}\\
\vdots & \vdots & \ddots & \vdots\\
a_{n1} & a_{n2} & \cdots & a_{nn}
\end{matrix}\right|
=
\left|\begin{matrix}
a_{11} & a_{12} & \cdots & a_{1n}\\
\vdots & \vdots & \ddots & \vdots\\
b_{1} & b_{2} & \cdots & b_{n}\\
\vdots & \vdots & \ddots & \vdots\\
a_{n1} & a_{n2} & \cdots & a_{nn}
\end{matrix}\right|
+
\left|\begin{matrix}
a_{11} & a_{12} & \cdots & a_{1n}\\
\vdots & \vdots & \ddots & \vdots\\
c_{1} & c_{2} & \cdots & c_{n}\\
\vdots & \vdots & \ddots & \vdots\\
a_{n1} & a_{n2} & \cdots & a_{nn}
\end{matrix}\right|</script><p>按列拆开同理。</p><h4><a id="余子式与伴随矩阵" href="#余子式与伴随矩阵" class="headerlink" title="余子式与伴随矩阵"></a>余子式与伴随矩阵</h4><p><strong>余子式</strong>：对于矩阵<script type="math/tex">A</script>，<script type="math/tex">A_{ij}</script>的余子式<script type="math/tex">M_{ij}</script>定义为<script type="math/tex">A</script>去掉第<script type="math/tex">i</script>行第<script type="math/tex">j</script>列的矩阵的行列式。</p><p><strong>代数余子式</strong>：对于矩阵<script type="math/tex">A</script>，<script type="math/tex">A_{ij}</script>的代数余子式<script type="math/tex">C_{ij}=(-1)^{i+j}M_{ij}</script>。</p><p>代数余子式求行列式：<script type="math/tex">\forall k,|A|=\sum_{i=1}^nA_{ki}C_{ki}</script>。</p><p><strong>余子矩阵</strong>：代数余子式构成的矩阵<script type="math/tex">C=[C_{ij}]</script>。</p><p><strong>伴随矩阵</strong>：<script type="math/tex">A</script>的伴随矩阵定义为<script type="math/tex">A</script>的余子矩阵的转置，即<script type="math/tex">C^T</script>，记为<script type="math/tex">\operatorname{adj}(A)</script>。</p><p>伴随矩阵关于逆矩阵的性质：如果<script type="math/tex">A</script>可逆，那么<script type="math/tex">\operatorname{adj}(A^{-1})=\operatorname{adj}(A)^{-1}=\dfrac{A}{|A|}</script>。</p><h4><a id="其他环上行列式的计算" href="#其他环上行列式的计算" class="headerlink" title="其他环上行列式的计算"></a>其他环上行列式的计算</h4><p>对于环<script type="math/tex">(\oplus, \otimes)</script>上的<script type="math/tex">n</script>阶方矩阵<script type="math/tex">M</script>，其行列式记作</p><script type="math/tex;mode=display">|M|=\bigoplus_{p\in P_n}\operatorname{sgn}(p)\bigotimes_{i=1}^nA_{i,p_i}</script><p>那么对于这种矩阵的高斯消元，要点是：消成<script type="math/tex">\oplus</script>对应的单位元。</p><p>可以类比加法乘法环的高斯消元，把除法换成求逆之类的。</p><h2><a id="矩阵特征值与特征多项式" href="#矩阵特征值与特征多项式" class="headerlink" title="矩阵特征值与特征多项式"></a>矩阵特征值与特征多项式</h2><h3><a id="特征值与特征向量" href="#特征值与特征向量" class="headerlink" title="特征值与特征向量"></a>特征值与特征向量</h3><p>对于矩阵<script type="math/tex">A_{n\times n}</script>，若存在向量<script type="math/tex">\mathbf{v}_{n}</script>和标量<script type="math/tex">\lambda</script>满足</p><script type="math/tex;mode=display">\begin{bmatrix}
A_{11} & A_{12} & \cdots & A_{1n}\\
A_{21} & A_{22} & \cdots & A_{2n}\\
\vdots & \vdots & \ddots & \vdots \\
A_{n1} & A_{n2} & \cdots & A_{nn}\\
\end{bmatrix}
\begin{bmatrix}
v_{1}\\
v_{2}\\
\vdots \\
v_{n}\\
\end{bmatrix}
=
\begin{bmatrix}
\lambda v_{1}\\
\lambda v_{2}\\
\vdots \\
\lambda v_{n}\\
\end{bmatrix}</script><p>即</p><script type="math/tex;mode=display">A\mathbf{v}=\lambda\mathbf{v}</script><p>则称<script type="math/tex">\mathbf{v}</script>是矩阵<script type="math/tex">A</script>的<strong>特征向量（Eigenvector）</strong>，且<script type="math/tex">\lambda</script>是<script type="math/tex">\mathbf{v}</script>对应的<strong>特征值（Eigenvalue, or characteristic root）</strong>。</p><p>上面的等式可以等价地写作</p><script type="math/tex;mode=display">(\lambda I-A)\mathbf{v}=0</script><h3><a id="特征多项式" href="#特征多项式" class="headerlink" title="特征多项式"></a>特征多项式</h3><p>若<script type="math/tex">\mathbf{v}</script>不是零向量，则<script type="math/tex">(\lambda I-A)\mathbf{v}=0</script>的充要条件是<script type="math/tex">|\lambda I-A|=0</script>。而<script type="math/tex">|\lambda I-A|</script>可以表示为<script type="math/tex">\lambda</script>的一个多项式。</p><p>根据行列式的计算公式，易知<script type="math/tex">|\lambda I-A|</script>是一个<script type="math/tex">n</script>次多项式。那么不妨设它的<script type="math/tex">n</script>个零点为<script type="math/tex">\lambda_1,\lambda_2,\cdots,\lambda_n</script>，则<script type="math/tex">A</script>的<strong>特征多项式（Characteristic polynomial）</strong>为</p><script type="math/tex;mode=display">p_A(\lambda)=|\lambda I-A|=\begin{vmatrix}
\lambda-A_{11} & -A_{12} & \cdots & -A_{1n}\\
-A_{21} & \lambda- A_{22} & \cdots & -A_{2n}\\
\vdots & \vdots & \ddots & \vdots \\
-A_{n1} & -A_{n2} & \cdots & \lambda - A_{2n}
\end{vmatrix}=(\lambda - \lambda _1)(\lambda - \lambda _2)\cdots (\lambda - \lambda _n)</script><p>不妨设<script type="math/tex">p_A(\lambda)=f_0+f_1\lambda+\cdots + f_n\lambda^n</script>。</p><p>根据特征多项式的定义，易得</p><ol><li><script type="math/tex">f_n=1</script>；</li><li><script type="math/tex">f_0=(-1)^n\prod_{i=1}^n \lambda_i</script>；</li></ol><h3><a id="特征多项式的计算" href="#特征多项式的计算" class="headerlink" title="特征多项式的计算"></a>特征多项式的计算</h3><p>首先，你可以通过对<script type="math/tex">(\lambda I-A)</script>高斯消元来求特征多项式，但你不能对<script type="math/tex">A</script>高斯消元后再求<script type="math/tex">A</script>的特征多项式，两者是不同的。</p><p>根据相似矩阵性质，我们知道与<script type="math/tex">A</script>相似的矩阵的特征多项式是相同的。而上三角矩阵的特征多项式是很容易计算的（主对角线上的元素相乘）。因此我们可以尝试把<script type="math/tex">A</script>化为与其相似的上三角矩阵。遗憾地是，这样的变换复杂度没有保证。不过，我们有一个类似上三角矩阵的矩阵，叫作上海森堡矩阵。而我们可以快速将<script type="math/tex">A</script>变换为与其相似的上海森堡矩阵，然后求出上海森堡矩阵的特征多项式，也就得到了<script type="math/tex">A</script>的特征多项式。</p><h4><a id="上海森堡矩阵" href="#上海森堡矩阵" class="headerlink" title="上海森堡矩阵"></a>上海森堡矩阵</h4><p>定义<strong>上海森堡矩阵（Upper Hessenberg Matrix）</strong>为方阵<script type="math/tex">A_{n\times n}</script>满足<script type="math/tex">\forall 1\le j&lt;i\le n,A_{ij}=0</script>。即</p><script type="math/tex;mode=display">\begin{bmatrix}
A_{11} & A_{12} & A_{13} & \cdots & A_{1n}\\
A_{21} & A_{22} & A_{23} &  \cdots & A_{2n}\\
0 & A_{32} & A_{33} & \cdots & A_{3n}\\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & A_{nn}\\
\end{bmatrix}</script><p>也就是说主对角线下面的一条对角线也可能非 0。</p><p>如何将<script type="math/tex">A</script>化为与其相似的上海森堡矩阵？考虑消元。</p><p><img src="../../../images/linear-algbra-1.png" alt="p1"></p><p>如图：</p><ol><li>绿色表示非<script type="math/tex">0</script>元素；</li><li>蓝色表示我们当前考虑的元素<script type="math/tex">(i,j)(i&gt;j)</script>；</li><li>黄色表示发生变化的元素（不确定是<script type="math/tex">0</script>还是非<script type="math/tex">0</script>）。</li></ol><p>左图是我们目前的矩阵的状态。我们想将<script type="math/tex">(i,j)</script>下方的非零元素消掉。首先若<script type="math/tex">A_{ij}</script>是<script type="math/tex">0</script>，我们就要找下方第<script type="math/tex">j</script>列非<script type="math/tex">0</script>的元素与之替换（如果找不到就不用消元了）。</p><p>图 A：假设我们找到了<script type="math/tex">A_{kj}\ne 0(k&gt;i)</script>，那么我们就需要做<script type="math/tex">R_i\leftrightarrow R_k</script>的操作。而为了保证操作后的矩阵与<script type="math/tex">A</script><strong>相似</strong>，我们需要在右边乘上它的逆矩阵。而<script type="math/tex">R_i\leftrightarrow R_k</script>对应的矩阵的<strong>逆矩阵是其本身</strong>。右边乘上<script type="math/tex">R_i\leftrightarrow R_k</script>对应的矩阵，实际上就是做<script type="math/tex">C_i\leftrightarrow C_k</script>的操作。因此在图 A 中我们进行了行交换和列交换。</p><p>图 B 是我们把<script type="math/tex">A_{ij}</script>置为非零元素后的状态。</p><p>图 C：接下来进行消元。我们相当于做若干次行加法操作。同样的为了保证操作后的<strong>相似</strong>，我们需要右乘行加法操作的逆矩阵。而<strong>行加法操作的逆矩阵</strong>就是将<script type="math/tex">k</script>反号后的行加法矩阵（把它减回去）。放到右边乘就对应了<strong>列加法</strong>的矩阵。因此在图 C 中我们进行了行加法和列加法操作。（同时列加法操作没有影响到第<script type="math/tex">j</script>列。如果你想使用这个算法消成上三角矩阵，那么就会有影响）。</p><p>图 D 就是消元后的矩阵，并展示了哪些元素受到影响。</p><p>算法的伪代码描述为</p><script type="math/tex;mode=display">\begin{array}{r|l}
\hline
1 & \textbf{Input: }\text{Matrix }A\in\mathbf{Z}_p^{n\times n}\\
2 & \textbf{Output: }\text{Matrix }A\text{ in upper Hessenberg form with the same eigenvalues}\\
\\
3 & \textbf{for }j=1\textbf{ to }n-2\textbf{ do}\\
4 & \qquad \text{search for a nonzero entry }A_{i,j}\text{ where }j+1&lt;i\le n\\
4 & \qquad \textbf{if}\text{ found such entry }\textbf{then}\\
5 & \qquad \qquad \textbf{do }R_i\leftrightarrow R_{j+1} \text{ and }C_i\leftrightarrow C_{j+1} \textbf{ if }A_{j+1,j}=0\\
6 & \qquad \qquad \textbf{for }k=j+2\textbf{ to }n\textbf{ do}\\
7 & \qquad \qquad \qquad \textbf{comment }\text{reduce using }A_{j+1,j}\text{ as pivot}\\
8 & \qquad \qquad \qquad u\gets A_{k,j}A_{j+1,j}^{-1}\\
9 & \qquad \qquad \qquad R_k \gets R_k-uR_{j+1}\\
10 & \qquad \qquad \qquad C_{j+1} \gets C_{j+1}+uC_{k}\\
11 & \qquad \qquad \textbf{end for} \\
12 & \qquad \textbf{end if}\\
13 & \qquad \textbf{comment }\text{now the first }j\text{ columns of }A\text{ is in upper Hessenberg form}\\
14 & \textbf{end for} \\
\hline
\end{array}</script><p>时间复杂度<script type="math/tex">O(n^3)</script>。</p><h4><a id="上海森堡矩阵的行列式" href="#上海森堡矩阵的行列式" class="headerlink" title="上海森堡矩阵的行列式"></a>上海森堡矩阵的行列式</h4><p>显然，若<script type="math/tex">A</script>是上海森堡矩阵，则<script type="math/tex">(\lambda I-A)</script>也是上海森堡矩阵。因此我们只需要能快速求出上海森堡矩阵的行列式即可。</p><p>不妨考虑我将<script type="math/tex">A</script>的行列式按第一列展开。因为第一列只有两个非<script type="math/tex">0</script>元素：</p><p><img src="../../../images/linear-algbra-2.png" alt="p1"></p><p>设<script type="math/tex">p_i</script>表示第<script type="math/tex">i</script>到第<script type="math/tex">n</script>行，第<script type="math/tex">i</script>列到第<script type="math/tex">n</script>列的子矩阵的行列式。考虑求<script type="math/tex">p_1</script>。那么我们按第<script type="math/tex">1</script>列展开，就得到<script type="math/tex">p_1=A_{11}p_2-A_{21}|\text{red}|</script>。而<script type="math/tex">\text{red}</script>子矩阵的行列式也可以按列展开！于是<script type="math/tex">|\text{red}|=A_{12}p_3-A_{32}|\text{pink}|</script>。那么可以继续这样展开下去。这样就可以求出<script type="math/tex">p_1</script>也就是原矩阵的行列式了。实现的时候倒着做一次循环就行了。</p><p>复杂度也是<script type="math/tex">O(n^3)</script>的，因为多项式长度是<script type="math/tex">O(n)</script>的。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/mb/characteristic_polynomial.cpp">代码</a></p><h3><a id="哈密尔顿-凯莱定理" href="#哈密尔顿-凯莱定理" class="headerlink" title="哈密尔顿 - 凯莱定理"></a>哈密尔顿 - 凯莱定理</h3><p>哈密尔顿–凯莱定理（Cayley–Hamilton theorem）：对于矩阵<script type="math/tex">A</script>的特征多项式<script type="math/tex">f(\lambda)</script>，有<script type="math/tex">f(A)=O</script>。这里的<script type="math/tex">f(A)</script>表示说把多项式放在矩阵环的意义下进行，<script type="math/tex">O</script>表示全<script type="math/tex">0</script>矩阵，常数项<script type="math/tex">a_0</script>可以理解为<script type="math/tex">a_0I</script>，<script type="math/tex">I</script>是单位矩阵。</p><h2><a id="常系数齐次线性递推" href="#常系数齐次线性递推" class="headerlink" title="常系数齐次线性递推"></a>常系数齐次线性递推</h2><blockquote><p>给出<script type="math/tex">x_0,\cdots,x_{k-1}</script>和<script type="math/tex">c_1,c_2,\cdots,c_k</script>，且定义递推式</p><script type="math/tex;mode=display">x_n=c_1x_{n-1}+\cdots + c_kx_{n-k}</script><p>求<script type="math/tex">x_n</script>。</p></blockquote><h3><a id="思路一" href="#思路一" class="headerlink" title="思路一"></a>思路一</h3><p>首先我们可以用矩阵乘法的形式描述这个过程：</p><script type="math/tex;mode=display">\begin{bmatrix}
x_n\\
x_{n-1}\\
\vdots\\
x_{n-k+2}\\
x_{n-k+1}
\end{bmatrix}
=A\begin{bmatrix}
x_{n-1}\\
x_{n-2}\\
\vdots\\
x_{n-k+1}\\
x_{n-k}
\end{bmatrix}=
\begin{bmatrix}
c_1 & c_2 &\cdots & c_{k-1} &c_k\\
1 & 0 &\cdots  & 0 & 0\\
\vdots & \vdots & \ddots & \vdots & \vdots \\
0 & 0 &\cdots  & 0 & 0\\
0 & 0 &\cdots  & 1 & 0\\
\end{bmatrix}
\begin{bmatrix}
x_{n-1}\\
x_{n-2}\\
\vdots\\
x_{n-k+1}\\
x_{n-k}
\end{bmatrix}</script><p>设<script type="math/tex">V_n=[x_{n+k-1},x_{n+k-2},\cdots,x_{n+1},x_{n}]^T</script>。上式可以等价地表示为<script type="math/tex">V_n=AV_{n-1}</script>。</p><p>那么初始向量为<script type="math/tex">V_0=[x_{k-1},x_{k-2},\cdots,x_0]^T</script>。显然我们求出<script type="math/tex">V_n=A^nV_0</script>，这样也就求出<script type="math/tex">x_n</script>了。</p><p>直接做矩阵乘法，用矩阵快速幂的复杂度是<script type="math/tex">O(k^3\log_2n)</script>的。</p><p>考虑到这里的 A 是一个 Frobenius matrix。可以得到它的特征多项式</p><script type="math/tex;mode=display">\begin{aligned}
f(x)&=|xI-A|\\
&=x^k-c_1x^{k-1}-c_2x^{k-2}-\cdots - c_{k-1}x-c_k
\end{aligned}</script><p>根据 Hamilton Cayley Theorem，有<script type="math/tex">f(A)=0</script>。考虑计算<script type="math/tex">A^n</script>。</p><p>从多项式的角度理解，我们可以把<script type="math/tex">A^n</script>表示为<script type="math/tex">f(A)Q(A)+R(A)</script>的形式，其中<script type="math/tex">\deg R&lt;\deg f</script>。即<script type="math/tex">R(x)=x^n\bmod f(x)</script>。而由于<script type="math/tex">f(A)=0</script>，因此可以得到<script type="math/tex">A^n=R(A)</script>。我们可以直接快速幂，把取模的部分改成多项式取模而在<script type="math/tex">O(k^2\log_2n)</script>或者<script type="math/tex">O(k\log_2k\log_2n)</script>的时间内求出<script type="math/tex">R(x)</script>。求出来之后，设</p><script type="math/tex;mode=display">R(x)=\sum_{i=0}^{k-1}r_ix^i</script><p>则</p><script type="math/tex;mode=display">V_n=A^{n}V_0=\sum_{i=0}^{k-1}r_iA^iV_0=\sum_{i=0}^{k-1}r_iV_i</script><p>由于我们并不需要求出整个向量，我们只需要求出<script type="math/tex">V_i</script>的最后一项。而<script type="math/tex">V_0,\cdots,V_{k-1}</script>的最后一项恰好对应<script type="math/tex">x_1,\cdots,x_k</script>，因此直接代入上式即可。</p><p>这样的复杂度是<script type="math/tex">O(k^2\log_2n)</script>或者<script type="math/tex">O(k\log_2k\log_2n)</script>的。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/luogu/4723.cpp">Luogu4723 代码</a></p><h3><a id="思路二" href="#思路二" class="headerlink" title="思路二"></a>思路二</h3><p>实际上我们有更简单的理解方式。</p><p>因为<script type="math/tex">x_n=c_1x_{n-1}+\cdots + c_kx_{n-k}</script>，那么我们继续把<script type="math/tex">x_{n-1}</script>写成<script type="math/tex">\sum c_ix_{n-1-i}</script>的形式，然后把<script type="math/tex">x_{n-2}</script>写成<script type="math/tex">\sum c_ix_{n-2-i}</script>的形式，这样一直下去，就可以把<script type="math/tex">x_n</script>写成关于<script type="math/tex">x_0,\cdots,x_{k-1}</script>的答案。</p><p>把这个过程写成一个代码，就是多项式取模的形式。</p><h2><a id="参考文献" href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%9F%A9%E9%98%B5">维基百科 - 矩阵</a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%A1%8C%E5%88%97%E5%BC%8F">维基百科 - 行列式</a></p><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Elementary_matrix">维基百科 - 初等矩阵</a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%9B%B8%E4%BC%BC%E7%9F%A9%E9%99%A3">维基百科 - 相似矩阵</a></p><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors#math_1">维基百科 - 特征值与特征向量</a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%87%B1%E8%90%8A%E2%80%93%E5%93%88%E5%AF%86%E9%A0%93%E5%AE%9A%E7%90%86">维基百科 - 哈密尔顿凯莱定理</a></p><h2><a id="拓展资料" href="#拓展资料" class="headerlink" title="拓展资料"></a>拓展资料</h2><p><a target="_blank" rel="noopener" href="http://math.mit.edu/~levine/18.312/alg-comb-lecture-19.pdf">Matrix-Tree Theorem 1</a></p><p><a target="_blank" rel="noopener" href="https://ocw.mit.edu/courses/mathematics/18-314-combinatorial-analysis-fall-2014/readings/MIT18_314F14_mt.pdf">Matrix-Tree Theorem 2</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/108209378">Matrix-Tree Theorem 3</a></p><p><a target="_blank" rel="noopener" href="https://www.wolframalpha.com">WolframAlpha Determinant Resultant</a> <a target="_blank" rel="noopener" href="https://reference.wolfram.com/language/ref/Det.html">reference</a></p><p><a target="_blank" rel="noopener" href="https://reference.wolfram.com/language/ref/CharacteristicPolynomial.html">Wolfram characteristic polynomial reference</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2020年12月29日 第2次修订</li><li class="post-history-item">2020年5月6日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Boboniu-Round/">Boboniu Round 花絮</a></div><div class="prev-post"><a href="/String/KMP/">KMP 应用 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>