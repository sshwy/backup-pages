<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>普通生成函数学习笔记 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">普通生成函数学习笔记</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年1月26日星期二晚上9点24分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年1月26日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 1,697 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/Polynomial/">多项式与生成函数 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/OGF/">OGF</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#普通生成函数"><span class="toc-number">1.</span> <span class="toc-text">普通生成函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#牛顿二项式定理"><span class="toc-number">2.</span> <span class="toc-text">牛顿二项式定理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#卡特兰数的生成函数"><span class="toc-number">3.</span> <span class="toc-text">卡特兰数的生成函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#第一部分"><span class="toc-number">3.1.</span> <span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二部分"><span class="toc-number">3.2.</span> <span class="toc-text">第二部分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#例题"><span class="toc-number">4.</span> <span class="toc-text">例题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#食物"><span class="toc-number">4.1.</span> <span class="toc-text">食物</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sweet"><span class="toc-number">4.2.</span> <span class="toc-text">Sweet</span></a></li></ol></li></ol></div><hr></div><div class="post-content"><h2><a id="普通生成函数" href="#普通生成函数" class="headerlink" title="普通生成函数"></a>普通生成函数</h2><p>序列<script type="math/tex">a_i</script>的普通生成函数（Ordinary generating function，OGF）：</p><script type="math/tex;mode=display">F(x)=\sum_{i\ge 0}a_ix^i</script><p>举个例子，等比数列的生成函数为</p><script type="math/tex;mode=display">\sum_{i\ge 0}x^i=\frac{1}{1-x}\\
\sum_{i\ge 0}a^ix^i=\frac{1}{1-ax}\\</script><p>这也是 OGF 的常用封闭形式。</p><h2><a id="牛顿二项式定理" href="#牛顿二项式定理" class="headerlink" title="牛顿二项式定理"></a>牛顿二项式定理</h2><p>首先我们定义组合数的计算：</p><script type="math/tex;mode=display">\binom{r}{k}=\frac{r^{\underline{k}}}{k!}(r\in \mathbb{C},k\in \mathbb{N})</script><p>其中<script type="math/tex">r^{\underline{k}} = r(r-1)(r-2)\cdots(r-k+1)</script>，<script type="math/tex">r^{\underline{0}} = 1</script>。<script type="math/tex">k!</script>是阶乘。</p><p>这样就可以扩展二项式定义为</p><script type="math/tex;mode=display">(1+x)^\alpha=\sum_{k\ge 0}\binom{\alpha}{k}x^{k}</script><h2><a id="卡特兰数的生成函数" href="#卡特兰数的生成函数" class="headerlink" title="卡特兰数的生成函数"></a>卡特兰数的生成函数</h2><p>考虑卡特兰数的递推式</p><script type="math/tex;mode=display">h(i)=\sum_{j=0}^{i-1}h(j)h(i-j-1)</script><h3><a id="第一部分" href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h3><p>其生成函数定义为</p><script type="math/tex;mode=display">\begin{aligned}
C(x)&=\sum_{i\ge 0}h(i)x^i\\
&=1+\sum_{i\ge 1}\sum_{j=0}^{i-1}h(j)x^jh(i-j-1)x^{i-j-1}x\\
&=1+x\sum_{j\ge 0}h(j)x^j\sum_{i\ge 0}h(i)x^{i}\\
&=1+xC^2(x)
\end{aligned}</script><p>那么解方程得到</p><script type="math/tex;mode=display">C(x)=\frac{1\pm \sqrt{1-4x}}{2x}=\frac{2}{1\mp\sqrt{1-4x}}</script><p>因为<script type="math/tex">\lim_{x \to 0}\frac{2}{1+\sqrt{1-4x}}=\frac{2}{1+\sqrt{1}}=1=h(0)</script>，所以</p><script type="math/tex;mode=display">C(x)=\frac{1-\sqrt{1-4x}}{2x}</script><h3><a id="第二部分" href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h3><p>接下来我们将它展开为无穷级数。</p><script type="math/tex;mode=display">\begin{aligned}
(1-4x)^{\frac{1}{2}}&=\sum_{i\ge 0}\binom{\frac{1}{2}}{i}(-4x)^i\\
&=1+\sum_{i\ge 1}\frac{\left(\frac{1}{2}\right)^{\underline{i}}}{i!}(-4x)^i
\end{aligned}
\tag{1}</script><p>化简下降幂的分式：</p><script type="math/tex;mode=display">\frac{\left(\frac{1}{2}\right)^{\underline{i}}}{i!}=(-1)^{i-1}\frac{1}{2^i}\frac{(2i-3)!!}{i!} \tag{2}</script><p>化简双阶乘：</p><script type="math/tex;mode=display">(2i-3)!!=\frac{(2i-2)!}{(2i-2)(2i-4)\cdots 2}=\frac{(2i-2)!}{2^{i-1} (i-1)!}</script><p>于是<script type="math/tex">(2)</script>就变为</p><script type="math/tex;mode=display">\frac{\left(\frac{1}{2}\right)^{\underline{i}}}{i!}=(-1)^{i-1}\frac{1}{2^{2i-1}}\frac{(2i-2)!}{(i-1)!i!} \tag{3}</script><p>把<script type="math/tex">(3)</script>带回<script type="math/tex">(1)</script>得到</p><script type="math/tex;mode=display">\begin{aligned}
(1-4x)^{\frac{1}{2}} &= 1+\sum_{i\ge 1}\frac{\left(\frac{1}{2}\right)^{\underline{i}}}{i!}(-4x)^i \\
&= 1-\sum_{i\ge 1}2\frac{(2i-2)!}{(i-1)!i!}x^i
\end{aligned}
\tag{4}</script><p>把<script type="math/tex">(4)</script>带回原式得到</p><script type="math/tex;mode=display">\begin{aligned}
C(x)&=\sum_{i\ge 1}\frac{(2i-2)!}{(i-1)!i!}x^{i-1}\\
&=\sum_{i\ge 0}\frac{(2i)!}{i!(i+1)!}x^{i}\\
&=\sum_{i\ge 0}\frac{1}{i+1}\binom{2i}{i}x^{i}
\end{aligned}</script><h2><a id="例题" href="#例题" class="headerlink" title="例题"></a>例题</h2><h3><a id="食物" href="#食物" class="headerlink" title="食物"></a><a target="_blank" rel="noopener" href="https://darkbzoj.tk/problem/3028">食物</a></h3><p>生成函数依次写成</p><script type="math/tex;mode=display">\frac{1}{1-x^2}(1+x)\frac{1-x^3}{1-x}\frac{x}{1-x^2}\frac{1}{1-x^4}\frac{1-x^4}{1-x}(1+x)\frac{1}{1-x^3}</script><p>化简得到</p><script type="math/tex;mode=display">\frac{x}{(1-x)^4}</script><p>根据牛顿二项式定理得到</p><script type="math/tex;mode=display">\begin{aligned}
(1-x)^{-4}&=\sum_{i\ge 0}\binom{-4}{i}(-x)^i\\
&=\sum_{i\ge 0}\binom{4+i-1}{i}x^i
\end{aligned}</script><p>那么带回原式得到</p><script type="math/tex;mode=display">\begin{aligned}
\frac{x}{(1-x)^4}&=\sum_{i\ge 0}\binom{3+i}{i}x^{i+1}\\
&=\sum_{i\ge 0}\binom{3+i}{3}x^{i+1}\\
&=\sum_{i\ge 1}\binom{2+i}{3}x^i
\end{aligned}</script><h3><a id="Sweet" href="#Sweet" class="headerlink" title="Sweet"></a><a target="_blank" rel="noopener" href="https://darkbzoj.tk/problem/3027">Sweet</a></h3><p>生成函数为</p><script type="math/tex;mode=display">\begin{aligned}
\prod_{i=1}^n\left(\sum_{j=0}^{m_i}x^j\right) &= \prod_{i=1}^n\frac{1-x^{m_i+1}}{1-x}\\
&=(1-x)^{-n}\prod_{i=1}^n(1-x^{m_i+1})\\
\end{aligned}</script><p>根据牛顿二项式定理得到</p><script type="math/tex;mode=display">(1-x)^{-n}=\sum_{i\ge 0}\binom{n+i-1}{i}x^i</script><p>我们暴力展开后面的多项式，最多只有<script type="math/tex">2^n</script>项。考虑每一项对答案的贡献，发现<script type="math/tex">c_ix^i</script>的贡献是</p><script type="math/tex;mode=display">c_i\sum_{j=a-i}^{b-i}\binom{n+j-1}{n-1}</script><p>这样就做完了。</p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年1月26日 第2次修订</li><li class="post-history-item">2020年5月28日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Graph/Flow-and-2-SAT/">最小割问题中的 2-SAT 思维</a></div><div class="prev-post"><a href="/Data-Structure/Fenwick/">树状数组全讲 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>