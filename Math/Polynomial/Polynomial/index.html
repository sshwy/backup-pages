<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>多项式入门 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">多项式入门</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年3月31日星期三下午3点11分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年3月31日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 2,969 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/Polynomial/">多项式与生成函数 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Polynomial/">Polynomial</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#常见导数"><span class="toc-number">1.</span> <span class="toc-text">常见导数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式积分"><span class="toc-number">2.</span> <span class="toc-text">多项式积分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#泰勒展开"><span class="toc-number">3.</span> <span class="toc-text">泰勒展开</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式牛顿迭代"><span class="toc-number">4.</span> <span class="toc-text">多项式牛顿迭代</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#牛迭与多项式牛迭"><span class="toc-number">4.1.</span> <span class="toc-text">牛迭与多项式牛迭</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式求逆"><span class="toc-number">5.</span> <span class="toc-text">多项式求逆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式开方"><span class="toc-number">6.</span> <span class="toc-text">多项式开方</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式对数"><span class="toc-number">7.</span> <span class="toc-text">多项式对数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式指数"><span class="toc-number">8.</span> <span class="toc-text">多项式指数</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="常见导数" href="#常见导数" class="headerlink" title="常见导数"></a>常见导数</h2><p>首先铺垫一些基本函数的导数<sup><a id="reffn_3" class="headerlink" title="3"></a><a href="#fn_3">3</a></sup>：</p><script type="math/tex;mode=display">\begin{aligned}
(x^n)' &= nx^{n-1}\\
|x|' &= \operatorname{sgn}x\\
(e^x)' &= e^x\\
(a^x)' &= e^{x\ln a}\ln a\\
(\ln x)' &= \frac{1}{x}\\
(f^n(x))' &= nf'(x)(f^{n-1}(x))
\end{aligned}</script><h2><a id="多项式积分" href="#多项式积分" class="headerlink" title="多项式积分"></a>多项式积分</h2><script type="math/tex;mode=display">\int F(x)\text{d}x=\int\sum_{i\ge 0}a_ix^i\text{d}x=\sum_{i\ge 1}\frac{a_{i-1}}{i}x^i</script><h2><a id="泰勒展开" href="#泰勒展开" class="headerlink" title="泰勒展开"></a>泰勒展开</h2><p>泰勒展开可以将一个函数表示为无穷级数，也称为泰勒级数（Taylor Series）<sup><a id="reffn_1" class="headerlink" title="1"></a><a href="#fn_1">1</a></sup>：</p><script type="math/tex;mode=display">f(x)=\sum_{n\ge 0}\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n</script><p>其中比较常用的是<script type="math/tex">f(x)</script>在<script type="math/tex">x_0=0</script>处的展开，也称麦克劳林展开：</p><script type="math/tex;mode=display">f(x)=\sum_{n\ge 0}\frac{f^{(n)}(0)}{n!}x^n</script><h2><a id="多项式牛顿迭代" href="#多项式牛顿迭代" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>牛顿迭代法本用于逼近方程的根，而多项式牛顿迭代<sup><a id="reffn_2" class="headerlink" title="2"></a><a href="#fn_2">2</a></sup>则指在多项式环上求出模<script type="math/tex">x^n</script>意义下的根。实际上<script type="math/tex">n</script>越大那么求出的根越接近真实的根，这与牛顿迭代法是类似的。</p><p>已知函数<script type="math/tex">G</script>，求多项式<script type="math/tex">F</script>，使得</p><script type="math/tex;mode=display">G(F(x))=0\pmod{x^n}</script><p>考虑倍增。假设我们求出了<script type="math/tex">F_0</script>使得<script type="math/tex">G(F_0(x))=0\pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}</script>。</p><p>首先注意到<script type="math/tex">G(F(x))=0\pmod{x^{\left\lceil\frac{n}{2}\right\rceil}}</script>，因此<script type="math/tex">F\bmod x^{\left\lceil\frac{n}{2}\right\rceil}=F_0</script>，即他们的低位是一样的。</p><p>考虑将<script type="math/tex">G(F(x))</script>在<script type="math/tex">F_0(x)</script>处泰勒展开：</p><script type="math/tex;mode=display">G(F(x))=\sum_{i\ge 0}\frac{G^{(i)}(F_0(x))}{i!}(F(x)-F_0(x))^i\pmod{x^n}</script><p>注意到<script type="math/tex">F(x)-F_0(x)</script>把低位都减没了。<script type="math/tex">(F(x)-F_0(x))^2</script>的最低次数项的次数都是<script type="math/tex">x^n</script>，因此可以直接忽略了。即</p><script type="math/tex;mode=display">G(F(x))=G(F_0(x)) + G^{'}(F_0(x))(F(x)-F_0(x))\pmod{x^n}</script><p>因为<script type="math/tex">G(F(x))=0</script>，化简得到</p><script type="math/tex;mode=display">F(x)=F_0(x)-\frac{G(F_0(x))}{G^{'}(F_0(x))}  \pmod{x^n}</script><p>也可以简记为</p><script type="math/tex;mode=display">F=F_0-\frac{G\circ F_0}{G'\circ F_0}\pmod{x^n}</script><h3><a id="牛迭与多项式牛迭" href="#牛迭与多项式牛迭" class="headerlink" title="牛迭与多项式牛迭"></a>牛迭与多项式牛迭</h3><p>接触过牛顿迭代的读者会知道，对于一个连续且单调的函数<script type="math/tex">f(x)</script>，我们要求<script type="math/tex">f(x)=0</script>的近似解，则迭代的公式为</p><script type="math/tex;mode=display">x_i=x_{i-1}-\frac{f(x_{i-1})}{f'(x_{i-1})}</script><p>牛顿迭代可以直观理解：如果当前位置的点值和导数点值同号，说明在根的右边；否则说明在根的左边。</p><p>那么多项式牛顿迭代又怎么直观理解呢？</p><p>多项式环是没有数轴的说法的。不过我们可以把它看作是向一个多项式逼近的过程，就像泰勒展开一样。<script type="math/tex">F_0</script>变成<script type="math/tex">F</script>，代入<script type="math/tex">0&lt;x&lt;1</script>，它的增量是不断变小（收敛）的。如果<script type="math/tex">x&gt;1</script>的话是发散的，这不在我们讨论的范围中。也就是说在<script type="math/tex">0&lt;x&lt;1</script>的时候，多项式的高次项对点值的影响就越小。因此倍增牛迭可以理解为是添加高次项来逼近多项式。</p><p>接下来我们来看一下多项式牛顿迭代的应用。</p><h2><a id="多项式求逆" href="#多项式求逆" class="headerlink" title="多项式求逆"></a>多项式求逆</h2><p>求模意义下多项式的逆。形式化地说：对于多项式<script type="math/tex">H(x)</script>，求出<script type="math/tex">F(x)</script>使得<script type="math/tex">F(x) H(x) = 1 \pmod {x^n}</script>。</p><p>首先介绍<script type="math/tex">O(n^2)</script>求逆的算法。</p><p>设<script type="math/tex">H(x) = \sum_{i\ge 0} h_ix^i</script>，<script type="math/tex">F(x) = \sum_{i\ge 0}f_i x^i</script>。</p><p>那么<script type="math/tex">f_0 = \frac{1}{h_0}</script>。对于<script type="math/tex">i&gt;0</script>，有<script type="math/tex">\sum_{j=0}^i h_j f_{i-j} = 0</script>。即<script type="math/tex">f_i = -\frac{1}{h_0}\sum_{j=1}^i h_j f_{i-j}</script>。这样就可以递推求出<script type="math/tex">F(x)</script>。</p><p>使用牛顿迭代法可以更快。</p><p>设<script type="math/tex">G(F(x)) = \frac{1}{F(x)}-H(x)</script>。</p><p>那么问题转化为了求满足<script type="math/tex">G(F(x))=0\pmod{x^n}</script>的解。应用牛顿迭代得到</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=F_0(x)-\frac{G(F_0(x))}{G'(F_0(x))}\\
&=F_0(x)-\frac{F_0^{-1}(x)-H(x)}{-F_0^{-2}(x)}\\
&=2F_0(x)-H(x)F_0^2(x)
\end{aligned}</script><p>那么使用 FFT/NTT 即可在<script type="math/tex">O(n\log_2n)</script>的时间内计算。</p><h2><a id="多项式开方" href="#多项式开方" class="headerlink" title="多项式开方"></a>多项式开方</h2><p>求<script type="math/tex">h(x)</script>的平方根。即求一个多项式<script type="math/tex">F(x)</script>使得<script type="math/tex">F^2(x) = h(x) \pmod {x^n}</script>。</p><p>与求逆类似，我们仍然可以递推地在<script type="math/tex">O(n^2)</script>时间内求出<script type="math/tex">F(x)</script>。</p><p>仍然考虑多项式牛迭。</p><p>设<script type="math/tex">G(F(x))=F^2(x)-h(x)</script>。应用牛顿迭代得到</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=F_0(x)-\frac{G(F_0(x))}{G'(F_0(x))}\\
&=F_0(x)-\frac{F_0^2(x)-h(x)}{2F_0(x)}\\
&=\frac{F_0^2(x)+h(x)}{2F_0(x)}
\end{aligned}</script><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><h2><a id="多项式对数" href="#多项式对数" class="headerlink" title="多项式对数"></a>多项式对数</h2><p>考虑计算一个多项式的对数函数（ln），记作<script type="math/tex">\ln F(x)</script>。首先我们要了解<script type="math/tex">\ln F(x)</script>的级数形式。</p><p>考虑<script type="math/tex">\ln (1-x)</script>在原点的泰勒展开：</p><script type="math/tex;mode=display">\ln(1-x)=-\sum_{i\ge 1}\frac{x^i}{i}</script><p>这样一来，我们就可以定义<script type="math/tex">\ln (1-F(x))</script>：</p><script type="math/tex;mode=display">\ln(1-F(x))=-\sum_{i\ge 1}\frac{F(x)^i}{i}</script><p>换句话说对于<script type="math/tex">F(0)=1</script>的多项式，我们把它理解为<script type="math/tex">1-F_1(x)</script>的形式，就可以理解为上述定义。</p><p>之所以要求常数项是<script type="math/tex">1</script>，是因为<script type="math/tex">\ln 1 = 0</script>，不用考虑离散对数等等的问题。同时方便我们计算。</p><p>接下来考虑计算求出<script type="math/tex">\ln F(x)\pmod{x^n}</script>。首先做复合函数求导：</p><script type="math/tex;mode=display">(\ln F(x))'=\frac{\text{d}\ln F(x)}{\text{d}x}=\frac{\text{d}\ln F(x)}{\text{d}F(x)}\frac{\text{d}F(x)}{\text{d}x}=\frac{F'(x)}{F(x)}</script><p>两边同时积分得到</p><script type="math/tex;mode=display">\ln F(x)=\int\frac{F'(x)}{F(x)}\text{d}x</script><p>这样就可以用多项式求逆来计算了。这样计算的一个问题是，求导再积分后，常数项就没了。如果<script type="math/tex">F(0)=1</script>就会比较好办，此时<script type="math/tex">\ln F(x)</script>的常数项为<script type="math/tex">0</script>。</p><p>除此之外，我们仍然可以递推求解<script type="math/tex">\ln F(x)</script>。设<script type="math/tex">\ln F(x) = \sum_{i\ge 1} g_i x^i</script>，<script type="math/tex">F(x) = \sum_{i\ge 0}f_i x^i</script>（<script type="math/tex">f_0 = 1</script>）。</p><p>根据<script type="math/tex">(\ln F(x))' F(x) = F'(x)</script>，对于<script type="math/tex">i &gt; 0</script>有<script type="math/tex">\sum_{j=0}^i g_{j+1}(j+1) f_{i-j} = f_{i+1}(i+1)</script>。</p><p>整理一下得到<script type="math/tex">g_i = f_i - \frac{1}{i} \sum_{j = 1} ^ {i-1} j\cdot g_j\cdot f_{i-j}</script>。这样就可以<script type="math/tex">O(n^2)</script>递推了。</p><p>注：</p><script type="math/tex;mode=display">\ln x=\sum_{i\ge 1}\frac{1}{i}\left( \frac{x-1}{x} \right)^i\qquad \forall Re(x)\ge \frac{1}{2}.</script><h2><a id="多项式指数" href="#多项式指数" class="headerlink" title="多项式指数"></a>多项式指数</h2><p>考虑计算一个多项式的指数函数<sup><a id="reffn_4" class="headerlink" title="4"></a><a href="#fn_4">4</a></sup>（exp），记作<script type="math/tex">\exp F(x)</script>或者<script type="math/tex">e^{F(x)}</script>。</p><p>仿照<script type="math/tex">\ln F(x)</script>的定义，我们将<script type="math/tex">\exp x=e^x</script>在原点泰勒展开得到</p><script type="math/tex;mode=display">\exp x=\sum_{i\ge 0}\frac{e^0}{i!}x^i=\sum_{i\ge 0}\frac{x^i}{i!}</script><p>因此可以得到</p><script type="math/tex;mode=display">\exp F(x)=\sum_{i\ge 0}\frac{F^i(x)}{i!}</script><p>考虑求<script type="math/tex">\exp H(x)\pmod {x^n}</script>。设<script type="math/tex">G(F(x))=\ln F(x)-H(x)\pmod{x^n}</script>。应用牛顿迭代得到</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=F_0(x)-\frac{G(F_0(x))}{G'(f_0(x))}\\
&=F_0(x)-\frac{\ln F_0(x)-H(x)}{\frac{1}{F_0(x)}}\\
&=F_0(x)(1-\ln F_0(x)+H(x))
\end{aligned}</script><p>容易发现在<script type="math/tex">H(x)</script>常数项为<script type="math/tex">0</script>时上式是容易计算的。</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p>再考虑递推求解<script type="math/tex">e^{F(x)}</script>。考虑求导：<script type="math/tex">(e^{F(x)})' = e^{F(x)} F'(x)</script>。</p><p>设<script type="math/tex">e^{F(x)} = \sum_{i \ge 0} g_i x^i</script>，<script type="math/tex">F(x) = \sum_{i \ge 0} f_i x^i</script>，那么<script type="math/tex">g_{i+1}(i+1) = \sum_{j=0}^i f_{j+1}(j+1) g_{i-j}</script>。</p><p>整理一下有<script type="math/tex">g_i = \frac{1}{i} \sum_{j=0}^{i-1} f_{j+1}(j+1)g_{i-j-1}</script>（<script type="math/tex">i&gt;0</script>），当<script type="math/tex">f_0 = 0</script>时有<script type="math/tex">g_0 = 1</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/mb/polynomial.cpp">模板代码</a></p><p><a id="fn_1" class="headerlink" title="1"></a><sup>1</sup>. <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Taylor_series">https://en.wikipedia.org/wiki/Taylor_series</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a></p><p><a id="fn_2" class="headerlink" title="2"></a><sup>2</sup>. <a target="_blank" rel="noopener" href="http://blog.miskcoo.com/2015/06/polynomial-with-newton-method#i-4">http://blog.miskcoo.com/2015/06/polynomial-with-newton-method#i-4</a><a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a></p><p><a id="fn_3" class="headerlink" title="3"></a><sup>3</sup>. <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AF%BC%E6%95%B0%E5%88%97%E8%A1%A8">https://zh.wikipedia.org/wiki/%E5%AF%BC%E6%95%B0%E5%88%97%E8%A1%A8</a><a href="#reffn_3" title="Jump back to footnote [3] in the text."> &#8617;</a></p><p><a id="fn_4" class="headerlink" title="4"></a><sup>4</sup>. <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%8C%87%E6%95%B0%E5%87%BD%E6%95%B0">https://zh.wikipedia.org/wiki/%E6%8C%87%E6%95%B0%E5%87%BD%E6%95%B0</a><a href="#reffn_4" title="Jump back to footnote [4] in the text."> &#8617;</a></p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年3月31日 第3次修订</li><li class="post-history-item">2021年2月4日 第2次修订</li><li class="post-history-item">2020年5月28日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/LCSE-rev-prog/">记一次 L 社 GalGame 汉化经历</a></div><div class="prev-post"><a href="/Math/Polynomial/DGF/">狄利克雷生成函数入门 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>