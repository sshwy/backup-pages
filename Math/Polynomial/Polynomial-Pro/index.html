<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>多项式进阶 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">多项式进阶</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2020年5月28日星期四下午2点58分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2020年5月28日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 4,472 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/Polynomial/">多项式与生成函数 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Polynomial/">Polynomial</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#洛必达法则"><span class="toc-number">1.</span> <span class="toc-text">洛必达法则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式除法"><span class="toc-number">2.</span> <span class="toc-text">多项式除法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多点求值"><span class="toc-number">3.</span> <span class="toc-text">多点求值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#快速插值"><span class="toc-number">4.</span> <span class="toc-text">快速插值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#第一部分"><span class="toc-number">4.1.</span> <span class="toc-text">第一部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二部分"><span class="toc-number">4.2.</span> <span class="toc-text">第二部分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#多项式复合逆"><span class="toc-number">5.</span> <span class="toc-text">多项式复合逆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#拉格朗日反演"><span class="toc-number">6.</span> <span class="toc-text">拉格朗日反演</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#大朋友与多叉树"><span class="toc-number">7.</span> <span class="toc-text">大朋友与多叉树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#仙人掌计数"><span class="toc-number">8.</span> <span class="toc-text">仙人掌计数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#方法一"><span class="toc-number">8.1.</span> <span class="toc-text">方法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法二"><span class="toc-number">8.2.</span> <span class="toc-text">方法二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#点双连通图计数"><span class="toc-number">9.</span> <span class="toc-text">点双连通图计数</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="洛必达法则" href="#洛必达法则" class="headerlink" title="洛必达法则"></a>洛必达法则</h2><p>若函数<script type="math/tex">f</script>和<script type="math/tex">g</script>满足以下条件：</p><ul><li><script type="math/tex">\displaystyle\lim_{x\to x_0}f(x)=\lim_{x\to x_0}g(x)=0</script>；</li><li>在<script type="math/tex">x</script>的某空邻域<script type="math/tex">U^{\circ}(x_0)</script>内两者均可导，且<script type="math/tex">g'(x)\ne 0</script>；</li><li><script type="math/tex">\displaystyle\lim_{x\to x_0}\frac{f'(x)}{g'(x)}=A</script>，其中<script type="math/tex">A</script>可为非正常极限。</li></ul><p>则</p><script type="math/tex;mode=display">\lim_{x\to x_0}\frac{f(x)}{g(x)}=\lim_{x\to x_0}\frac{f'(x)}{g'(x)}=A</script><p>通俗地说，如果<script type="math/tex">f(x),g(x)</script>在<script type="math/tex">x_0</script>处的极限都是<script type="math/tex">0</script>，那么<script type="math/tex">\frac{f(x)}{g(x)}</script>在<script type="math/tex">x_0</script>处的极限可以通过他们的导数来求。</p><h2><a id="多项式除法" href="#多项式除法" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给出多项式<script type="math/tex">A(x),B(x)</script>，求出<script type="math/tex">D(x),R(x)</script>，满足<script type="math/tex">A(x)=B(x)Q(x)+R(x)</script>，且<script type="math/tex">\deg R&lt;\deg B</script>。注意这里<strong>不是</strong>模意义下。<script type="math/tex">\deg A</script>表示多项式最高次项的次数。</p><p>定义一个变换</p><script type="math/tex;mode=display">F^R(x)=x^{\deg F}F\left(\frac{1}{x}\right)</script><p>该变换的实质是把多项式的系数翻转过来了。代入<script type="math/tex">\dfrac{1}{x}</script>得到</p><script type="math/tex;mode=display">A\left(\frac{1}{x}\right)=B\left(\frac{1}{x}\right)Q\left(\frac{1}{x}\right)+R\left(\frac{1}{x}\right)</script><p>由于<script type="math/tex">\deg Q=\deg A-\deg B</script>，那么不妨设<script type="math/tex">\deg R=\deg B-1</script>。稍作变换得到</p><script type="math/tex;mode=display">\begin{aligned}
x^{\deg A}A\left(\frac{1}{x}\right)&=x^{\deg B}B\left(\frac{1}{x}\right)x^{\deg Q}Q\left(\frac{1}{x}\right)+x^{\deg A}R\left(\frac{1}{x}\right)\\
A^R(x)&=B^R(x)Q^R(x)+R^R(x)x^{\deg A-\deg B+1}
\end{aligned}</script><p>那么容易发现，在模<script type="math/tex">x^{\deg A-\deg B+1}</script>意义下，<script type="math/tex">R^R</script>就没了：</p><script type="math/tex;mode=display">A^R(x)=B^R(x)Q^R(x)\pmod{x^{\deg A-\deg B+1}}</script><p>这样我们可以求出<script type="math/tex">Q^R\bmod{x^{\deg A-\deg B+1}}</script>。</p><p>由于<script type="math/tex">\deg Q&lt;\deg A-\deg B+1</script>，因此<script type="math/tex">Q^R\bmod x^{\deg A-\deg B+1}=Q^R</script>。于是</p><script type="math/tex;mode=display">Q^R(x)=\frac{A^R(x)}{B^R(x)}\pmod{x^{\deg A-\deg B+1}}</script><p>这样使用多项式求逆即可得到<script type="math/tex">Q^R</script>，反代回去可求出<script type="math/tex">R</script>。</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><h2><a id="多点求值" href="#多点求值" class="headerlink" title="多点求值"></a>多点求值</h2><p>给出<script type="math/tex">F(x)</script>，求<script type="math/tex">F(a_1),F(a_2),\cdots,F(a_m)</script>，其中<script type="math/tex">m</script>与<script type="math/tex">\deg F</script>同阶。</p><p>考虑分治。设<script type="math/tex">L(x)=\prod_{i=1}^{\lfloor\frac{m}{2}\rfloor}(x-a_i)</script>，<script type="math/tex">R(x)=\prod_{i=\lfloor\frac{m}{2}\rfloor+1}^n(x-a_i)</script>。</p><p>容易发现<script type="math/tex">L(a_1)=L(a_2)=\cdots =L(a_{\lfloor\frac{m}{2}\rfloor})=0</script>。那么构造<script type="math/tex">F_L(x)=F(x)\bmod L(x)</script>。显然有<script type="math/tex">F_L(a_i)=F(a_i),i\in[1,\lfloor\frac{m}{2}\rfloor]</script>满足。因此左边递归下去求值。右边同理。</p><p>时间复杂度<script type="math/tex">O(m\log_2^2m)</script>。在实现的过程中需要预先把所有的<script type="math/tex">\prod (x-a_i)</script>函数都存下来，因此空间复杂度是<script type="math/tex">O(m\log_2m)</script>。</p><h2><a id="快速插值" href="#快速插值" class="headerlink" title="快速插值"></a>快速插值</h2><p>给出<script type="math/tex">(x_1,y_1),(x_2,y_2),\cdots,(x_n,y_n)</script>。那么我们可以唯一确定一个<script type="math/tex">n-1</script>次多项式。求出这个多项式。</p><p>用拉格朗日插值可以得到</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=\sum_{i=1}^n\prod_{j\ne i}\frac{(x-x_j)}{(x_i-x_j)}y_i\\
&=\sum_{i=1}^n\frac{\prod_{j\ne i}(x-x_j)}{\prod_{j\ne i}(x_i-x_j)}y_i
\end{aligned}</script><p>分上下两部分处理。</p><h3><a id="第一部分" href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h3><p>考虑对于每个<script type="math/tex">i</script>求出<script type="math/tex">V_i=\prod_{j\ne i}(x_i-x_j)</script>。</p><p>设<script type="math/tex">M(x)=\prod_{i=1}^n (x-x_i)</script>。那么<script type="math/tex">M(x)</script>可以分治 NTT 计算出来，时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><p>容易发现<script type="math/tex">V_i=\dfrac{M(x)}{x-x_i}</script>。但是如果我们直接做<script type="math/tex">n</script>次多项式求逆的话复杂度就不对了。</p><p>利用<strong>洛必达法则</strong>，设<script type="math/tex">Q(x)=x-x_i</script>。因为<script type="math/tex">M(x_i)=Q(x_i)=0</script>，且两个函数都在邻域内可导，因此得到</p><script type="math/tex;mode=display">V_i=\frac{M(x)}{Q(x)}(x_i)=\frac{M'(x)}{Q'(x)}(x_i)=M'(x_i)</script><p>那么对<script type="math/tex">M'(x)</script>求出在<script type="math/tex">x_1,x_2,\cdots,x_n</script>处的点值即可。这样就求出了所有<script type="math/tex">V_i</script>。时间复杂度<script type="math/tex">O(n\log_2^2n)</script>。</p><h3><a id="第二部分" href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h3><p>求出<script type="math/tex">V_i</script>后，原式可以表示为</p><script type="math/tex;mode=display">F(x)=\sum_{i=1}^n\frac{y_i}{V_i}\prod_{j\ne i}(x-x_j)</script><p>同样考虑分治，设</p><script type="math/tex;mode=display">\begin{aligned}
M_L&=\prod_{i=1}^{n/2}(x-x_i)\\
M_R&=\prod_{i=n/2+1}^n(x-x_i)\\
F_L&=\sum_{i=1}^{n/2}\frac{y_i}{V_i}\prod_{j=1,j\ne i}^{n/2}(x-x_j)\\
F_R&=\sum_{i=n/2+1}^{n}\frac{y_i}{V_i}\prod_{j=n/2+1,j\ne i}^{n}(x-x_j)
\end{aligned}</script><p>那么如果我们求出了这 4 个多项式，那么可以得到<script type="math/tex">F=F_LM_R+F_RM_L</script>。两边递归求解即可。</p><p>时间复杂度<script type="math/tex">O(n\log_2^2n)</script>，空间复杂度<script type="math/tex">O(n\log_2n)</script>，因为多点求值带一个<script type="math/tex">O(n\log_2n)</script>的空间复杂度。而第二部分的计算是可以把空间减小到<script type="math/tex">O(n)</script>的，不过直接动态开空间也只增大了空间常数，没有改变空间复杂度。</p><h2><a id="多项式复合逆" href="#多项式复合逆" class="headerlink" title="多项式复合逆"></a>多项式复合逆</h2><p>对于两个多项式函数<script type="math/tex">F(x),G(x)</script>，如果<script type="math/tex">F(G(x))=x</script>，称<script type="math/tex">F,G</script>互为<strong>复合逆</strong>。</p><p>容易证明<script type="math/tex">G(F(x))=F(G(x))=x</script>。但是多项式复合逆没有时间复杂度<script type="math/tex">O(n\log_2n)</script>的做法。但可以使用拉格朗日反演在<script type="math/tex">O(n\log_2n)</script>的时间内计算出某一项。</p><h2><a id="拉格朗日反演" href="#拉格朗日反演" class="headerlink" title="拉格朗日反演"></a>拉格朗日反演</h2><p>对于两个多项式函数<script type="math/tex">F(x),G(x)</script>，如果<script type="math/tex">F(G(x))=x</script>，那么</p><script type="math/tex;mode=display">[x^n]G(x)=\frac{1}{n}[x^{n-1}]\left( \frac{x}{F(x)} \right)^n</script><p>还有一个扩展形式：</p><script type="math/tex;mode=display">[x^n]H(G(x))=\frac{1}{n}[x^{n-1}]H'(x)\left( \frac{x}{F(x)} \right)^n</script><p>其中<script type="math/tex">H(x)</script>是另一个多项式函数。</p><h2><a id="大朋友与多叉树" href="#大朋友与多叉树" class="headerlink" title="大朋友与多叉树"></a>大朋友与多叉树</h2><p>题意：求有多少棵有根树，满足有<script type="math/tex">s</script>个叶子结点，内部结点的儿子数都属于集合<script type="math/tex">D</script>，且<script type="math/tex">1\notin D</script>。注意，儿子之间是有顺序的。</p><p>例如当<script type="math/tex">s=4,D=\{2,3\}</script>时：</p><p><img src="../../../images/polynomial-pro1.jpg" alt="polynomial-pro1"></p><p>定义两个普通生成函数</p><script type="math/tex;mode=display">F(x)=\sum_{n\in D}x^n\\
G(x)=\sum_{n\ge 1}g_nx^n</script><p>其中<script type="math/tex">g_n</script>是<script type="math/tex">s=n</script>的答案。考虑根结点的孩子数为<script type="math/tex">a</script>，此时方案数的生成函数显然为<script type="math/tex">G^a(x)</script>。从这个思路出发，可以得到</p><script type="math/tex;mode=display">F(G(x))+x=G(x)</script><p>加上一个<script type="math/tex">x</script>是考虑<script type="math/tex">s=1</script>的情况。可以得到<script type="math/tex">G(x)-F(G(x))=x</script>，因此<script type="math/tex">x-F(x)</script>与<script type="math/tex">G(x)</script>互为复合逆。</p><p>使用拉格朗日反演得到</p><script type="math/tex;mode=display">[x^s]G(x)=\frac{1}{s}[x^{s-1}]\left(\frac{x}{x-F(x)}\right)^s</script><p>在模<script type="math/tex">x^{s+1}</script>意义下直接求值即可。一个技巧是把后面的式子转化为<script type="math/tex">(1-\frac{F(x)}{x})^{-s}</script>的形式，这样常数项为 1，可以多项式<script type="math/tex">\ln</script>来求幂。</p><p>时间复杂度<script type="math/tex">O(n\log_2n)</script>。</p><h2><a id="仙人掌计数" href="#仙人掌计数" class="headerlink" title="仙人掌计数"></a>仙人掌计数</h2><p>仙人掌：如果一个简单无向连通图的任意一条边最多属于一个简单环，我们就称之为仙人掌。所谓简单环即不经过重复的结点的环。</p><p>求<script type="math/tex">n</script>个点带标号的仙人掌数量。</p><p>考虑<strong>有根</strong>仙人掌的指数生成函数为<script type="math/tex">F(x)</script>。那么求出来后把方案数除以<script type="math/tex">n</script>就是答案。我们可以将仙人掌的构成分成两种部分：</p><ol><li>从根结点连出去的独立边，相当于接一个仙人掌出去。一条边连出去的生成函数是<script type="math/tex">F(x)</script>，多条边之间不区分顺序，因此方案数是<script type="math/tex">\exp F(x)</script>。</li><li>包含根结点的一个简单环，环上除了根结点之外的每个结点都挂一个仙人掌。由于我们要考虑环上结点之间的顺序，因此假设环长为<script type="math/tex">i+1</script>，那么<script type="math/tex">i</script>个仙人掌按序排列的生成函数是<script type="math/tex">F^i(x)</script>。考虑到是一个环，因此每个排列被正着反着各算了一次，因此长度为<script type="math/tex">i+1</script>的环的生成函数是<script type="math/tex">\dfrac{F^i(x)}{2}</script>。那么一个环的生成函数就是<script type="math/tex">\displaystyle\sum_{i\ge 2}\frac{F^i(x)}{2}</script>。多个环之间是不区分顺序的，因此多个环的方案数是<script type="math/tex">\exp \left(\displaystyle\sum_{i\ge 2}\frac{F^i(x)}{2}\right)</script>。</li></ol><p>综上，环和独立边互不相关，总方案数是<script type="math/tex">\exp \left(F(x)+\displaystyle\sum_{i\ge 2}\frac{F^i(x)}{2}\right)</script>，再加上根结点本身得到</p><script type="math/tex;mode=display">F(x)=x\exp \left(F(x)+\sum_{i\ge 2}\frac{F^i(x)}{2}\right)</script><p>稍作整理得到</p><script type="math/tex;mode=display">F(x)=x\exp \left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)</script><p>考虑牛顿迭代法。</p><h3><a id="方法一" href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>设</p><script type="math/tex;mode=display">G(F(x))=x\exp \left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)-F(x)</script><p>那么显然我们要求<script type="math/tex">G(F(x))=0\pmod{x^{n+1}}</script>。应用牛顿迭代得到</p><script type="math/tex;mode=display">F(x)=F_0(x)-\frac{G(F_0(x))}{G'(F_0(x))} \pmod {x^n}</script><p>对<script type="math/tex">G</script>求导得到</p><script type="math/tex;mode=display">\begin{aligned}
G'(F(x))&=\left(x\exp \left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)\right)'-1\\
&=x\left(\exp \left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)\right)'-1\\
&=x\exp \left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)\left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)'-1\\
&=x\exp \left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)
\left(1+\frac{2(2F(x)-F^2(x))}{(2-2F(x))^2}\right)-1
\end{aligned}</script><p>如何理解式子中的<script type="math/tex">x</script>？我们把它理解为与<script type="math/tex">F(x)</script>不相关的一个常量即可。常量的导数是<script type="math/tex">0</script>。</p><p>最后得到</p><script type="math/tex;mode=display">F(x)=F_0(x)-
\frac{x\exp \left(\frac{2F_0(x)-F_0^2(x)}{2-2F_0(x)}\right)-F_0(x)}{x\exp \left(\frac{2F_0(x)-F_0^2(x)}{2-2F_0(x)}\right)
\left(1+\frac{2(2F_0(x)-F_0^2(x))}{(2-2F_0(x))^2}\right)-1}
\pmod {x^n}</script><h3><a id="方法二" href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>方才<script type="math/tex">F(x)</script>的式子可以变换为</p><script type="math/tex;mode=display">F(x)=x\exp \left(\frac{2F(x)-F^2(x)}{2-2F(x)}\right)\\
F(x)\exp \left(\frac{2F(x)-F^2(x)}{2F(x)-2}\right)-x=0</script><p>因此设</p><script type="math/tex;mode=display">G(F(x))=F(x)\exp \left(\frac{2F(x)-F^2(x)}{2F(x)-2}\right)-x</script><p>同样的方法，对<script type="math/tex">G</script>求导得到</p><script type="math/tex;mode=display">G'(F(x))=
\exp\left( \frac{2F(x)-F(x)^2}{2F(x)-2} \right)
\left(1-F(x)\left(1+\frac{2(2F(x)-F(x)^2)}{(2F(x)-2)^2}\right)\right)</script><p>因此可以得到</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=F_0(x)-
\frac{F_0(x)\exp \left(\frac{2F_0(x)-F_0^2(x)}{2F_0(x)-2}\right)-x}
{\exp\left( \frac{2F_0(x)-F_0(x)^2}{2F_0(x)-2} \right)
\left(1-F_0(x)\left(1+\frac{2(2F_0(x)-F_0(x)^2)}{(2F_0(x)-2)^2}\right)\right)}\\
&=F_0(x)-
\frac{F_0(x)-x\exp \left(\frac{2F_0(x)-F_0^2(x)}{2-2F_0(x)}\right)}
{1-F_0(x)\left(1+\frac{2(2F_0(x)-F_0(x)^2)}{(2-2F_0(x))^2}\right)}
\end{aligned}\pmod{x^n}</script><p>两种迭代方式是等价的。由于是 EGF 最后别忘了乘上<script type="math/tex">n!</script>。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/loj/6569.cpp">代码</a></p><h2><a id="点双连通图计数" href="#点双连通图计数" class="headerlink" title="点双连通图计数"></a>点双连通图计数</h2><p>如果一个无向连通图删去任意一个点都仍然是连通的，我们就称为点双连通图。</p><p>求<script type="math/tex">n</script>个点带标号点双连通图的个数。</p><p>同样地，设<script type="math/tex">F(x)=\sum_{n\ge 1}f_n\frac{x^n}{n!}</script>表示<script type="math/tex">n</script>个点的点双连通图的 EGF。设<script type="math/tex">G(x)</script>表示<script type="math/tex">n</script>个点有根连通图的 EGF。</p><p>设<script type="math/tex">H(x)=\sum_{n\ge 0}2^{\binom{n}{2}}\frac{x^n}{n!}</script>表示带标号无向图数的生成函数，那么得到<script type="math/tex">G(x) = x(\ln H(x))'</script>。</p><p>我们考虑用<script type="math/tex">F</script>表示<script type="math/tex">G</script>。考虑有根无向图的包含根结点的点双连通分量。假设大小为<script type="math/tex">i+1</script>，那么除了根结点之外的点都可以挂一个有根连通图，因此方案数是<script type="math/tex">\sum_{i\ge 1}\frac{G^i(x)}{i!}</script>。对于<script type="math/tex">i</script>个不区分顺序的有根连通图的根结点，再加上根结点，因此一个点双连通分量的方案数是<script type="math/tex">\sum_{i\ge 1}\frac{f_{i+1}G^i(x)}{i!}</script>。多个点双连通分量之间不区分顺序，因此总方案数是<script type="math/tex">\exp \left(\sum_{i\ge 1}\frac{f_{i+1}G^i(x)}{i!}\right)</script>。再加上根结点本身得到</p><script type="math/tex;mode=display">G(x)=x\exp \left(\sum_{i\ge 1}\frac{f_{i+1}G^i(x)}{i!}\right)=x\exp F'(G(x))</script><p>然而这个方程无法牛顿迭代。设<script type="math/tex">G</script>的复合逆是<script type="math/tex">G^{I}</script>，那么得到</p><script type="math/tex;mode=display">\begin{aligned}
G(G^I(x))&=G^I(x)\exp F'(G(G^I(x)))\\
x&=G^I(x)\exp F'(x)\\
F'(x)&=\ln \frac{x}{G^I(x)}
\end{aligned}</script><p>据说使用扩展拉格朗日反演可以解决。</p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2020年5月28日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Math/Quadratic-Residue/">二次剩余学习笔记</a></div><div class="prev-post"><a href="/Math/Polynomial/Multi-Point-Eval/">转置原理与多点求值 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>