<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>指数生成函数学习笔记 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">指数生成函数学习笔记</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年7月7日星期三晚上8点18分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年7月7日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 4,155 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/Polynomial/">多项式与生成函数 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/EGF/">EGF</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Generating-Function/">Generating-Function</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#指数生成函数"><span class="toc-number">1.</span> <span class="toc-text">指数生成函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#常用封闭形式"><span class="toc-number">1.1.</span> <span class="toc-text">常用封闭形式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#置换环与圆排列"><span class="toc-number">2.</span> <span class="toc-text">置换环与圆排列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#拓展"><span class="toc-number">2.1.</span> <span class="toc-text">拓展</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有标号简单连通无向图计数"><span class="toc-number">3.</span> <span class="toc-text">有标号简单连通无向图计数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#算法一"><span class="toc-number">3.1.</span> <span class="toc-text">算法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法二"><span class="toc-number">3.2.</span> <span class="toc-text">算法二</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有标号二分图计数"><span class="toc-number">4.</span> <span class="toc-text">有标号二分图计数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TJOI2015-概率论"><span class="toc-number">5.</span> <span class="toc-text">TJOI2015 概率论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POJ3734-Blocks"><span class="toc-number">6.</span> <span class="toc-text">POJ3734 Blocks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#51nod1728-不动点"><span class="toc-number">7.</span> <span class="toc-text">51nod1728 不动点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CF891-E"><span class="toc-number">8.</span> <span class="toc-text">CF891 E</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小朋友与二叉树"><span class="toc-number">9.</span> <span class="toc-text">小朋友与二叉树</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分拆数"><span class="toc-number">10.</span> <span class="toc-text">分拆数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#算法一-1"><span class="toc-number">10.1.</span> <span class="toc-text">算法一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法二-1"><span class="toc-number">10.2.</span> <span class="toc-text">算法二</span></a></li></ol></li></ol></div><hr></div><div class="post-content"><h2><a id="指数生成函数" href="#指数生成函数" class="headerlink" title="指数生成函数"></a>指数生成函数</h2><p>指数生成函数（Exponential generating function，EGF）定义为</p><script type="math/tex;mode=display">\hat{F}(x)=\sum_{i\ge 0}a_i\frac{x^i}{i!}</script><p>指数生成函数的运算不是简单的卷积：</p><script type="math/tex;mode=display">\begin{aligned}
\hat{F}(x)\hat{G}(x)&=\sum_{i\ge 0}\sum_{j\ge 0}a_ib_j\frac{x^{i+j}}{i!j!}\\
&=\sum_{k\ge 0}\sum_{i=0}^ka_ib_{k-i}\frac{x^k}{i!(k-i)!}\\
&=\sum_{k\ge 0}\sum_{i=0}^k\binom{k}{i}a_ib_{k-i}\frac{x^k}{k!}
\end{aligned}</script><p>因此序列<script type="math/tex">a_i</script>和<script type="math/tex">b_i</script>的指数生成函数的积得到的是<script type="math/tex">\sum_{j=0}^i\dbinom{i}{j} a_ib_{i-j}</script>的指数生成函数。这在一些有标号的计数中会很有用。</p><h3><a id="常用封闭形式" href="#常用封闭形式" class="headerlink" title="常用封闭形式"></a>常用封闭形式</h3><p>首先有<script type="math/tex">e^x</script>的泰勒展开式：</p><script type="math/tex;mode=display">\hat{G}(x)=\sum_{i\ge 0}\frac{x^i}{i!}=e^x</script><p>那么简单拓展为<script type="math/tex">e^{-x}</script>：</p><script type="math/tex;mode=display">\hat{G}(x)=\sum_{i\ge 0}\frac{(-x)^i}{i!}=\sum_{i\ge 0}(-1)^i\frac{x^i}{i!}</script><p>这两个可以拓展出奇数和偶数阶乘的封闭形式。</p><h2><a id="置换环与圆排列" href="#置换环与圆排列" class="headerlink" title="置换环与圆排列"></a>置换环与圆排列</h2><p>考虑 n 个元素的排列数<script type="math/tex">p_n=n!</script>的指数生成函数：</p><script type="math/tex;mode=display">\hat{P}(x)=\sum_{n\ge 0}n!\frac{x^n}{n!}=\frac{1}{1-x}\\</script><p>另一方面，<script type="math/tex">n</script>个元素的圆排列排列数<script type="math/tex">q_n=(n-1)!</script>的指数生成函数：</p><script type="math/tex;mode=display">\hat{Q}(x)=\sum_{n\ge 0}(n-1)!\frac{x^n}{n!}=-\ln(1-x)=\ln\left(\frac{1}{1-x}\right)</script><p>这两者有什么联系？容易发现，（置换）排列可以理解为是若干个环（置换环）的集合。而这些环之间的顺序我们不考虑。因此<script type="math/tex">\exp\hat{Q}</script>可以理解为是若干个带标号的圆排列组合在一起的方案数的指数生成函数，即<script type="math/tex">\hat{P}</script>。反之，<script type="math/tex">\ln\hat{P}</script>则相当于把构成方案分成若干个具有相同性质的部分，这些部分的生成函数。</p><p>另一方面，这也解释了<script type="math/tex">\exp</script>和<script type="math/tex">\ln</script>的组合意义，这在求一些生成函数的时候会非常有用。</p><h3><a id="拓展" href="#拓展" class="headerlink" title="拓展"></a>拓展</h3><p>错排数的生成函数？</p><p>直接用容斥的式子似乎不太好做。考虑其组合意义就是置换环大小大于 1 的置换数量。那么我们把圆排列数的<script type="math/tex">x</script>这一项去掉，然后<script type="math/tex">\exp</script>回去即可：</p><script type="math/tex;mode=display">\hat{F}(x)=\exp(\hat{Q}(x)-x)=\exp\left(\ln\left(\frac{1}{1-x}\right)-x\right)=\frac{e^{-x}}{1-x}</script><h2><a id="有标号简单连通无向图计数" href="#有标号简单连通无向图计数" class="headerlink" title="有标号简单连通无向图计数"></a>有标号简单连通无向图计数</h2><p>题目链接：<a target="_blank" rel="noopener" href="https://darkbzoj.tk/problem/3456">城市规划</a>。</p><blockquote><p>求出有<script type="math/tex">n(n\le 130000)</script>个点的有标号简单连通无向图的个数。</p></blockquote><h3><a id="算法一" href="#算法一" class="headerlink" title="算法一"></a>算法一</h3><p>设<script type="math/tex">f(n)</script>表示<script type="math/tex">n</script>个点简单无向连通图的个数，<script type="math/tex">g(n)</script>表示<script type="math/tex">n</script>个点的图的个数。那么</p><script type="math/tex;mode=display">g(n)=2^{\binom{n}{2}}</script><p>且</p><script type="math/tex;mode=display">g(n)=\sum_{i=1}^n\binom{n-1}{i-1}f(i)g(n-i)</script><p>化简得到</p><script type="math/tex;mode=display">\frac{g(n)}{(n-1)!}=\sum_{i=1}^n\frac{f(i)}{(i-1)!}\frac{g(n-i)}{(n-i)!}</script><p>我们定义三个生成函数</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=\sum_{i\ge 1}\frac{f(i)}{(i-1)!}x^i\\
G(x)&=\sum_{i\ge 0}\frac{g(i)}{i!}x^i\\
H(x)&=\sum_{i\ge 1}\frac{g(i)}{(i-1)!}x^i
\end{aligned}</script><p>那么显然可以得到<script type="math/tex">H=FG\pmod{x^{n+1}}</script>，那么<script type="math/tex">F=HG^{-1}\pmod{x^{n+1}}</script>，多项式求逆即可。</p><p>最后算完了别忘了把阶乘乘回去。</p><h3><a id="算法二" href="#算法二" class="headerlink" title="算法二"></a>算法二</h3><p>设<script type="math/tex">g(i)</script>表示<script type="math/tex">i</script>个点的简单无向图的个数，<script type="math/tex">f(i)</script>表示<script type="math/tex">i</script>个点简单无向连通图的个数。对应的指数生成函数为</p><script type="math/tex;mode=display">\hat{G}(x)=\sum_{i\ge 0}g(i)\frac{x^i}{i!}\\
\hat{F}(x)=\sum_{i\ge 0}f(i)\frac{x^i}{i!}</script><p>其中</p><script type="math/tex;mode=display">g(i)=2^{\binom{i}{2}}</script><p>我们尝试用<script type="math/tex">\hat{F}</script>表示<script type="math/tex">\hat{G}</script>。考虑<script type="math/tex">[x^n]\hat{F}^i(x)</script>表示的含义。它表示<script type="math/tex">n</script>个点分成<script type="math/tex">i</script>个连通块的“排列数”。因为在分的过程中我们是钦定了连通块之间的顺序（这是 EGF 乘法运算的组合意义）。因此还需要除以<script type="math/tex">i!</script>才能得到<script type="math/tex">n</script>个点分成<script type="math/tex">i</script>个连通块的图的个数。因此得到</p><script type="math/tex;mode=display">\hat{G}(x)=\sum_{i\ge 0}\frac{\hat{F}^i(x)}{i!}</script><p>因此<script type="math/tex">\hat{G}(x)=\exp \hat{F}(x)</script>，那么<script type="math/tex">\hat{F}(x)=\ln \hat{G}(x)</script>。</p><h2><a id="有标号二分图计数" href="#有标号二分图计数" class="headerlink" title="有标号二分图计数"></a>有标号二分图计数</h2><p>首先考虑<strong>二分染色图</strong>计数。所谓二分染色图指区分左右部的二分图。这个比较简单：</p><script type="math/tex;mode=display">f_n = \sum_{i = 0} ^ n \binom{n}{i} 2^{(n - i) i}</script><p>设其对应的 EGF 为<script type="math/tex">F(x)</script>。根据<script type="math/tex">ab = \binom{a + b}{2} - \binom{a}{2} - \binom{b}{2}</script>，我们可以很容易将<script type="math/tex">F</script>表示为卷积的形式。</p><p>然后我们考虑将二分染色图个数转化为二分图个数。若连通块个数为<script type="math/tex">k</script>的二分染色图为<script type="math/tex">t</script>，那么连通块个数为<script type="math/tex">k</script>的二分图个数为<script type="math/tex">\frac{t}{2^k}</script>。这启发我们利用连通二分图的个数建立关系。</p><p>假设二分图个数的 EGF 为<script type="math/tex">G(x)</script>，则连通二分图的个数的 EGF 显然为<script type="math/tex">\ln G(x)</script>。于是连通的二分染色图个数为<script type="math/tex">2\ln G(x)</script>，于是</p><script type="math/tex;mode=display">2\ln G = \ln F</script><p>因此<script type="math/tex">G = \sqrt{F}</script>。使用多项式开根即可。</p><h2><a id="TJOI2015-概率论" href="#TJOI2015-概率论" class="headerlink" title="TJOI2015 概率论"></a>TJOI2015 概率论</h2><p>设<script type="math/tex">h(i)</script>表示<script type="math/tex">i</script>个结点的二叉树总数，<script type="math/tex">f(i)</script>表示<script type="math/tex">i</script>个结点的二叉树的叶子结点数的和。</p><p>容易发现<script type="math/tex">h(i)=\sum_{j=0}^{i-1}h(j)h(i-j-1)</script>是卡特兰数。类似地可以得到</p><script type="math/tex;mode=display">f(i)=2\sum_{j=1}^{i-1}f(j)h(i-j-1) \quad (i\ge 2)</script><p>其中<script type="math/tex">f(0)=0,f(1)=1</script>。类似地，设<script type="math/tex">F(x)=\sum_{i\ge 0}f(i)x^i</script>，那么得到</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=\sum_{i\ge 0}f(i)x^i\\
&=x+2\sum_{i\ge 2}\sum_{j=1}^{i-1}f(j)h(i-j-1)x^jx^{i-j-1}x\\
&=x+2x\sum_{j\ge 1}f(j)x^j\sum_{i\ge 0}h(i)x^{i}\\
&=x+2xF(x)C(x)
\end{aligned}</script><p>代入<script type="math/tex">C(x)=\dfrac{1-\sqrt{1-4x}}{2x}</script>解得</p><script type="math/tex;mode=display">F(x)=\frac{x}{\sqrt{1-4x}}</script><p>用牛顿二项式展开得到</p><script type="math/tex;mode=display">(1-4x)^{-\frac{1}{2}}=\sum_{i\ge 0}\binom{-\frac{1}{2}}{i}(-4x)^i\\
=\sum_{i\ge 0}\frac{(-1)^i(2i)!}{4^ii!i!}(-4x)^i\\
=\sum_{i\ge 0}\binom{2i}{i}x^i\\</script><p>那么带回原式得到</p><script type="math/tex;mode=display">F(x)=\sum_{i\ge 1}\binom{2i-2}{i-1}x^{i}</script><p>根据卡特兰数的生成函数</p><script type="math/tex;mode=display">C(x)=\sum_{i\ge 0}\frac{1}{i+1}\binom{2i}{i}x^i</script><p>对应项相除可以得到</p><script type="math/tex;mode=display">\frac{[x^n]F(x)}{[x^n]C(x)}=\frac{\binom{2n-2}{n-1}}{\frac{1}{n+1}\binom{2n}{n}}=\frac{n(n+1)}{2(2n-1)}</script><p>答案即所求。</p><h2><a id="POJ3734-Blocks" href="#POJ3734-Blocks" class="headerlink" title="POJ3734 Blocks"></a>POJ3734 Blocks</h2><p>容易得到生成函数为</p><script type="math/tex;mode=display">e^{2x}\left(\frac{e^x+e^{-x}}{2}\right)^2\\
=\frac{e^{4x}+2e^{2x}+1}{4}</script><p>那么展开得到</p><script type="math/tex;mode=display">\hat{G}(x)=1+\sum_{i\ge 1}(4^{i-1}+2^{i-1})\frac{x^i}{i!}</script><h2><a id="51nod1728-不动点" href="#51nod1728-不动点" class="headerlink" title="51nod1728 不动点"></a>51nod1728 不动点</h2><p>题意：求有多少个映射<script type="math/tex">f:\{1,2,\cdots,n\}\to \{1,2,\cdots,n\}</script>，使得<script type="math/tex">\bigcirc_{i=1}^k f=\bigcirc_{i=1}^{k-1}f</script>。（这个大圈表示复合）</p><p><script type="math/tex">nk\le 2\times 10^6,k\le 3</script>。</p><p>可以发现，我们要求的是<script type="math/tex">n</script>个点带标号的深度不超过<script type="math/tex">k</script>的有根树森林计数。</p><p>设<script type="math/tex">\hat{F}_k(x)</script>表示答案的指数生成函数。显然<script type="math/tex">\hat{F}_1(x)=e^x</script>。</p><p>设<script type="math/tex">[x^n]\hat{G}_k(x)</script>表示<script type="math/tex">n</script>个点深度不超过<script type="math/tex">k</script>的有根树的方案数。<script type="math/tex">\hat{G}_k(x)</script>是指数生成函数。显然<script type="math/tex">\hat{G}_1(x)=x</script>。考虑<script type="math/tex">\hat{G}_k(x)</script>的递推式，可以得到<script type="math/tex">[x^n]\hat{G}_k(x)=n[x^{n-1}]\hat{F}_{k-1}(x)</script>。整理一下得到<script type="math/tex">\hat{G}_k(x)=x\hat{F}_{k-1}(x)</script>。</p><p>于是得到<script type="math/tex">\hat{F}_k(x)=\exp \hat{G}_k(x)=\exp(x\hat{F}_{k-1}(x))</script>。</p><p>注意这题卡常，可以根据<script type="math/tex">nk\le 2\times 10^6</script>合理设置长度来卡常。</p><h2><a id="CF891-E" href="#CF891-E" class="headerlink" title="CF891 E"></a>CF891 E</h2><p>设<script type="math/tex">a_i</script>减少的值是<script type="math/tex">b_i</script>，那么题目相当于要求<script type="math/tex">E(\prod a_i-\prod(a_i-b_i))=\prod a_i-E(\prod(a_i-b_i))</script>。</p><p>对于后者，乘上一个<script type="math/tex">n^k</script>转化为计数问题：</p><script type="math/tex;mode=display">E=\frac{1}{n^k}\sum_{\sum b_i=k}\frac{k!}{\prod b_i!}\prod_{i=1}^n(a_i-b_i)\\
=\frac{k!}{n^k}\sum_{\sum b_i=k}\prod_{i=1}^n\frac{a_i-b_i}{b_i!}</script><p>构造生成函数，对于<script type="math/tex">\dfrac{a_i-b_i}{b_i!}</script>可以构造<script type="math/tex">\sum_{j\ge 0}\dfrac{a_i-j}{j!}</script>，那么就可以构造一个 OGF：</p><script type="math/tex;mode=display">F(x)=\prod_{i=1}^n\sum_{j\ge 0}\frac{a_i-j}{j!}x^j</script><p>虽然这是一个 OGF，但是我们是可以把它当 EGF 来用的。因此做一下化简：</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=\prod_{i=1}^n\sum_{j\ge 0}\frac{a_i-j}{j!}x^j\\
&=\prod_{i=1}^n(a_ie^x-xe^x)\\
&=e^{nx}\prod_{i=1}^n(a_i-x)\\
\end{aligned}</script><p>我们直接<script type="math/tex">O(n^2)</script>求出<script type="math/tex">G(x)=\prod_{i=1}^n(a_i-x)</script>的系数，记为<script type="math/tex">c_i</script>。那么可以得到</p><script type="math/tex;mode=display">\begin{aligned}
F(x)&=e^{nx}G(x)\\
&=\sum_{i\ge 0}\frac{(nx)^i}{i!}\sum_{j\ge 0}c_jx^j\\
&=\sum_{i\ge 0}\frac{n^ix^i}{i!}\sum_{j\ge 0}c_jx^j\\
&=\sum_{k\ge 0}x^k\sum_{i=0}^k\frac{n^i}{i!}c_{k-i}
\end{aligned}</script><p>期望为</p><script type="math/tex;mode=display">\frac{k!}{n^k}[x^k]F(x)=\sum_{i=0}^k\frac{k^{\underline{i}}}{n^{i}}c_i=\sum_{i=0}^{\min(n,k)}\frac{k^{\underline{i}}}{n^{i}}c_i</script><p>答案为</p><script type="math/tex;mode=display">\prod_{i=1}^na_i-\sum_{i=0}^{\min(n,k)}\frac{k^{\underline{i}}}{n^{i}}c_i</script><h2><a id="小朋友与二叉树" href="#小朋友与二叉树" class="headerlink" title="小朋友与二叉树"></a>小朋友与二叉树</h2><p>考虑<script type="math/tex">G(x)=\sum_{i=1}^nx^{c_i}</script>。设答案的 OGF 为<script type="math/tex">F(x)</script>。那么可以列出方程</p><script type="math/tex;mode=display">F=F^2G+1</script><p>解得</p><script type="math/tex;mode=display">F=\frac{1\pm \sqrt{1-4G}}{2G}=\frac{2}{1\mp \sqrt{1-4G}}</script><p>取<script type="math/tex">x=0</script>，由于分母常数项不能为 0，因此舍掉负根，得到</p><script type="math/tex;mode=display">F(x)=\frac{2}{1+\sqrt{1-4G(x)}}</script><p>多项式求逆、幂函数即可（<script type="math/tex">[x^0]F(x)=1</script>）。</p><h2><a id="分拆数" href="#分拆数" class="headerlink" title="分拆数"></a>分拆数</h2><p>分拆数（拆分数，划分数）的生成函数为</p><script type="math/tex;mode=display">P(x)=\prod_{i\ge 1}\left(\sum_{j\ge 0}x^{ij}\right)</script><h3><a id="算法一-1" href="#算法一-1" class="headerlink" title="算法一"></a>算法一</h3><p>利用所学知识，我们来化简一下该生成函数：</p><script type="math/tex;mode=display">P(x)=\prod_{i\ge 1}\frac{1}{1-x^i}</script><p>两边同时<script type="math/tex">\ln</script>得到</p><script type="math/tex;mode=display">\begin{aligned}
\ln P(x)&=\ln\prod_{i\ge 1}\frac{1}{1-x^i}\\
&=\sum_{i\ge 1}\ln\frac{1}{1-x^i}\\
&=-\sum_{i\ge 1}\ln(1-x^i)\\
&=\sum_{i\ge 1}\sum_{j\ge 1}\frac{x^{ij}}{j}\\
&=\sum_{i\ge 1}x^i\sum_{j|i}\frac{1}{j}\\
\end{aligned}</script><p>那么我们<script type="math/tex">O(n\log n)</script>预处理<script type="math/tex">\ln P(x)</script>，再<script type="math/tex">\exp</script>回去即可。时间复杂度<script type="math/tex">O(n\log n)</script>。但常数较大。</p><h3><a id="算法二-1" href="#算法二-1" class="headerlink" title="算法二"></a>算法二</h3><p>首先介绍一下五边形数：<script type="math/tex">p_n=\dfrac{1}{2}n(3n-1),n\in\mathbf{N}</script>。</p><p>对于<strong>广义五边形数</strong>，<script type="math/tex">n\in\mathbf{Z}</script>。容易证明，<script type="math/tex">p_n\ge 0(n\in \mathbf{Z})</script>。</p><p>接下来介绍<strong>欧拉函数（复变函数）</strong>，其定义为</p><script type="math/tex;mode=display">\phi(x)=\prod_{i\ge 1}(1-x^i)</script><p>与之相关的是<strong>五边形定理</strong>，它描述了五边形数与欧拉函数的关系：</p><script type="math/tex;mode=display">\phi(x)=\sum_{n=-\infty}^\infty(-1)^nx^{p_n}</script><p>另外还有一个性质，欧拉函数的倒数是分拆数的生成函数：</p><script type="math/tex;mode=display">\phi^{-1}(x)=\sum_{n\ge 0}P(n)x^n</script><p>于是直接求即可。求<script type="math/tex">\phi(x)\bmod {x^n}</script>的复杂度是<script type="math/tex">O(\sqrt{n})</script>的，多项式求逆复杂度<script type="math/tex">O(n\log_2n)</script>。总复杂度<script type="math/tex">O(n\log_2n)</script>。</p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年7月7日 第3次修订</li><li class="post-history-item">2020年12月29日 第2次修订</li><li class="post-history-item">2020年5月28日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Probset/21-NOI-Training/">NOI2021 赛前训练日志</a></div><div class="prev-post"><a href="/K-Greedy/">偏序结构第 K 小问题算法小结 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>