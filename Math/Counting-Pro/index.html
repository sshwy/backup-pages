<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>「草稿」组合计数综合练习 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">「草稿」组合计数综合练习</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2021年3月27日星期六下午4点53分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2021年3月27日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 4,497 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#常见数列"><span class="toc-number">1.</span> <span class="toc-text">常见数列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#容斥原理"><span class="toc-number">2.</span> <span class="toc-text">容斥原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ARC-102-E"><span class="toc-number">2.1.</span> <span class="toc-text">ARC 102 E</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#集训队作业-2018-小-z-的礼物"><span class="toc-number">2.2.</span> <span class="toc-text">集训队作业 2018 小 z 的礼物</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ARC-96-E-Everything-on-It"><span class="toc-number">2.3.</span> <span class="toc-text">ARC 96 E Everything on It</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ARC-101-E-Ribbons-on-Tree"><span class="toc-number">2.4.</span> <span class="toc-text">ARC 101 E Ribbons on Tree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ARC-93-F"><span class="toc-number">2.5.</span> <span class="toc-text">ARC 93 F</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#斯特林反演"><span class="toc-number">3.</span> <span class="toc-text">斯特林反演</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#反演公式"><span class="toc-number">3.1.</span> <span class="toc-text">反演公式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#反转公式"><span class="toc-number">3.2.</span> <span class="toc-text">反转公式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2018-雅礼集训-方阵"><span class="toc-number">3.3.</span> <span class="toc-text">2018 雅礼集训 方阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#一道例题"><span class="toc-number">3.4.</span> <span class="toc-text">一道例题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#另一道例题"><span class="toc-number">3.5.</span> <span class="toc-text">另一道例题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#清华集训-2017-生成树计数"><span class="toc-number">3.6.</span> <span class="toc-text">清华集训 2017 生成树计数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Burnside-引理"><span class="toc-number">4.</span> <span class="toc-text">Burnside 引理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ARC-62-F-Painting-Graphs-with-AtCoDeer"><span class="toc-number">4.1.</span> <span class="toc-text">ARC 62 F Painting Graphs with AtCoDeer</span></a></li></ol></li></ol></div><hr></div><div class="post-content"><h2><a id="常见数列" href="#常见数列" class="headerlink" title="常见数列"></a>常见数列</h2><p>贝尔数：n 个数分成若干个非空集合的方案数</p><ul><li><script type="math/tex">B_n=\sum_{k=0}^nS(n,k)</script>。</li><li>递推：<script type="math/tex">B_n=\sum_{k=0}^{n-1}\binom{n-1}{k}B_k</script>。</li></ul><p>调和级数：<script type="math/tex">H_n=\sum_{i=1}^n\frac{1}{i}=\ln n+\varepsilon_n+\gamma</script>，其中<script type="math/tex">\gamma</script>是欧拉常数，<script type="math/tex">\varepsilon_n\approx \frac{1}{2n}</script>。</p><h2><a id="容斥原理" href="#容斥原理" class="headerlink" title="容斥原理"></a>容斥原理</h2><h3><a id="ARC-102-E" href="#ARC-102-E" class="headerlink" title="ARC 102 E"></a>ARC 102 E</h3><blockquote><p>有 n 个不可取分的 k 面骰子，对于每个<script type="math/tex">i=2,3,\cdots,2K</script>，求有多少种方案使得：任意两个骰子朝上的面要么相同，要么和不为<script type="math/tex">i</script>。答案对<script type="math/tex">998244353</script>取模。</p><p><script type="math/tex">2\le n\le 2000,1\le k\le 2000</script>。</p></blockquote><p>先枚举<script type="math/tex">i</script>。也就是说<script type="math/tex">1,i-1</script>，<script type="math/tex">2,i-2</script>，……不能同时出现。那么就出现 0 次或者一次。直接枚举有多少组里出现了一个。假设有<script type="math/tex">j</script>组。设这<script type="math/tex">j</script>个有<script type="math/tex">2^j</script>种选择（左边或者右边）。然后考虑出现了多少次：<script type="math/tex">x_1+x_2+\cdots +x_j</script>，其中<script type="math/tex">x_i&gt; 0</script>。然后枚举<script type="math/tex">y_i</script>表示比<script type="math/tex">i</script>大的数字出现的次数。把<script type="math/tex">x,y</script>放在一起插版即可。</p><h3><a id="集训队作业-2018-小-z-的礼物" href="#集训队作业-2018-小-z-的礼物" class="headerlink" title="集训队作业 2018 小 z 的礼物"></a>集训队作业 2018 小 z 的礼物</h3><p>设<script type="math/tex">t_x</script>表示 x 这个礼物第一次得到的时间。要求<script type="math/tex">E(\max t_x)</script>。考虑容斥。</p><script type="math/tex;mode=display">\sum_{T\in S}(-1)^{|T|+1}E(\min_{x\in T}t_x)</script><p><script type="math/tex">T</script>定下来：直接算随到一个的概率。假设有<script type="math/tex">X</script>个 pair 满足，一共有<script type="math/tex">Y</script>个 pair。那么期望就是<script type="math/tex">E(\min T)=\frac{Y}{X}</script>。</p><p>考虑 DP。<script type="math/tex">f(i,j,S,x)</script>表示现在考虑第<script type="math/tex">i</script>行第<script type="math/tex">j</script>个格子，<script type="math/tex">S</script>表示每行最后一个元素选不选。考虑<script type="math/tex">x</script>是否在子集中。</p><h3><a id="ARC-96-E-Everything-on-It" href="#ARC-96-E-Everything-on-It" class="headerlink" title="ARC 96 E Everything on It"></a>ARC 96 E Everything on It</h3><p>题意：求有多少个子集族满足：</p><ol><li>其中任意一个子集都是<script type="math/tex">[n]</script>的子集；</li><li>任意两个子集不同；</li><li><script type="math/tex">1,2,\cdots,n</script>都在其中出现至少两次。</li></ol><p>考虑容斥。枚举<script type="math/tex">i</script>表示<script type="math/tex">1,2,\cdots,i</script>出现次数小于等于<script type="math/tex">1</script>。那么答案为</p><script type="math/tex;mode=display">\sum_i \binom{n}{i}(-1)^iF(i)</script><p>其中<script type="math/tex">F(i)</script>表示<script type="math/tex">1,\cdots i</script>出现次数小于等于 1 的方案数。</p><p>考虑枚举有<script type="math/tex">k</script>个集合含有<script type="math/tex">[1,i]</script>中至少一个，其他集合则不含有<script type="math/tex">[1,i]</script>。</p><p>显然不含有<script type="math/tex">[1,i]</script>的子集族数为<script type="math/tex">2^{2^{n-i}}</script>。</p><p>对于这个<script type="math/tex">k</script>个集合，我们考虑把<script type="math/tex">1,\cdots,i</script>分入<script type="math/tex">k</script>个集合，有的数字可以不放，每个数字最多出现一次。相当于再拿一个集合出来装垃圾。我们给垃圾堆强制加入数字<script type="math/tex">0</script>来保证每个集合非空。同时我们认为<script type="math/tex">0</script>所在的集合指向垃圾堆。这样就相当于是<script type="math/tex">i+1</script>个数分成<script type="math/tex">k+1</script>个非空集合，那么方案数就是<script type="math/tex">S(i+1,k+1)</script>。</p><p>至于这<script type="math/tex">k</script>个集合的其他数字则可以任意填，并且由于<script type="math/tex">k</script>个集合各种含有不同的<script type="math/tex">1,\cdots,i</script>的数字，因此其他部分就不需要考虑重复的问题了，那么方案数就是<script type="math/tex">(2^{n-i})^k</script>。</p><p>因此得到</p><script type="math/tex;mode=display">F(i)=2^{2^{n-i}}\sum_k (2^{n-i})^kS(i+1,k+1)</script><h3><a id="ARC-101-E-Ribbons-on-Tree" href="#ARC-101-E-Ribbons-on-Tree" class="headerlink" title="ARC 101 E Ribbons on Tree"></a>ARC 101 E Ribbons on Tree</h3><p>题意：给你一个 n 个点的数，其中 n 是偶数。问有多少种将<script type="math/tex">n</script>个点配成<script type="math/tex">n/2</script>对的方式，使得每对点的路径并覆盖了整棵树。<script type="math/tex">n\le 5000</script>。</p><p>不合法的情况就是某条边不被经过，相当于这条边被割掉。因此考虑容斥。暴力的做法是枚举被割掉的边集，然后每个连通块内无限制连边的方案数，复杂度<script type="math/tex">O(2^n)</script>。</p><p>首先考虑无限制连边的方案数。对于一个大小为<script type="math/tex">x</script>的连通块，它的配对方案数是</p><script type="math/tex;mode=display">g(x)=\begin{cases}
(x-1)(x-3)\cdots1 & x\equiv0\bmod 2\\
0 & x\equiv 1\bmod 2
\end{cases}</script><p>那么考虑 DP 计算容斥贡献。设<script type="math/tex">f(i,j,0/1)</script>表示<script type="math/tex">i</script>的子树中，<script type="math/tex">i</script>所在连通块大小为<script type="math/tex">j</script>，被割的边数的奇偶性为<script type="math/tex">x</script>的配对方案数。注意，我们只统计被割掉的连通块的配对方案数，<script type="math/tex">i</script>所在的连通块暂不统计配对方案数。</p><p>假设<script type="math/tex">1</script>是根，我们要求的答案显然是</p><script type="math/tex;mode=display">\sum_{i=1}^ng(i)(f(1,i,0)-f(1,i,1))</script><p>考虑转移，对于<script type="math/tex">(u\to v)</script>的边：</p><ol><li>不割。相当于把<script type="math/tex">v</script>所在的连通块接在<script type="math/tex">u</script>所在的连通块上。则<script type="math/tex">f(u,i)</script>和<script type="math/tex">f(v,j)</script>可以贡献到<script type="math/tex">f'(u,i+j)</script>上。</li><li>割。则<script type="math/tex">f(u,i)</script>和<script type="math/tex">f(v,j)g(j)</script>贡献到<script type="math/tex">f'(u,i)</script>上。</li></ol><p>对子树大小取 min，时间复杂度<script type="math/tex">O(n^2)</script>。</p><h3><a id="ARC-93-F" href="#ARC-93-F" class="headerlink" title="ARC 93 F"></a>ARC 93 F</h3><p>枚举<script type="math/tex">\{G_1,G_2,\cdots,g_n\}</script>的子集。要求<script type="math/tex">S</script>中的所有集合都满足最小值在<script type="math/tex">A</script>中，问方案数。记作<script type="math/tex">f(S)</script>。答案就是<script type="math/tex">\sum_S(-1)^{|S|}f(S)</script>。</p><p>从大到小考虑 A 中的元素。<script type="math/tex">dp(T)</script>表示<script type="math/tex">T</script>的最小值属于 A。</p><h2><a id="斯特林反演" href="#斯特林反演" class="headerlink" title="斯特林反演"></a>斯特林反演</h2><p>下降幂：<script type="math/tex">n^{\underline{m}}=\prod _{i=0}^{m-1}(n-i)</script>。</p><p>通常幂转下降幂：<script type="math/tex">x^n=\sum_{k=0}^nS(n,k)x^{\underline{k}}</script>。</p><p>上升幂：<script type="math/tex">n^{\overline{m}}=\prod_{i=0}^{m-1}(n+i)</script>。</p><p>上升幂转通常幂：<script type="math/tex">x^{\overline{n}}=\sum_{k=0}^ns(n,k)x^k</script>。</p><h3><a id="反演公式" href="#反演公式" class="headerlink" title="反演公式"></a>反演公式</h3><p>斯特林反演：</p><script type="math/tex;mode=display">f(n)=\sum_{k=0}^nS(n,k)g(k)\\
g(n)=\sum_{k=0}^n(-1)^{n-k}s(n,k)f(k)</script><h3><a id="反转公式" href="#反转公式" class="headerlink" title="反转公式"></a>反转公式</h3><script type="math/tex;mode=display">\sum_{k=m}^n(-1)^{n-k}s(n,k)S(k,m)=[m=n]\\
\sum_{k=m}^n(-1)^{n-k}S(n,k)s(k,m)=[m=n]</script><p>引理：</p><script type="math/tex;mode=display">x^{\underline{n}}=(-1)^n(-x)^{\overline{n}}\\
x^{\overline{n}}=(-1)^{n}(-x)^{\underline{n}}</script><p>证明显然。</p><p>证明反转公式：</p><script type="math/tex;mode=display">\begin{aligned}
n^m&=\sum_{k=0}^mS(m,k)n^{\underline{k}}\\
&=\sum_{k=0}^mS(m,k)(-1)^k(-n)^{\underline{k}}\\
&=\sum_{k=0}^mS(m,k)(-1)^k\sum_{j=0}^ks(k,j)(-n)^{j}\\
&=\sum_{j=0}^mn^j\sum_{k=j}^mS(m,k)s(k,j)(-1)^{k-j}
\end{aligned}</script><p>反之亦然。</p><p>证明反演公式：</p><script type="math/tex;mode=display">\begin{aligned}
f(n)&=\sum_{i=0}^n[i=n]f(i)\\
&=\sum_{i=0}^nf(i)\sum_{j=i}^nS(n,j)s(j,i)(-1)^{j-i}\\
&=\sum_{k=0}^nS(n,k)\sum_{i=0}^k(-1)^{k-i}s(k,i)f(i)
\end{aligned}</script><p>也就是说如果<script type="math/tex">g</script>的定义式成立，那么<script type="math/tex">f</script>成立。</p><p>用另一个反转公式，那么如果<script type="math/tex">f</script>的定义式成立，那么<script type="math/tex">g</script>成立。这样就证完了。</p><h3><a id="2018-雅礼集训-方阵" href="#2018-雅礼集训-方阵" class="headerlink" title="2018 雅礼集训 方阵"></a>2018 雅礼集训 方阵</h3><blockquote><p>给定<script type="math/tex">n\times m</script>的矩阵，每个格子填上<script type="math/tex">[1,c]</script>中的数字，求任意两行、两列均不同的方案数。</p><p><script type="math/tex">n,m\le 5000</script>。</p></blockquote><p>不同：对应位置不同。</p><p>考虑只要求行不相同。</p><p>设<script type="math/tex">g(m)</script>表示<script type="math/tex">m</script>列的矩阵，行互不相同的方案数。有<script type="math/tex">c^m</script>种可能的行。则</p><script type="math/tex;mode=display">g(m)=(c^m)^{\underline{n}}</script><p><script type="math/tex">f(m)</script>：<script type="math/tex">m</script>列的答案。枚举<script type="math/tex">g(m)</script>中列被分成多少类。</p><script type="math/tex;mode=display">g(m)=\sum_{i=0}^mS(m,i)f(i)\\
f(m)=\sum_{i=0}^m(-1)^{m-i}s(m,i)g(i)</script><p>注：<script type="math/tex">f(0)=0</script>。</p><h3><a id="一道例题" href="#一道例题" class="headerlink" title="一道例题"></a>一道例题</h3><blockquote><p>给定 n 个结点的树，从某个点出发开始随机游走：在点 u 时，有<script type="math/tex">p_u</script>的概率留在原地，否则等概率向相邻结点移动，直到移动到 1 号点停下。求从每个结点出发直指停下，所花费的时间的 k 次方的期望。</p><p><script type="math/tex">n\le 10^5,k\le 10^5,nk\le 10^6</script>。</p></blockquote><p>设<script type="math/tex">u</script>到根结点的期望时间是<script type="math/tex">t_u</script>。我们要求<script type="math/tex">E(t_u^k)</script>。</p><script type="math/tex;mode=display">\begin{aligned}
E(t_u^k)&=E\left(\sum_{i=0}^kS(k,i)t_u^{\underline{i}}\right)\\
&=\sum_{i=0}^kS(k,i)i!E\left(\binom{t_u}{i}\right)\\
E\left(\binom{t_u}{i}\right)&=P_uE\left(\binom{t_u+1}{i}\right)+\frac{1-P_u}{d_u}\sum_{(u,v)}E\left(\binom{t_v+1}{i}\right)\\
E\left(\binom{t_u}{i}\right)&=P_uE\left(\binom{t_u}{i}+\binom{t_u}{i-1}\right)+\frac{1-P_u}{d_u}\sum_{(u,v)}E\left(\binom{t_v}{i}+\binom{t_v+1}{i-1}\right)\\
(1-P_u)E\left(\binom{t_u}{i}\right)&=P_uE\left(\binom{t_u}{i-1}\right)+\frac{1-P_u}{d_u}\sum_{(u,v)}E\left(\binom{t_v}{i}+\binom{t_v+1}{i-1}\right)
\end{aligned}</script><p>考虑按照<script type="math/tex">i</script>从小到大的顺序做。设<script type="math/tex">E\left(\binom{t_u}{i}\right)=dp(u),E\left(\binom{t_u}{i-1}\right)=a_u</script>：</p><script type="math/tex;mode=display">dp_u=P_u(dp_u+a_u)+\frac{1-P_u}{d_u}\sum_{(u,v)}(dp_v+a_v)\\
dp_u=\frac{P_ua_u}{1-P_u}+\frac{1}{d_u}\sum_{(u,v)}(dp_v+a_v)</script><p>可以按树上高消的套路做了。要记得<script type="math/tex">O(k\log_2k)</script>预处理斯特林数。</p><h3><a id="另一道例题" href="#另一道例题" class="headerlink" title="另一道例题"></a>另一道例题</h3><p>设连通块数为 T：<script type="math/tex">T^k=\sum_{i=0}^kS(k,i)i!\binom{T}{i}</script>。问题转化为求出<script type="math/tex">\sum_{T}\binom{T}{i}</script>，它表示选出了<script type="math/tex">i</script>个连通块。</p><p>设<script type="math/tex">dp_t(n)</script>表示 n 个点 t 个连通块的图的个数。</p><script type="math/tex;mode=display">\sum_{T}\binom{T}{i}=\sum_{j=1}^n\binom{n}{j}dp_i(j)2^{\binom{n-j}{2}}\\
Ans=\sum_{i=0}^kS(k,i)i!n!\sum_{j=1}^ndp_i(n-j)\frac{1}{(n-j)!j!}2^{\binom{j}{2}}</script><p>问题转化为如何求<script type="math/tex">\frac{dp_i(j)}{j!}</script>。</p><script type="math/tex;mode=display">dp_t(n)=\sum_{i=1}^n\binom{n-1}{i-1}dp_1(i)dp_{t-1}(n-i)\\
\frac{dp_t(n)}{(n-1)!}=\sum_{i=1}^n\frac{dp_1(i)}{(i-1)!}\frac{dp_{t-1}(n-i)}{(n-i)!}</script><p>那么</p><script type="math/tex;mode=display">\hat{G}_t=\sum_{n\ge 0}dp_t(n)\frac{x^n}{n!}\\
\hat{F}=\sum_{n\ge 1}dp_1(n)\frac{x^n}{(n-1)!}</script><p>容易得到</p><script type="math/tex;mode=display">n\hat{G}_t=\hat{F}\hat{G}_{t-1}+1</script><p><script type="math/tex">dp_1(n)</script>就是<script type="math/tex">\ln G(n)</script>。</p><h3><a id="清华集训-2017-生成树计数" href="#清华集训-2017-生成树计数" class="headerlink" title="清华集训 2017 生成树计数"></a>清华集训 2017 生成树计数</h3><blockquote><p>在一个 s 个点的图中，存在 s-n 条边，使图中形成了 n 个连通块，第 i 个连通块中有<script type="math/tex">a_i</script>个点。</p><p>现在我们需要再连接 n-1 条边，使得该图变成一棵树。对于一种连边方案，设原图中第<script type="math/tex">i</script>个连通块连出了<script type="math/tex">d_i</script>条边，那么这棵树<script type="math/tex">T</script>的价值为：</p><script type="math/tex;mode=display">val(T)=\left( \prod_{i=1}^nd_i^m \right)\left( \sum_{i=1}^nd_i^m \right)</script><p>求出所有可能的生成树的价值之和，对<script type="math/tex">998244353</script>取模。</p><p><script type="math/tex">n\le 3\times 10^4,m\le 30</script>。</p></blockquote><p>转化为 n 个点的生成树 T：</p><script type="math/tex;mode=display">\begin{aligned}
&\left( \prod_{i=1}^nd_i^m \right)\left( \sum_{i=1}^nd_i^m \right)\left( \prod_{i=1}^na_i^{d_i} \right)\\
=&\sum_T\sum_{i=1}^na_i^{d_i} d_i^{2m}\prod_{j\ne i}(a_j^{d_j}d_j^{m})\\
=&\sum_{\sum k_i=n-2}\binom{n-2}{k_1,k_2,\cdots,k_n}\sum_{i=1}^na_i^{k_i+1}(k_i+1)^{2m}\prod_{j\ne i}\left(a_j^{k_j+1}(k_j+1)^{m}\right)
\end{aligned}</script><p>交换</p><script type="math/tex;mode=display">(n-2)!\sum_{i=1}^n\sum_{\sum k_i=n-2}\frac{1}{\prod k_i!}a_i^{k_i+1}(k_i+1)^{2m}\prod_{j\ne i}a_j^{k_j+1}(k_j+1)^{m}\\
(n-2)!\sum_{i=1}^n\sum_{\sum k_i=n-2}\frac{a_i^{k_i+1}(k_i+1)^{2m}}{k_i!}\prod_{j\ne i}\frac{a_j^{k_j+1}(k_j+1)^{m}}{k_j!}</script><p>EGF</p><script type="math/tex;mode=display">B_i(x)=\sum_{k\ge 0}a_i^{k+1}(k+1)^{2m}\frac{x^k}{k!}\\
A_i(x)=\sum_{k\ge 0}a_i^{k+1}(k+1)^{m}\frac{x^k}{k!}</script><p>带回</p><script type="math/tex;mode=display">[x^{n-2}](n-2)!\sum_{i=1}^n B_i(x)\prod _{i\ne j}A_j(x)</script><p>定义<script type="math/tex">T(x)</script>：</p><script type="math/tex;mode=display">\begin{aligned}
T(x)&=\int A_i(x)\text{d}x=\sum_{k\ge 1}a_i^kk^m\frac{x^k}{k!}\\
&=\sum_{k\ge 1}a_i^k\frac{x^k}{k!}\sum_{j=0}^mS(m,k)k^{\underline{j}}\\
&=\sum_{j=0}^mS(m,j)a_i^jx^je^{a_ix}\\
\end{aligned}</script><p>那么复合函数求导得到（sum 里是个复合函数）</p><script type="math/tex;mode=display">\begin{aligned}
A_i(x)&=\frac{\text{d}T(x)}{\text{d}x}=\sum_{j=0}^mS(m,j)a_i^jjx^{j-1}e^{a_ix}+\sum_{j=0}^mS(m,j)a_i^{j+1}x^je^{a_ix}\\
&=e^{a_ix}\sum_{j=0}^mS(m,j+1)(j+1)a_i^{j+1}+S(m,j)a_i^{j+1}\\
&=e^{a_ix}\sum_{j=0}^mS(m+1,j+1)a_i^{j+1}x^j
\end{aligned}</script><p>复杂度<script type="math/tex">O(nm\log_2^2n)</script>。</p><h2><a id="Burnside-引理" href="#Burnside-引理" class="headerlink" title="Burnside 引理"></a>Burnside 引理</h2><h3><a id="ARC-62-F-Painting-Graphs-with-AtCoDeer" href="#ARC-62-F-Painting-Graphs-with-AtCoDeer" class="headerlink" title="ARC 62 F Painting Graphs with AtCoDeer"></a>ARC 62 F Painting Graphs with AtCoDeer</h3><p>题意：给出无向图 G，对边染 K 种颜色之一。一个环上面的边旋转后得到的染色方案视为相同，求不同的染色方案数。</p><p>求出所有的点双（每个点双是独立的）：</p><ol><li>单独的边：方案数为 K。</li><li>单环：<script type="math/tex">\frac{1}{n}\sum_{d=0}^{n-1}k^{\gcd(n,d)}</script>。</li><li>复合环：可以交换两条边的颜色。只用统计不同颜色出现次数的方案数。插板<script type="math/tex">\binom{n+k-1}{k-1}</script>。</li></ol><p>乘起来即可。</p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2021年3月27日 第2次修订</li><li class="post-history-item">2019年12月29日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Codeforces/part-3/">Codeforces 题目选讲 3</a></div><div class="prev-post"><a href="/Math/Faulhaber/">自然数幂和小结 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>