<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name="viewport"><meta name="keywords" content=""><meta name="description" content="Sshwy 的个人博客"><meta name="generator" content="Hexo 6.3.0"><title>Burnside 引理入门 - Sshwy&#39;s Notes</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/ssimple.css?20250423.css"><link rel="stylesheet" href="/iconfont/iconfont.css?20250423.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" crossorigin="anonymous"></script><script>document.addEventListener("DOMContentLoaded",function(){window.renderKatex()})</script></head><body><header><div class="header" style="width:100%"><div class="header-inner" style="position:fixed;z-index:20;top:0;left:0"><div class="header-content" style="max-width:1200px;margin:auto"><div class="blog-title"><span class="iconfont icon-menu1" id="menu-button"></span> <a href="/" class="logo header-title">Sshwy&#39;s Notes</a><div class="mobile-search"><input type="text"> <span class="iconfont icon-search mobile-search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div><div class="navbar" id="menu-list"><ul class="menu"><li class="menu-item"><a href="/archives/" class="menu-item-link"><span class="menu-item-icon iconfont icon-work"></span> Archives</a></li><li class="menu-item"><a href="/directory/" class="menu-item-link"><span class="menu-item-icon iconfont icon-folder-close"></span> Directory</a></li><li class="menu-item"><a href="/about/" class="menu-item-link"><span class="menu-item-icon iconfont icon-user"></span> About</a></li><li class="menu-item"><a href="/static/beibishi2023" class="menu-item-link"><span class="menu-item-icon iconfont icon-favorite"></span> NOI 背笔试</a></li></ul></div><div class="search"><input type="text"> <span class="iconfont icon-search search-icon"></span> <span class="iconfont icon-baseline-close-px search-close-icon"></span></div></div></div><div class="search-shadow"></div><div class="search-box"><div class="search-container"><div class="search-container-inner"><div class="search-data-status"><span>Fetching search data...</span></div><div class="search-count"></div><div class="search-result"></div></div></div></div></div></header><main class="main"><article class="post"><div class="post-title"><h1 class="page-title">Burnside 引理入门</h1></div><div class="post-meta"><div class="post-info"><span class="post-info-item post-time" title="2023年11月25日星期六晚上8点26分 (CST+08:00)"><span class="info-icon iconfont icon-time"></span>更新于 2023年11月25日 </span><span class="icon infosep"></span><span class="post-info-item post-wordcount"> <span class="info-icon iconfont icon-text"></span>约 3,541 字</span></div><div class="post-directory"><span class="iconfont icon-folder-close"></span> <a class="directory" href="/directory">Home</a> <a class="directory" href="/directory/"></a> <span class="icon smallarrow"></span> <a class="directory" href="/directory/Math/">数学 </a><span class="icon smallarrow"></span> 当前文章</div><div class="post-tags"><span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Notes/">Notes</a></span> <span class="tag"><span class="meta-icon iconfont icon-tag"></span><a class="tag" href="/tags/Math/">Math</a></span></div><hr></div><div class="toc"><h2 class="toc-title"><span class="iconfont icon-explain" style="font-size:1em;padding-right:5px"></span>文章目录</h2><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#群"><span class="toc-number">1.</span> <span class="toc-text">群</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#置换"><span class="toc-number">2.</span> <span class="toc-text">置换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#置换群"><span class="toc-number">3.</span> <span class="toc-text">置换群</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Burnside-引理"><span class="toc-number">4.</span> <span class="toc-text">Burnside 引理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Polya-定理"><span class="toc-number">5.</span> <span class="toc-text">Polya 定理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#He’s-Circles"><span class="toc-number">6.</span> <span class="toc-text">He’s Circles</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HNOI2008-Cards"><span class="toc-number">7.</span> <span class="toc-text">HNOI2008 Cards</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Isomorphism"><span class="toc-number">8.</span> <span class="toc-text">Isomorphism</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#染色"><span class="toc-number">9.</span> <span class="toc-text">染色</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考文献"><span class="toc-number">10.</span> <span class="toc-text">参考文献</span></a></li></ol></div><hr></div><div class="post-content"><h2><a id="群" href="#群" class="headerlink" title="群"></a>群</h2><p>给定一个集合<script type="math/tex">G</script>和集合上的二元运算<script type="math/tex">\circ</script>，满足</p><ol><li>封闭性：<script type="math/tex">\forall a,b\in G,a\circ b\in G</script>。</li><li>结合律：<script type="math/tex">\forall a,b,c\in G,(a\circ b)\circ c=a\circ(b\circ c)</script>。</li><li>单位元：<script type="math/tex">\exists e\in G,\forall a\in G, a\circ e=e\circ a=a</script>。</li><li>逆元：<script type="math/tex">\forall a\in G,\exists b\in G, a\circ b=b\circ a=e</script>，记<script type="math/tex">b=a^{-1}</script>。</li></ol><p>称<script type="math/tex">G</script>在运算<script type="math/tex">\circ</script>下是一个群。如整数加法群。</p><h2><a id="置换" href="#置换" class="headerlink" title="置换"></a>置换</h2><p>狭义的置换可以理解为排列。</p><p><script type="math/tex">n</script>个元素<script type="math/tex">1,2,\cdots,n</script>之间的一个置换</p><script type="math/tex;mode=display">\begin{pmatrix}
1&2&\cdots&n\\
p_1&p_2&\cdots&p_n
\end{pmatrix}</script><p>表示<script type="math/tex">i</script>被<script type="math/tex">p_i</script>取代，可以表示为<script type="math/tex">i \to p_i</script>。</p><h2><a id="置换群" href="#置换群" class="headerlink" title="置换群"></a>置换群</h2><p>置换是集合的元素，运算的置换的连接。对于两个置换<script type="math/tex">a_i,b_i</script>，他们的连接可以理解为<script type="math/tex">i\to a_i\to b_{a_i}</script>。</p><h2><a id="Burnside-引理" href="#Burnside-引理" class="headerlink" title="Burnside 引理"></a>Burnside 引理</h2><p>对于一个集合<script type="math/tex">S</script>以及与之相关的置换群<script type="math/tex">G</script>，我们说将置换群<script type="math/tex">G</script>作用于<script type="math/tex">S</script>，意味着对于<script type="math/tex">x, y\in S</script>，若存在<script type="math/tex">p\in G</script>使得<script type="math/tex">p(x) = y</script>，那么我们认为<script type="math/tex">x</script>和<script type="math/tex">y</script>是等价的。</p><p>记<script type="math/tex">S/G</script>，为<script type="math/tex">G</script>作用在<script type="math/tex">S</script>上的轨道数，即本质不同的元素个数。</p><p>那么 Burnside 引理用于计算<script type="math/tex">|S/G|</script>，其公式为</p><script type="math/tex;mode=display">|S/G|=\frac{1}{|G|}\sum_{p\in G}D(S, p)</script><p>用<script type="math/tex">D(S, p)</script>表示在置换<script type="math/tex">p</script>关于<script type="math/tex">S</script>的不动点个数，即<script type="math/tex">D(S, p) = \sum_{e\in S}[p(e) = e]</script>。</p><h2><a id="Polya-定理" href="#Polya-定理" class="headerlink" title="Polya 定理"></a>Polya 定理</h2><p>如果是处理染色问题，那么我们将置换进行轮换分解（分解成若干个环），那么每个环上的点必须染同一种颜色。假设一个置换有<script type="math/tex">e_i</script>个大小为<script type="math/tex">i</script>的轮换（<script type="math/tex">1 \le i\le n</script>），那么使用多元生成函数表示置换群<script type="math/tex">G</script>中各类轮换数目组合的置换数为<script type="math/tex">[z_1^{e_1} \cdots z_n^{e_n}]p_G(z_1, \ldots, z_n)</script>。那么用<script type="math/tex">m_j</script>个颜色<script type="math/tex">j</script>染色（<script type="math/tex">m_1 + \cdots + m_t = n</script>）的方案数可以表示为</p><script type="math/tex;mode=display">[x_1^{m_1} \cdots x_t^{m_t}]p_G(\{ x_1^i + x_2^i + \cdots + x_t^i \})</script><h2><a id="He’s-Circles" href="#He’s-Circles" class="headerlink" title="He’s Circles"></a><a target="_blank" rel="noopener" href="https://codeforces.com/problemsets/acmsguru/problem/99999/294">He’s Circles</a></h2><blockquote><p>有一个长度为<script type="math/tex">N</script>的环，上面写着<code class="inline-code">X</code>和<code class="inline-code">E</code>，问本质不同的环有多少种。<script type="math/tex">N\le 2\times 10^5</script>。</p></blockquote><p>这道题的环指</p><script type="math/tex;mode=display">\begin{pmatrix}
1&2&\cdots&n\\
1+k&2+k&\cdots&n+k
\end{pmatrix}\pmod n</script><p>构成的置换群。（<script type="math/tex">0</script>当成<script type="math/tex">n</script>）其中<script type="math/tex">0\le k&lt;n</script>。把置换理解为若干个环的话，你发现这个置换的环数恰好为<script type="math/tex">\gcd(k,n)</script>。如果方案中一个环上的颜色相同的话，那么作用这个置换后方案是不会变的。而总共有两种颜色，于是<script type="math/tex">D(a_i=i+k\bmod n)=2^{\gcd(k,n)}</script>。这样就可以统计了。</p><h2><a id="HNOI2008-Cards" href="#HNOI2008-Cards" class="headerlink" title="HNOI2008 Cards"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1446">HNOI2008 Cards</a></h2><p>考虑 Burnside 引理。对于一个置换不变的方案显然在它的一个环是同色的。因对于一个置换处理出环长后，我们做一个三维背包求方案数即可。</p><p>注意，题目给的并不是一个完整的置换群，它少了一个恒等置换。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/bzoj/1004.cpp">代码</a></p><h2><a id="Isomorphism" href="#Isomorphism" class="headerlink" title="Isomorphism"></a><a target="_blank" rel="noopener" href="https://darkbzoj.tk/problem/1478">Isomorphism</a></h2><blockquote><p>给定一个<script type="math/tex">N</script>个结点的无向完全图（ 任意两个结点之间有一条边）， 现在你可以用<script type="math/tex">M</script>种颜色对这个图的每条边进行染色，每条边必须染一种颜色。</p><p>若两个已染色的图，其中一个图可以通过结点重新编号而与另一个图完全相同， 就称这两个染色方案相同。问本质不同的染色数。</p><p><script type="math/tex">N\le 53, M\le 1000</script>。</p></blockquote><p>我们要求的就是边的置换的环数。考虑将边的置换分类。</p><p>这题的置换群对点而言是一个全排列，但对于边而言就不是了。对于两个点<script type="math/tex">i,j</script>，他们的置换为<script type="math/tex">P_i,P_j</script>，则边的置换为<script type="math/tex">(i,j)\to (P_i,P_j)</script>。</p><p>考虑将点的置换分类，那么每个置换可以由<script type="math/tex">k</script>个大小分别为<script type="math/tex">L_i</script>的环表示。</p><p>对于两个点<script type="math/tex">i,j</script>，如果他们分别在长度为<script type="math/tex">L_1,L_2</script>的环上，那么考虑边的置换的环数。这样的边总共有<script type="math/tex">L_1\times L_2</script>个，而每个环的长度为<script type="math/tex">[L_1,L_2]</script>，则环的个数为<script type="math/tex">\gcd(L_1,L_2)</script>。</p><p>如果这两个点都在长度为<script type="math/tex">L</script>的同一个环上，那么这样的边总共有<script type="math/tex">\dbinom{L}{2}</script>个。</p><ol><li>如果<script type="math/tex">L</script>是奇数，则每个环长度为<script type="math/tex">L</script>，则环的个数为<script type="math/tex">\dfrac{\binom{L}{2}}{L}=\frac{L-1}{2}</script>。</li><li>如果<script type="math/tex">L</script>是偶数，那么当<script type="math/tex">i+\frac{L}{2}\equiv j</script>时环长为<script type="math/tex">\frac{L}{2}</script>，其他时候环长为<script type="math/tex">L</script>。则环的个数为<script type="math/tex">\dfrac{\binom{L}{2}-\frac{L}{2}}{L}+1=\frac{L}{2}</script>。</li></ol><p>综上，形如<script type="math/tex">L_1,L_2,\cdots,L_k</script>的点置换对应的边置换的环数为</p><script type="math/tex;mode=display">C=\sum_{i=1}^k\left\lfloor \frac{L}{2} \right\rfloor +\sum_{i=1}^k\sum_{j=1}^{i-1}\gcd(L_i,L_j)</script><p>然后我们要求的就是形如<script type="math/tex">L_1,L_2,\cdots,L_k</script>的点置换的个数，我们规定<script type="math/tex">L_i\le L_{i+1}</script>。</p><p>首先考虑多项式定理，则把<script type="math/tex">n</script>个点分到大小分别为<script type="math/tex">L_i</script>的集合的方案数是<script type="math/tex">\dbinom{n}{L_1,L_2,\cdots,L_k}</script>。而每个集合内的元素构成一个环，方案数是<script type="math/tex">\frac{L!}{L}=(L-1)!</script>（圆排列），于是乘上一个<script type="math/tex">\prod_{i=1}^k(L_i-1)!</script>。再考虑到，<script type="math/tex">L</script>长度相同的环我们是不计他们之间的顺序的，因此设长度为<script type="math/tex">x</script>的环有<script type="math/tex">B_j</script>个，则还得除掉一个<script type="math/tex">\prod_{j=1}^tB_j!</script>，<script type="math/tex">t</script>表示长度本质不同的环的个数。整理一下得到</p><script type="math/tex;mode=display">S=\frac{n!}{\prod_{i=1}^kL_i\prod_{j=1}^tB_j!}</script><p>根据 Burnside 引理，这部分的贡献为<script type="math/tex">Sm^C</script>。</p><p>最后，我们怎么枚举形如<script type="math/tex">L_1,L_2,\cdots,L_k</script>的置换？置换的数量是<script type="math/tex">n</script>的拆分数，<script type="math/tex">n=53</script>时大概是<script type="math/tex">3\times 10^5</script>级别的，因此直接 DFS 枚举即可。</p><p><a target="_blank" rel="noopener" href="https://gitee.com/sshwy/code/raw/master/bzoj/1478.cpp">代码</a></p><h2><a id="染色" href="#染色" class="headerlink" title="染色"></a><a target="_blank" rel="noopener" href="http://www.zhengruioi.com/problem/1051">染色</a></h2><blockquote><p>对一个长度为<script type="math/tex">n</script>的项链黑白染色，并且规定旋转、翻转、反色等操作后的方案等价。问本质不同方案数。</p><p>对<script type="math/tex">998244353</script>取模。<script type="math/tex">n\le 10^{12}</script>。</p></blockquote><p>这道题集合了许多 Burnside 题的技巧和难点。题目本身也有很多理解方式。</p><p>一个基础的知识点是旋转和翻转构成的置换群大小是<script type="math/tex">2n</script>。我们把反色也可以当成一种置换。容易发现这种特殊的置换是满足群的性质的。这样反色、翻转、旋转置换群大小是<script type="math/tex">4n</script>的。考虑 Burnside 定理。</p><ol><li>旋转不反色。显然贡献是<script type="math/tex">\sum_{i=1}^{n}2^{(i,n)}=\sum_{d|n}\varphi\left(\dfrac{n}{d}\right)2^{d}</script>。</li><li>翻转不反色。这时要分<script type="math/tex">n</script>奇偶考虑。<script type="math/tex">n</script>是偶数，则贡献为<script type="math/tex">\dfrac{n}{2}(2^{\frac{n}{2}}+2^{\frac{n}{2}+1})</script>；否则<script type="math/tex">n</script>是奇数，则贡献为<script type="math/tex">n2^{\left\lfloor\frac{n}{2}\right\rfloor+1}</script>。</li><li>旋转并强制反色，则我们环上是交替填色的，环长是偶数。因此贡献是<script type="math/tex">\sum_{i=1}^{n}\left[2\mid\dfrac{n}{(i,n)}\right]2^{(i,n)}=\sum_{d|n}\left[2\mid \dfrac{n}{d}\right]\varphi\left(\dfrac{n}{d}\right)2^d</script>。</li><li>翻转并强制反色。则环长必须是偶数（2），则<script type="math/tex">n</script>是偶数时才有贡献：<script type="math/tex">\dfrac{n}{2}\cdot 2^{\frac{n}{2}}</script>。</li></ol><p>于是总的贡献是</p><script type="math/tex;mode=display">\begin{aligned}
&[2\mid n]\frac{n}{2}(2^{\frac{n}{2}}+2^{\frac{n}{2}+1}+2^{\frac{n}{2}})+[2\nmid n]n2^{\left\lfloor\frac{n}{2}\right\rfloor+1}+\sum_{d|n}\varphi\left(\frac{n}{d}\right)2^d+\left[2\mid \frac{n}{d}\right]\varphi\left(\frac{n}{d}\right)2^d\\
=&n2^{\left\lfloor\frac{n}{2}\right\rfloor+1}+\sum_{d|n}\varphi\left(\frac{2n}{d}\right)2^d
\end{aligned}</script><p>这里使用了<script type="math/tex">\varphi(2)</script>的一个小技巧。由于置换群的大小是<script type="math/tex">4n</script>，因此答案为</p><script type="math/tex;mode=display">\frac{n2^{\left\lfloor\frac{n}{2}\right\rfloor+1}+\sum_{d|n}\varphi\left(\frac{2n}{d}\right)2^d}{4n}=2^{\left\lfloor\frac{n}{2}\right\rfloor-1}+\frac{\sum_{d|n}\varphi\left(\frac{2n}{d}\right)2^d}{4n}</script><p>最后计算的时候要注意<script type="math/tex">p\mid n</script>的情况。这时<script type="math/tex">n</script>在模<script type="math/tex">p</script>意义下就没有逆元了。我们把<script type="math/tex">p</script>平方，然后在模<script type="math/tex">p^2</script>意义下求出分子。由于在非模意义下分子是<script type="math/tex">4n</script>的倍数，而<script type="math/tex">p\mid n</script>。因此在模<script type="math/tex">p^2</script>意义下分子是<script type="math/tex">p</script>的倍数。于是我们直接分子分母模数同时除以<script type="math/tex">p</script>（<script type="math/tex">p^2</script>变回<script type="math/tex">p</script>）。由于<script type="math/tex">n\le p^2</script>，因此<script type="math/tex">p\nmid \dfrac{n}{p}</script>。则现在分母就有逆元了，可以直接算了。</p><h2><a id="参考文献" href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>[1] 陈瑜希，Pólya 计数法的应用</p></div><hr><h3><span class="iconfont icon-history" style="padding-right:5px;font-size:1em"></span>修订记录</h3><div class="post-history-list"><ol reversed><li class="post-history-item">2023年11月25日 第4次修订</li><li class="post-history-item">2021年4月4日 第3次修订</li><li class="post-history-item">2021年4月2日 第2次修订</li><li class="post-history-item">2019年9月25日 创建文章</li></ol></div><div class="post-footer"><hr><div class="next-post"><span class="iconfont icon-arrow-left-circle"></span> <a href="/Brief-Neural-Network/">神经网络入门</a></div><div class="prev-post"><a href="/Score-Based-Diffusion/">Score-Based Diffusion 学习笔记 </a><span class="iconfont icon-arrow-right-circle"></span></div></div></article></main></body><div class="side-button"><div id="comment-button" class="button" title="Valine Comment"><span class="iconfont icon-comment"></span></div><div id="darkmode-button" class="button" title="Switch between day and night"><span class="iconfont icon-moonbyueliang"></span></div><div id="top" class="button" title="Back to top"><span class="iconfont icon-arrowup"></span></div></div><footer id="footer" style="margin:3em 0 2em 0;text-align:center;line-height:1.4em"><span class="post-wordcount iconfont icon-text"></span> 全站约 404,069 字<div class="license" style="padding:0 10px"><span>本站所有文章遵循许可协议 <a target="_blank" rel="license noreferrer noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a></span></div><div class="credit"><span>Themed <a href="https://github.com/sshwy/hexo-theme-essence" target="_blank" rel="noreferrer noopener">Essence v1.9.11</a> | Powered by <a href="http://hexo.io" target="_blank" rel="noreferrer noopener">Hexo</a></span></div><div class="friends"><span class="friend-link-span">友情链接 </span><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://carol-xrl.github.io/"><span class="friend-link-span">Carol </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/GavinZheng"><span class="friend-link-span">GavinZheng </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/xryjr233"><span class="friend-link-span">xryjr233 </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/dysyn1314"><span class="friend-link-span" title="为什么我的头常常变绿？因为…… "><span style="font-weight:700"><span class="codeforces p">dy</span><span class="codeforces m">syn</span><span class="codeforces p">1314</span></span> </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://blog.aor.sd.cn"><span class="friend-link-span">RainAir </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcyfrog"><span class="friend-link-span">lcyfrog </span></a><span class="icon friendsep"></span> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/maoyiting"><span class="friend-link-span">/hanx/se</span></a></div><div class="copyright"><span>Copyright &copy; 2019-present - Sshwy</span></div></footer><script src="/js/ssimple.js?20250423.js"></script><script src="https://pv.sohu.com/cityjson?ie=utf-8.js" defer></script></html>